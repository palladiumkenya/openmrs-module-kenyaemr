<!--
  ~ The contents of this file are subject to the OpenMRS Public License
  ~ Version 1.0 (the "License"); you may not use this file except in
  ~ compliance with the License. You may obtain a copy of the License at
  ~ http://license.openmrs.org
  ~
  ~ Software distributed under the License is distributed on an "AS IS"
  ~ basis, WITHOUT WARRANTY OF ANY KIND, either express or implied. See the
  ~ License for the specific language governing rights and limitations
  ~ under the License.
  ~
  ~ Copyright (C) OpenMRS, LLC.  All Rights Reserved.
-->
<htmlform>
    <script type="text/javascript" src="../moduleResources/kenyaemr/scripts/moment.js"></script>
    <script type="text/javascript">
        var ctxPath = typeof openmrsContextPath === 'string' ? openmrsContextPath : OPENMRS_CONTEXT_PATH;
        var GREENCARD_VELOCITY = "<lookup expression="kenyaemr.GreenCardVelocityCalculation()" />";
        var PATIENT_PREGNANT = GREENCARD_VELOCITY.split(",")[10].split(":")[1];
        function onWeightOrHeightChange() {
            var age = parseInt('<lookup expression="patient.age"/>');
            var gender = "<lookup expression="patient.gender" />";
            var display = '';
            var weightKg = parseFloat(getValue('weight.value'));
            var heightM = parseFloat(getValue('height.value')) / 100;
            if (!isNaN(weightKg) &amp;&amp; !isNaN(heightM)) {
                var bmi = weightKg / (heightM * heightM);
                if (isNaN(bmi) || bmi &lt; 10 || bmi &gt; 50) {
                    display = 'Abnormal value. Were height and height entered correctly?';
                }
                else {
                    display = bmi.toFixed(2);
                }
                if (age &lt; 5) {
                    jq.getJSON('/' + ctxPath + '/kenyaemr/ZScoreUtils/calculateZScore.action', {
                        height: heightM * 100,
                        weight: weightKg,
                        sex: gender
                    }, function (data) {
                        if (data != null) {
                            jQuery('#calculated-zscore').html(data);
                            setValue('z-score-value.value', data);
                            if (data == -10) {
                                getField('z-score.value').prop("selectedIndex", 0);
                                getField('z-score.error').html('Z-score not within acceptable range').show();
                            }else{
                                getField('z-score.error').html('Z-score not within acceptable range').hide();
                            }

                            if (data &gt; -1) {
                                getField('z-score.value').prop("selectedIndex", 1);
                            }else if (data == -1) {
                                getField('z-score.value').prop("selectedIndex", 2);
                            }else if (data == -2) {
                                getField('z-score.value').prop("selectedIndex", 3);
                            }else if (data == -3) {
                                getField('z-score.value').prop("selectedIndex", 4);
                            }else if (data == -4) {
                                getField('z-score.value').prop("selectedIndex", 4);
                            }else if (data == -20) {
                                getField('z-score.value').prop("selectedIndex", 0);
                                getField('z-score.error').html('Missing either weight or height').show();
                            }
                        } else {
                            jq("#calculated-zscore").text("Error computing z-score").addClass("ke-error-label");
                        }

                    });

                }
            }
            jQuery('#calculated-bmi').html(display);
        }
        function displayRecentBmi() {
            var weightKg = "<lookup expression="fn.latestObs(5089).valueNumeric"/>"
            var heightM = ("<lookup expression="fn.latestObs(5090).valueNumeric"/>")/100
            var bmi = '';
            var recent_bmi ='';
            var pAge = parseInt('<lookup expression="patient.age"/>');
            //If client is > 19 years prepopluate height
            if (pAge &gt; 19 &amp;&amp; heightM !="" ) {
                getField('height.value').val(heightM*100);
            }else{
                getField('height.value').val("");
            }

            if (weightKg != "" &amp;&amp; heightM !="") {
                if (!isNaN(weightKg) &amp;&amp; !isNaN(heightM)) {
                    bmi = weightKg / (heightM * heightM);
                    recent_bmi = bmi.toFixed(2);
                    jq('#recent-calculated-bmi').html(recent_bmi);
                }
            }else{
                jq('#recent-calculated-bmi').html("");
            }
        }

        function displayRecentZscore() {
            var latestZscore = "<lookup expression="fn.latestObs(163515).getValueCoded()"/>"
            var latestZscoreDate = "<lookup expression="fn.latestObs(163515).getObsDatetime()"/>";
            var pAge = parseInt('<lookup expression="patient.age"/>');
            var lastZscore = latestZscore.replace(/[^\d]/g, '');
            var formattedZscoreDate = moment(moment(latestZscoreDate, 'DD/MMM/YYYY').toDate()).format("DD-MMM-YYYY");

            if (pAge &lt; 5 &amp;&amp; lastZscore !="" ) {
                if (lastZscore == 1115) {
                    jq('#recent-calculated-zscore').html('Normal ('+formattedZscoreDate+')');
                }else if (lastZscore == 123814) {
                    jq('#recent-calculated-zscore').html('Mild ('+formattedZscoreDate+')');
                }else if (lastZscore == 123815) {
                    jq('#recent-calculated-zscore').html('Moderate ('+formattedZscoreDate+')');
                }else if (lastZscore == 164131) {
                    jq('#recent-calculated-zscore').html('Severe (' + formattedZscoreDate + ')');
                }else{
                    jq('#recent-calculated-zscore').html("");
                }
            }
        }
        var complaintSelected = function() {
            var pAge = parseInt('<lookup expression="patient.age"/>');
            var val = getValue('complaints-today.value');
            var complaint = jq('.complaint select').val('');
            var complaintDuration = jq('.complaint-time input').val('');
            var complaintDate = jq('.complaint-date input').val('');
            var otherComplaint = jq('#obs-other-complaint input').val('');
            if (val == "true"){
                jq("#tbl-complaints-today").show();
                jq('#tr-other-complaint').show();
            }
            else{
                jq("#tbl-complaints-today").hide();
                jq('#tr-other-complaint').hide();
                jq('#tr-other-complaint-specify').hide();
                jq("#other-complain input").prop("checked", false);
                clearHiddenSections ([complaint, complaintDuration, complaintDate, otherComplaint]);
                getField('complaint-field.error').html('Please specify the complaints.').hide();
            }
            if(pAge &gt; 4){
                jq("#complaint-field option[value='6017']").hide();  //Refusal to feed
            }
        }
        var otherComplaintSelected = function () {
            var val = jq(this).val();
            var otherMethodChecked = jq("#other-complaint input:checkbox:checked");
            if (val == 5622 &amp;&amp; otherMethodChecked.length == 1) {
                jq('#tr-other-complaint-specify').show();
            }else{
                getField('obs-other-complaint.value').val("");
                jq('#tr-other-complaint-specify').hide();
            }
        }
        var complaintDurationInput = function() {
            var table = document.getElementById("tbl-complaints-today");
            for (var i = 0, row; row = table.rows[i]; i++) {
                var val = jq(this).closest('tr').find(".complaint-time input").val();
                var encounterDate = new Date(getValue('encounter-date.value'));
                var formattedComplaintDate = moment(moment(encounterDate, 'YYYY-MM-DD').subtract(val, 'days').toDate()).format('YYYY-MM-DD');
                if(val >0 ) {
                    jq(this).closest('tr').find(".complaint-date input").val(formattedComplaintDate);
                }
            }
        }
        jQuery(function () {
            var pAge = parseInt('<lookup expression="patient.age"/>');
            var miscariageVal = getValue('miscariage.value');
            var fpVal = getValue('fplanning.value');
            var lmpVal = getValue('last-menstrual-period.value');
            babyVal = getValue('baby-last-wee.value');
            getField('weight.value').change(onWeightOrHeightChange);
            getField('height.value').change(onWeightOrHeightChange);
            onWeightOrHeightChange();
            displayRecentBmi();
            displayRecentZscore();
            jq('#z-score').attr("style", "pointer-events: none;");
            jq('#miscariage input').change(onMiscariageChange);
            jq('#baby-last-week').hide();
            //limit letters only in text field
            if(pAge &lt; 10 || PATIENT_PREGNANT == 'true' ) {
                jq('#pregnancy-screening').hide();
                jq('#triage-notes').hide();
            }else{
                jq('#pregnancy-screening').show();
                jq('#triage-notes').show();
            }
            jq("#tbl-complaints-today").hide();
            jq('#tr-other-complaint').hide();
            jq('#tr-other-complaint-specify').hide();
            jq("#complaints-today").change(complaintSelected);       //boolean
            jq(".complaint-time input").change(complaintDurationInput);
            jq('#other-complaint :input[type=checkbox]').change(otherComplaintSelected);
//            jQuery('#rsn').keypress(function(event) {
//                var code = (event.keyCode ? event.keyCode : event.which);
//                alert(code)
//                if (code &gt;= 48  &amp;&amp; code &lt;= 57) //numbers
//                    event.preventDefault();
//            });

            function onMiscariageChange() {
                if (getValue('miscariage.value') == 1066) {
                    jq('#baby-last-week').show();
                }else{
                    jq('#baby-last-week').hide();
                    clearHiddenSections(jq('#baby-last-week'));
                }
            }
            var pbirthdate = new Date("<lookup expression="patient.birthdate" />").getTime();
            var pgender = "<lookup expression="patient.gender" />";
            var pAge = parseInt('<lookup expression="patient.age"/>');
            beforeSubmit.push(function () {
                var lmpdate = new Date(getValue('lmp-date.value')).getTime();

                if(pgender === 'F') {
                    if (lmpdate &lt; pbirthdate) {
                        getField('lmp-date.error').html('Should not be earlier than birth date').show();
                        return false;
                    }else{
                        getField('lmp-date.error').html('Should not be earlier than birth date').hide();
                    }
                }
                return true;
            });

        });
        //Clear hidden sections
        clearHiddenSections = function(parentObj) {
            parentObj.find('input[type=radio]').each(function() {
                this.checked = false;
            });
            parentObj.find('input[type=checkbox]').each(function() {
                this.checked = false;
            });
            parentObj.find('input[type=text]').each(function() {
                jq(this).val("");
            });
            parentObj.find('select').each(function() {
                this.selectedIndex =0;
            });
        }

    </script>
    <ifMode mode="EDIT">
        <script type="text/javascript">
            jq(function(){
                if (getValue('miscariage.value') == 1066) {
                    jq('#baby-last-week').show();
                }else{
                    jq('#baby-last-week').hide();
                    var complaintsToday = getValue('complaints-today.value');
                    var selectedComplaint = getField('complaint-field.value').val();
                    clearHiddenSections(jq('#baby-last-week'));

                    if (complaintsToday == 'true'){
                        jq("#tbl-complaints-today").show();
                        jq('#tr-other-complaint').show();
                    }else{
                        jq("#tbl-complaints-today").hide();
                    }

                    var otherMethodChecked = jq("#other-complaint input:checkbox:checked");
                    if (otherMethodChecked.length == 1) {
                        jq('#tr-other-complaint-specify').show();
                    }
                }
            });
        </script>
    </ifMode>
    <div class="ke-form-header">
        <table style="width: 100%">
            <tr>
                <td align="left">Date:
                    <encounterDate id="encounter-date" showTime="true"/>
                </td>
                <td>Provider : <encounterProvider default="currentUser" /></td>
                <td align="right">Location:
                    <encounterLocation default="GlobalProperty:kenyaemr.defaultLocation" type="autocomplete"/>
                </td>
            </tr>
        </table>
    </div>

    <div class="ke-form-content">
        <!-- Presenting complaints -->
        <fieldset class="patient-details">
            <legend>Complaints and History of complaints</legend>
            <div>
                Patient having complaint(s) today?
                <obs id="complaints-today" conceptId="1154AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="yes_no"/>
                <span style="color:red;"><strong>*</strong></span>
            </div>
            <table cellspacing="5" id="tbl-complaints-today">
                <tr>
                    <th style="color: #888">Complaint</th>
                    <th style="color: #888; text-align: center">Duration (Days)</th>
                    <th style="color: #888; text-align: center">Onset Date</th>
                </tr>
                <repeat>
                    <template>
                        <obsgroup groupingConceptId="160531AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA">
                            <tr>
                                <td>
                                    <obs class="complaint" conceptId="5219AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                         answerConceptIds="151AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,141631AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,121543AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,119537AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,148035AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,840AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,131021AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,120749AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,871AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,120345AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,119574AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,113054AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,206AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,143264AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,143129AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,142412AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,122496AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,118789AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,141830AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
                                                            141585AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,141128AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,131040AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,114399AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162626AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,140238AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,140070AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,123396AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,142247AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,135462AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,139084AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,117698AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,116214AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,112989AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,879AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,116558AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,114395AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,135595AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,135488AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
                                                             121657AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,144576AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,116334AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,131015AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,111721AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,133028AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,133632AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5978AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,133469AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,133027AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,132653AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,125225AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,131034AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5953AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,512AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,127777AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,113224AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,131032AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,126535AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
                                                               141597AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,158843AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,140941AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,125198AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,112200AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160208AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,111525AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,122983AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,832AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,121AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,6017AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                         answerLabels="Abdominal pain,Abnormal Uterine Bleeding,Anxiety,Depression,Back pain,Bloody Urine,Breast Pain,Chest Pain,Cold and Chills,Confusion,Delirium,Convulsions,Seizure,Cough,Crying Infant,Diarrhea,Difficult in breathing,Difficulty in swallowing,Dizziness,Ear Pain,Epigastric Pain,Eye apin,Facial Pain,Fatigue/weakness,Fever,Flank Pain,Vaginal Discharge,Discharge from Penis,Genital Ulcer,Headache,Hearing Loss,Hypotension,Shock,Itchiness/Pruritus,Joint Pain,Leg Pain,Loss of Appetite,Lymphadenopathy,Memory Loss,Coma,Lethargy,Mouth Pain,Mouth Ulceration,Muscle cramps,Muscle Pain,Nausea,Neck Pain,Night sweats,Numbness,Pain when Swallowing,Pelvic Pain,Poor Vision,Rash,Red Eye,Running/Blocked nose,Scrotal Pain,Shoulder Pain,
                                                       Sleep Disturbance,Sore Throat,Excessive Sweating,Swollen Legs,Tremors,Urinary Symptoms,Vertigo,Vomiting,Weight Loss,Myalgia,Refusal to feed"
                                         style="dropdown" id="complaint-field"
                                    />
                                </td>
                                <td><obs class="complaint-time" conceptId="159368AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id ="complaint-duration" size="10" /></td>
                                <td>
                                    <obs class="complaint-date" conceptId="159948AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" allowFutureDates="false"/>
                                </td>
                            </tr>
                        </obsgroup>
                    </template>
                    <render n="1" concept="complaint"/>
                    <render n="2" concept="complaint"/>
                    <render n="3" concept="complaint"/>
                    <render n="4" concept="complaint"/>
                    <render n="5" concept="complaint"/>
                </repeat>
            </table>
            <table>
                <tr id="tr-other-complaint">
                    <td>
                        <obs conceptId="165241" answerConceptId="5622AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                             answerLabel="Other" style="checkbox"  id="other-complaint" /><br/>
                    </td>
                </tr>
                <tr id="tr-other-complaint-specify">
                    <td> Specify
                        <obs conceptId="165250" rows="3" cols="80" id="obs-other-complaint"/>
                    </td>
                </tr>
            </table>
        </fieldset>
        <fieldset>
            <legend>Vital Signs</legend>

            <table>
                <tr>
                    <td>Temp</td>
                    <td>
                        <obs conceptId="5088AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
                        &#176;C
                    </td>
                </tr>
                <tr>
                    <td>Pulse Rate</td>
                    <td>
                        <obs conceptId="5087AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
                    </td>
                </tr>
                <tr>
                    <td>BP</td>
                    <td>
                        <obs conceptId="5085AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
                        /
                        <obs conceptId="5086AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
                        mmHg
                    </td>
                </tr>
                <tr>
                    <td>Respiratory Rate</td>
                    <td>
                        <obs conceptId="5242AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
                    </td>
                </tr>
                <tr>
                    <td>Oxygen Saturation</td>
                    <td>
                        <obs conceptId="5092AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
                    </td>
                </tr>
            </table>
        </fieldset>
        <fieldset>
            <legend>Other Recordings</legend>
            <td colspan="6">
                <table>
                    <tr>
                        <th></th>
                        <th>Current</th>
                        <th>Recent</th>
                    </tr>
                    <tr>
                        <td>Weight</td>
                        <td>
                            <obs id="weight" conceptId="5089AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" required="true"/>
                            kg
                        </td>
                        <td>
                            <recentObs conceptId="5089AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
                        </td>
                    </tr>
                    <tr>
                        <td>Height</td>
                        <td>
                            <obs id="height" conceptId="5090AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" required="true"/>
                            cm
                        </td>
                        <td>
                            <recentObs conceptId="5090AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
                        </td>
                    </tr>
                    <includeIf velocityTest="$patient.age &gt; 14">
                        <tr>
                            <td>BMI</td>
                            <td><span id="calculated-bmi" class="value"></span></td>
                            <td><span id="recent-calculated-bmi"></span></td>
                        </tr>
                    </includeIf>
                    <tr>
                        <td>MUAC</td>
                        <td>
                            <obs conceptId="1343AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
                        </td>
                        <td>
                            <recentObs conceptId="1343AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
                        </td>
                    </tr>
                    <includeIf velocityTest="$patient.age &lt; 5">
                        <tr>
                            <td>
                                Nutritional status:</td>
                            <td>
                                <obs conceptId="163515AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerConceptIds="1115AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
                                                   123814AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
                                                   123815AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
                                                   164131AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerLabels="Normal (Median),Mild (-1 SD),Moderate (-2 SD),Severe (-3 SD and -4 SD)"
                                     style="dropdown"
                                     id="z-score"/>
                            </td>
                            <td><span id="recent-calculated-zscore"></span></td>
                            <td>&#160;&#160;&#160;  Z-Score : &#160;</td>
                            <td><span id="calculated-zscore" class="value"></span></td>
                        </tr>
                        <tr style="display: none">
                            <td>
                                <obs id="z-score-value" conceptId="162584AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
                            </td>
                        </tr>
                    </includeIf>
                    <includeIf velocityTest="$patient.gender == 'F' ">
                        <tr>
                            <td>LMP</td>
                            <td>
                                <obs id="lmp-date" conceptId="1427AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
                            </td>
                            <td>
                                <recentObs conceptId="1427AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
                            </td>
                        </tr>
                    </includeIf>
                    <includeIf velocityTest="($patient.gender == 'F') &amp;&amp; ($patient.age &gt; 8) &amp;&amp; ($patient.age &lt; 15)">
                        <tr id="hpv-vaccine">
                            <td>Client Vaccinated against HPV? &#160;&#160;&#160;&#160;&#160;&#160;&#160;</td>
                            <td>  <obs  align="right" conceptId="160325AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                        style="radio"
                                        answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                        answerLabels="Yes,No"/>
                            </td>
                        </tr>
                    </includeIf>
                </table>
            </td>
        </fieldset>

        <includeIf velocityTest="$patient.gender == 'F'  &amp;&amp; ($patient.age &gt; 9)" >
            <fieldset id="pregnancy-screening">
                <legend>Pregnancy Screening</legend>
                <table>
                    <obsgroup groupingConceptId="160108AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA">

                        <tr>
                            <td>Have you abstained from sexual intercourse from your last menstrual period/delivery?  &#160;&#160; </td>
                            <td><obs conceptId="160109AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText=" "  answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerLabels="Yes,No"
                                     style="radio" id="sexual-abstained" />
                            </td>
                        </tr>
                        <tr>
                            <td>Did your last menstrual period start within the past 7 days ? &#160;&#160;</td>
                            <td><obs conceptId="162877AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="last-menstrual-period" labelText=" " answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio" answerLabels="Yes,No" /></td>

                        </tr>
                        <tr>
                            <td>Are you on FP method ? &#160; </td>
                            <td><obs conceptId="160653AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText=" "  id="fplanning" answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio" answerLabels="Yes,No" /></td>
                        </tr>
                        <tr>
                            <td>Have you had a miscarriage in the past 7 days ? &#160; </td>
                            <td><obs conceptId="48AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText=" "  id="miscariage" answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio" answerLabels="Yes,No" /></td>
                        </tr>
                        <tr id="baby-last-week">
                            <td>Have you had a baby in the last 4 weeks? &#160; </td>
                            <td><obs conceptId="1657AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText=" "  answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio" answerLabels="Yes,No" /></td>
                        </tr>
                    </obsgroup>
                </table>
            </fieldset>
            <fieldset id="triage-notes">
                <legend>Triage Notes</legend>
                <table align="center" width="100%" class="tb1">
                    <tr>
                        <td>Did you refer the client for a Pregnancy test?
                            <obs class ="refer-client-for-pregnancy"
                                 conceptId="1282AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                 answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                 answerLabels="Yes,No"
                                 style="radio" id="refer-client-for-pregnancy" />
                        </td>
                    </tr>
                    <tr>
                        <td>Triage Notes:</td>
                    </tr>
                    <tr>
                        <td>
                            <obs conceptId="159395AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" rows="3" cols="100"
                                 style="textarea"/>
                        </td>
                    </tr>
                </table>
            </fieldset>

        </includeIf>
    </div>
    <div class="ke-form-footer">
        <submit/>
    </div>

</htmlform>
