<!--
  ~ The contents of this file are subject to the OpenMRS Public License
  ~ Version 1.0 (the "License"); you may not use this file except in
  ~ compliance with the License. You may obtain a copy of the License at
  ~ http://license.openmrs.org
  ~
  ~ Software distributed under the License is distributed on an "AS IS"
  ~ basis, WITHOUT WARRANTY OF ANY KIND, either express or implied. See the
  ~ License for the specific language governing rights and limitations
  ~ under the License.
  ~
  ~ Copyright (C) OpenMRS, LLC.  All Rights Reserved.
-->
<htmlform>

	<script type="text/javascript" src="../moduleResources/kenyaemr/scripts/moment.js"></script>
	<script type="text/javascript">
        /**
         * TODO use a lookup tag to get these concept ids. Will require HTML-463
         */
        var YES_CONCEPT_ID = 1065;
        var NO_CONCEPT_ID = 1066;
        var TRANSIT =5622;
        var PATIENT_HAS_UPN = <lookup expression="kenyaemr.hasHivUniquePatientNumber()" />;
        var ctxPath = typeof openmrsContextPath === 'string' ? openmrsContextPath : OPENMRS_CONTEXT_PATH;

        var ageGroup = function () {
            pAge = parseInt('<lookup expression="patient.age"/>');
            var adultLabelText = "Adult";
            var childLabelText = "Child";
            if (pAge &gt; 15) {
                whoChild.style.display='none';
                jq("#patient-age-group").text(adultLabelText);
            }
            if (pAge &lt; 15) {
                whoAdult.style.display='none';
                jq("#patient-age-group").text(childLabelText);
            }
        }

        function onTransferStatusChange() {
            if (getValue('transfer-in-status.value') == NO_CONCEPT_ID) {
                jq('#transfer-details :input').prop('disabled', false);
                jq('#hiv-id :input').prop('disabled', false);
                jq('#generate-hiv-id').hide();
                jq('#transfer-details').hide();
                clearHiddenSections(jq('#transfer-details'));
                jq('#patient-history').show();
                jq('#art-history').show();
                jq('#baseline-assessment1').show();
                jq('#baseline-assessment2').show();
                jq('#baseline-assessment3').show();
                jq('#treatment-supporter').show();
                jq('#generate-hiv-id').show();
                jq('#transit-patient').hide();
            } else if (getValue('transfer-in-status.value') == YES_CONCEPT_ID) {
                jq('#transfer-details :input').prop('disabled', false);
                jq('#hiv-id :input').prop('readonly',true);
                jq('#generate-hiv-id').hide();
                jq('#transfer-details').show();
                jq('#patient-history').show();
                jq('#art-history').show();
                jq('#baseline-assessment1').show();
                jq('#baseline-assessment2').show();
                jq('#baseline-assessment3').show();
                jq('#treatment-supporter').show();
                jq('#transit-patient').hide();
            } else if (getValue('transfer-in-status.value') == TRANSIT) {
                jq('#transit-patient').show();
                jq('#transfer-details').hide();
                clearHiddenSections(jq('#transfer-details'));
                jq('#patient-history').hide();
                jq('#art-history').hide();
                jq('#baseline-assessment1').hide();
                jq('#baseline-assessment2').hide();
                jq('#baseline-assessment3').hide();
                jq('#treatment-supporter').hide();
                jq('#hiv-id :input').prop('disabled', false);
                jq('#generate-hiv-id').hide();

            }else{
                jq('#transfer-details :input').prop('disabled', true);
                jq('#hiv-id :input').prop('disabled', true);
                jq('#generate-hiv-id').hide();

            }
        }

        function onArtStatusChange() {
            if (getValue('art-status.value') == 'true') {
                jq('#art-history :input').prop('disabled', false);
            } else {
                jq('#art-history :input').prop('disabled', true);
            }
        }
        var onPregnancySelected = function() {
            var val = jq(this).val();
            if (val == 1066){
                jq(".muac").hide();

            }else {
                jq(".muac").show();
            }
        }
        function onUpnGenerateClick() {
            kenyaui.openConfirmDialog({
                heading: 'Generate UPN',
                message: 'This should only be used for new patients. If the patient already has a UPN, please enter that instead.',
                okLabel: 'Continue',
                okCallback: function() {
                    jq.getJSON('/' + ctxPath + '/kenyaemr/emrUtils/nextHivUniquePatientNumber.action', function(data) {
                        jq('#hiv-id input[type=text]').val(data.value);
                        jq('#generate-hiv-id').hide();
                    });
                }
            });
        }

        function onSubmitWithUpnField(upn) {
            var isPresent = "";
            jq.getJSON('/' + ctxPath +  '/kenyaemr/patient/patientUtils/patientExist.action',{ patientId: upn },function(data) {
                if(data != null){
                    isPresent = data;
                }
            });
            return isPresent;
        }
        //Validate baseline bmi
        function onWeightOrHeightChange() {
            var display = '';
            var weightKg = parseFloat(getValue('weight.value'));
            var heightM = parseFloat(getValue('height.value')) / 100;
            if (!isNaN(weightKg) &amp;&amp; !isNaN(heightM)) {
                var bmi = weightKg / (heightM * heightM);
                if (isNaN(bmi) || bmi &lt; 10 || bmi &gt; 50) {
                    display = 'Abnormal value. Were height and height entered correctly?';
                }
                else {
                    display = bmi.toFixed(2);
                }
            }

            jQuery('#calculated-bmi').html(display);
        }
        clearHiddenSections = function(parentObj) {


            parentObj.find('input[type=radio]').each(function() {
                this.checked = false;

            });

            parentObj.find('input[type=checkbox]').each(function() {

                this.checked = false;

            });
            parentObj.find('input[type=text]').each(function() {

                jq(this).val("");

            });
            parentObj.find('select').each(function() {

                this.selectedIndex =0;

            });
        }
        jq(function() {
            //Get age and gender for validation
            var pgender = "<lookup expression="patient.gender" />";
            var pAge = parseInt('<lookup expression="patient.age"/>');
            ageGroup();
            jq('.muac').hide();
            jq('#transfer-in-status input').click(onTransferStatusChange);
            jq('#art-status input').click(onArtStatusChange);
            jq('#generate-hiv-id').click(onUpnGenerateClick);
            jq("#pregnant :input[type=radio]").change(onPregnancySelected);
            //Transit validation
            jq('#transit-patient').hide();


            //Baseline
            getField('weight.value').change(onWeightOrHeightChange);
            getField('height.value').change(onWeightOrHeightChange);
            onWeightOrHeightChange();
//            jq("#pregnant input[type=radio]").prop("disabled" ,false);
//            jq("#breastfeeding input[type=radio]").prop("disabled" ,false);

            //limit letters only in text field
            jQuery('#rsn').keypress(function(event) {
                var code = (event.keyCode ? event.keyCode : event.which);
                //alert(code)
                if (code &gt;= 48  &amp;&amp; code &lt;= 57) //numbers
                    event.preventDefault();
            });
            onTransferStatusChange();
            onArtStatusChange();
            //Gender based validations  pregnancy and breastfeeding
            if (pgender == 'M' || pAge &lt; 10) {
                jq("#pregnant input[type=radio]").prop("disabled" ,true);
                jq("#breastfeeding input[type=radio]").prop("disabled" ,true);
            }
             //Gender based Validations bmi and muac
            if (pAge &lt; 2 || getValue('pregnant.value') == 1065) {
                jq('.muac').show();
            }

            beforeSubmit.push(function() {
                var birthDate = "<lookup expression="patient.birthdate" />";
                var encounterDate = getValue('encounter-date.value');
                var confirmedPveDate = getValue('confirmed-positive-date.value');
                var transferInDate = getValue('transfer-in-date.value');
                var firstEnrolledDate = getValue('first-enrolled-date.value');
                var artStartDate = getValue('art-start-date.value');
                var upn = jq('#hiv-id input[type=text]').val();

                if (PATIENT_HAS_UPN) {
                    if((/^[0-9]{10}$/.test(upn) === false) &amp;&amp; (/^[0-9]{11}$/.test(upn) === false)) {
                        alert("Invalid Unique Patient Number(UPN) Format! Should be mfl-clinic number, each 5 digits (accepts 11 digits for existing UPN)");
                        return false;
                    }
				} else {
                    if(/^[0-9]{10}$/.test(upn) === false) {
                        alert("Invalid Unique Patient Number(UPN) Format! Should be mfl-clinic number, each 5 digits for new enrollments");
                        return false;
                    }
				}


                if (encounterDate =="") {
                    getField('encounter-date.error').html('Enrollment date should not be empty').show();
                    return false;
                }
                var isBirthdateBeforeEnrollment = moment(moment(moment(encounterDate, 'YYYY-MM-DD').toDate()).format('YYYY-MM-DD')).isBefore(moment(moment(birthDate, 'DD-MMM-YYYY').toDate()).format('YYYY-MM-DD'));
                if (isBirthdateBeforeEnrollment) {
                    getField('encounter-date.error').html('Enrollment date, should  be later than birth Date').show();
                    return false;
                }

                var isBirthdateBeforeConfirmedPve = moment(moment(moment(confirmedPveDate, 'YYYY-MM-DD').toDate()).format('YYYY-MM-DD')).isBefore(moment(moment(birthDate, 'DD-MMM-YYYY').toDate()).format('YYYY-MM-DD'));
                if (isBirthdateBeforeConfirmedPve) {
                    getField('confirmed-positive-date.error').html('Confirmed HIV+ date, should not be later than birth Date').show();
                    return false;
                }


                var isEnrollmentDateBeforeConfirmedPve = moment(moment(moment(encounterDate, 'YYYY-MM-DD').toDate()).format('YYYY-MM-DD')).isBefore(moment(moment(confirmedPveDate, 'YYYY-MM-DD').toDate()).format('YYYY-MM-DD'));
                if (isEnrollmentDateBeforeConfirmedPve) {
                    getField('confirmed-positive-date.error').html('Confirmed HIV+ date, should not be later than HIV enrollment Date').show();
                    return false;
                }
                if(getValue('transfer-in-status.value') == YES_CONCEPT_ID) {
					var isTransferInBeforeFirstEnrolled = moment(moment(moment(transferInDate, 'YYYY-MM-DD').toDate()).format('YYYY-MM-DD')).isBefore(moment(moment(firstEnrolledDate, 'YYYY-MM-DD').toDate()).format('YYYY-MM-DD'));
					if (isTransferInBeforeFirstEnrolled) {
						getField('transfer-in-date.error').html('Transfer in date, should not be later than Date first enrolled in HIV care').show();
						return false;
					   }
                }

                if(getValue('transfer-in-status.value') == YES_CONCEPT_ID) {
					var isARTStartDateBeforeFirstEnrolled = moment(moment(moment(artStartDate, 'YYYY-MM-DD').toDate()).format('YYYY-MM-DD')).isBefore(moment(moment(firstEnrolledDate, 'YYYY-MM-DD').toDate()).format('YYYY-MM-DD'));
						if (isARTStartDateBeforeFirstEnrolled) {
							getField('art-start-date.error').html('ART start date , should not be later than date first enrolled in HIV care').show();
							return false;
						}
                }
                return true;
            });

        });
	</script>

	<div class="ke-form-header">
		<table style="width: 100%">
			<tr>
				<td>
					<ifMode mode="ENTER">
						<script type="text/javascript">
                            jq(function(){
                                setValue("encounter-date.value", "");
                            });
						</script>
					</ifMode>
					Enrollment date: <encounterDate id="encounter-date" showTime="true" />
				</td>
				<td>Enrolled by: <encounterProvider default="currentUser" /></td>
				<td>Enrolled at: <encounterLocation default="GlobalProperty:kenyaemr.defaultLocation" /></td>
			</tr>
		</table>
	</div>

	<div class="ke-form-content">
		<fieldset>
			<legend>Patient Source</legend>

			<table>
				<tr>
					<td>Entry point*</td>

					<!-- pw greencard additions increased entry points -->
					<td colspan="3">
						<obs style="radio" answerSeparator=" "
							 conceptId="160540AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
							 answerConceptIds="159938AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160539AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,159937AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160536AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160537AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160541AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160542AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162050AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160551AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5622AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
							 answerLabels="HBTC,VCT Site,MCH,IPD-Adult,IPD-Child,TB Clinic,OPD,CCC,Self Test,Other(eg STI)"

						/>
					<td><obsgroup groupingConceptId="161358AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA">
						<obs conceptId="160632AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
					</obsgroup></td>
					</td>
					<!-- .pw greencard additions increased entry points -->
				</tr>
				<tr></tr>
				<tr>
					<td>Patient Type</td>
					<td>
						<obs
								id="transfer-in-status" conceptId="160563AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio"
								answerConceptIds="1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5622AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
								answerLabels="New Patient,Transfer in,Transit"
						/>
					</td>
				</tr>
				<tr>
					<ifMode mode="EDIT">
						<script type="text/javascript">
                            jq(function(){
                                var PATIENT_IS_ENROLLED_HIV = <lookup expression="kenyaemr.hasHivUniquePatientNumber()" />;
                                if(PATIENT_IS_ENROLLED_HIV) {
                                    jq('#hiv-id :input').prop('readonly', true);
                                    jq('#generate-hiv-id').hide();
                                }
                            });

						</script>
					</ifMode>
					<td>Unique Patient Number (UPN)</td>
					<td> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
						<span id="hiv-id"><patient id="upn" field="identifier" identifierTypeId="05ee9cf4-7242-4a17-b4d4-00f707265c8a" /></span>
							<input type="button" id="generate-hiv-id" value="Generate"/>
					</td>
				</tr>

			</table>
			<table id="transit-patient" style="display: inline-block">
				<tr>
					<td>Facility from: </td>
					<td> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
						<obsgroup groupingConceptId="162724AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA">
							<obs conceptId="161550AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
						</obsgroup>

					</td>
				</tr>
			</table>
			<div id="transfer-details">
				<ifMode mode="ENTER">
					<script type="text/javascript">
                        jq(function(){
                            //var date_confirmed_positive = <lookup expression="#set( $last_enrollment_enc = $fn.latestEncounter('de78a6be-bfc5-4634-adc3-5f1a280455cc') ) #set ($lastObs = $fn.getObs($last_enrollment_enc, 160554).valueDateTime)" />;

                            var date_confirmed_positive = "<lookup expression="fn.latestObs(160554).getValueDatetime()"/>";
                            var date_enrolled_in_care = "<lookup expression="fn.latestObs(160555).getValueDatetime()"/>";
                            var art_start_date = "<lookup expression="fn.latestObs(159599).getValueDatetime()"/>";

                            if (date_confirmed_positive != null) {
								setValue('confirmed-positive-date.value', moment(moment(date_confirmed_positive, 'DD-MMM-YYYY').toDate()).format('YYYY-MM-DD'));
								getField('confirmed-positive-date.value').prop("readonly", true);
							}

                            if (date_enrolled_in_care != null) {
                                setValue('confirmed-positive-date.value', moment(moment(date_enrolled_in_care, 'DD-MMM-YYYY').toDate()).format('YYYY-MM-DD'));
                                getField('confirmed-positive-date.value').prop("readonly", true);
                            }

                            if (art_start_date != null) {
                                setValue('confirmed-positive-date.value', moment(moment(art_start_date, 'DD-MMM-YYYY').toDate()).format('YYYY-MM-DD'));
                                getField('confirmed-positive-date.value').prop("readonly", true);
                            }
                            //var art_start_date_from_orders = "<lookup expression="fn.earliestObs(1085).getObsDatetime()"/>"; should get from orders

                        });

					</script>
				</ifMode>
				<table>
					<tr>
						<td>Transfer in date:</td>
						<td><obs conceptId="160534AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="transfer-in-date"/></td>
					</tr>
					<tr>
						<td>Transferred from facility:</td>
						<td><obs conceptId="160535AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" /></td>
					</tr>
					<tr>
						<td>Date <i>first</i> enrolled in HIV care:</td>
						<td><obs conceptId="160555AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="first-enrolled-date"/></td>
					</tr>
					<tr>
						<td>Date started ART at transferring facility:</td>
						<td><obs conceptId="159599AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id ="art-start-date"/></td>
					</tr>
				</table>
			</div>
		</fieldset>

		<fieldset id="patient-history" >
			<legend>ART History</legend>

			<table>
				<tr>
					<td>Date patient was confirmed HIV+</td>
					<td><obs conceptId="160554AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="confirmed-positive-date" /></td>
				</tr>
				<tr>
					<td>Facility where confirmation done</td>
					<td><obs conceptId="162724AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/></td>
				</tr>
				<tr>
					<td>WHO Stage <strong><span id="patient-age-group"></span></strong> * </td>
					<td>
						<div id="whoAdult">
							<table>
								<tr>
									<td><obs conceptId="5356AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptIds="1204AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1205AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1206AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1207AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="dropdown" answerLabels="WHO Stage1,WHO Stage2,WHO Stage3,WHO Stage4" /></td>
								</tr>
							</table>
						</div>
						<div id="whoChild">
							<table>
								<tr>
									<td><obs conceptId="5356AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptIds="1220AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1221AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1222AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA," style="dropdown" answerLabels="WHO Stage1,WHO Stage2,WHO Stage3,WHO Stage4" /></td>
								</tr>
							</table>
						</div>
					</td>
				</tr>
				<tr>
					<td>Patient has been on ARVs (inc. PEP &amp; PMTCT)</td>
					<td>
						<obs id="art-status" conceptId="160533AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="yes_no" />
					</td>
				</tr>

			</table>

			<br />

			<table id="art-history" border="0" style="background-color: #EEE">
				<tr>
					<td style="background-color: #696969; color: #ffffff;">Purpose</td>
					<td style="background-color: #696969; color: #ffffff;">List Drug Names and Dates Last Used</td>
				</tr>
				<obsgroup groupingConceptId="160741AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA">
					<tr>
						<td><obs conceptId="1148AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="PMTCT" /></td>
						<td><obs conceptId="966AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
								 answerConceptIds="792AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160124AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160104AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1652AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,161361AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,104565AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162201AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,817AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
							                       162199AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162200AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162565AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1652AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162561AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,164511AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,164512AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162560AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
                                                     162563AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162562AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162559AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
								 answerLabels="D4T/3TC/NVP,
											   AZT/3TC/EFV,
											   D4T/3TC/EFV,
											   3TC/NVP/AZT,
											   EDF/3TC/EFV,
											   EFV/FTC/TDF,
											   3TC/LPV/TDF/r,
											   ABC/3TC/AZT,
										       ABC/NVP/3TC,
											   3TC/ABC/LPV/r,
							                   3TC/NVP/TDF,
                                               3TC/NVP/AZT,
                                               3TC/AZT/LPV/r,
                                               AZT-3TC-ATV/r,
                                               TDF-3TC-ATV/r,
                                               3TC/D4T/LPV/r,
                                               3TC/ABC/EFV,
                                               ABC/LPV/R/TDF,
                                               ABC/DDI/LPV/r"
								 dateLabel="" defaultDatetime=""/></td>
					</tr>
				</obsgroup>
				<obsgroup groupingConceptId="160741AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA">
					<tr>
						<td><obs conceptId="1691AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="checkbox"  labelText="PEP" /></td>
						<td><obs conceptId="1088AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
								 answerConceptIds="792AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160124AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160104AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1652AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,161361AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,104565AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162201AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,817AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
							                       162199AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162200AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162565AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1652AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162561AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,164511AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,164512AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162560AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
                                                     162563AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162562AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162559AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
								 answerLabels="D4T/3TC/NVP,
											   AZT/3TC/EFV,
											   D4T/3TC/EFV,
											   3TC/NVP/AZT,
											   EDF/3TC/EFV,
											   EFV/FTC/TDF,
											   3TC/LPV/TDF/r,
											   ABC/3TC/AZT,
										       ABC/NVP/3TC,
											   3TC/ABC/LPV/r,
							                   3TC/NVP/TDF,
                                               3TC/NVP/AZT,
                                               3TC/AZT/LPV/r,
                                               AZT-3TC-ATV/r,
                                               TDF-3TC-ATV/r,
                                               3TC/D4T/LPV/r,
                                               3TC/ABC/EFV,
                                               ABC/LPV/R/TDF,
                                               ABC/DDI/LPV/r"
								 dateLabel="" /></td>
					</tr>
				</obsgroup>
				<obsgroup groupingConceptId="160741AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA">
					<tr>
						<td><obs conceptId="1691AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="checkbox"  labelText="PREP" /></td>
						<td><obs conceptId="1088AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
								 answerConceptIds="792AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160124AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160104AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1652AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,161361AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,104565AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162201AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,817AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
							                       162199AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162200AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162565AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1652AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162561AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,164511AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,164512AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162560AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
                                                     162563AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162562AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162559AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
								 answerLabels="D4T/3TC/NVP,
											   AZT/3TC/EFV,
											   D4T/3TC/EFV,
											   3TC/NVP/AZT,
											   EDF/3TC/EFV,
											   EFV/FTC/TDF,
											   3TC/LPV/TDF/r,
											   ABC/3TC/AZT,
										       ABC/NVP/3TC,
											   3TC/ABC/LPV/r,
							                   3TC/NVP/TDF,
                                               3TC/NVP/AZT,
                                               3TC/AZT/LPV/r,
                                               AZT-3TC-ATV/r,
                                               TDF-3TC-ATV/r,
                                               3TC/D4T/LPV/r,
                                               3TC/ABC/EFV,
                                               ABC/LPV/R/TDF,
                                               ABC/DDI/LPV/r"
								 dateLabel="" /></td>
					</tr>
				</obsgroup>

				<obsgroup groupingConceptId="1085AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA">
					<tr>
						<td><obs conceptId="1181AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"    answerConceptId="1185AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="HAART"/></td>
						<td><obs conceptId="1088AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
								 answerConceptIds="792AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160124AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160104AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1652AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,161361AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,104565AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162201AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,817AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
							                       162199AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162200AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162565AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1652AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162561AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,164511AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,164512AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162560AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
                                                     162563AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162562AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162559AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
								 answerLabels="D4T/3TC/NVP,
											   AZT/3TC/EFV,
											   D4T/3TC/EFV,
											   3TC/NVP/AZT,
											   EDF/3TC/EFV,
											   EFV/FTC/TDF,
											   3TC/LPV/TDF/r,
											   ABC/3TC/AZT,
										       ABC/NVP/3TC,
											   3TC/ABC/LPV/r,
							                   3TC/NVP/TDF,
                                               3TC/NVP/AZT,
                                               3TC/AZT/LPV/r,
                                               AZT-3TC-ATV/r,
                                               TDF-3TC-ATV/r,
                                               3TC/D4T/LPV/r,
                                               3TC/ABC/EFV,
                                               ABC/LPV/R/TDF,
                                               ABC/DDI/LPV/r"
								 dateLabel="" /></td>
					</tr>
				</obsgroup>
			</table>
		</fieldset>
		<!-- Baseline assessments  -->
		<fieldset>
			<legend>Baseline assessment</legend>

			<table id="baseline-assessment1" cellspacing="10" style="float:left; ">

				<tr>
					<td>HBV Infected</td>
					<td>
						<obs conceptId="6032AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
							 answerConceptIds="111759AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
							 answerLabels="Yes,No"
							 style="radio"
						/>
					</td>
				</tr>

				<tr>
					<td>TB Infected</td>
					<td>
						<obs conceptId="164500AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
							 answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
							 answerLabels="Yes,No"
							 style="radio"
						/>
					</td>
				</tr>
				<tr>
					<td>Pregnant</td>
					<td>
						<obs id = "pregnant" conceptId="5272AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
							 answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
							 answerLabels="Yes,No"
							 style="radio"
						/>
					</td>
				</tr>
				<tr>
					<td>Breastfeeding</td>
					<td>
						<obs id = "breastfeeding" conceptId="5632AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
							 answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
							 answerLabels="Yes,No"
							 style="radio"
						/>
					</td>
				</tr>
			</table>
			<table id="baseline-assessment2" cellspacing="10" style="float: left;">
				<tr class="patient-details">
					<td colspan="2"></td>
					<td>Weight</td>
					<td>
						<obs id="weight" conceptId="5089AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" required="true" />
						kg
					</td>


				</tr>
				<tr class="patient-details">
					<td colspan="2"></td>
					<td>Height</td>
					<td>
						<obs id="height" conceptId="5090AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" required="true" />
						cm
					</td>

				</tr>

						<tr class="bmi">
							<td colspan="2"></td>
							<td>BMI</td>
							<td><span id="calculated-bmi" class="value"></span></td>
						</tr>

			          <tr class="muac">
									<td colspan="2"></td>
									<td>MUAC</td>
									<td>
										<obs conceptId="1343AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
									</td>
					</tr>
			</table>
				<table id="baseline-assessment3" cellspacing="10" style="display: inline-block">
				<tr class="patient-details">
					<td colspan="2"></td>
					<td>CD4 Count</td>
					<td>
						<obs id="cd4-count" conceptId="5497AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
						cells/uL
					</td>
				</tr>
				<tr class="patient-details">
					<td colspan="2"></td>
					<td>HIV Viral Load</td>
					<td>
						<obs id="viral-load" conceptId="856AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
						copies/ml
					</td>

				</tr>
				<tr class="patient-details">
					<td colspan="2"></td>
					<td>HIV Viral Load(LDL)</td>
					<td><obs conceptId="1305AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="1302AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="LDL" id="ldl" /></td>
				</tr>
				<tr class="patient-details">
					<td colspan="2"></td>
					<td>Regimen</td>
					<td>
						<obs id="patient-regimen" conceptId="164855AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
							 answerConceptIds="792AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160124AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160104AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1652AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,161361AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,104565AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162201AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,817AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
							                       162199AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162200AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162565AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1652AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162561AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,164511AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,164512AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162560AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
                                                     162563AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162562AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162559AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
							 answerLabels="D4T/3TC/NVP,
											   AZT/3TC/EFV,
											   D4T/3TC/EFV,
											   3TC/NVP/AZT,
											   EDF/3TC/EFV,
											   EFV/FTC/TDF,
											   3TC/LPV/TDF/r,
											   ABC/3TC/AZT,
										       ABC/NVP/3TC,
											   3TC/ABC/LPV/r,
							                   3TC/NVP/TDF,
                                               3TC/NVP/AZT,
                                               3TC/AZT/LPV/r,
                                               AZT-3TC-ATV/r,
                                               TDF-3TC-ATV/r,
                                               3TC/D4T/LPV/r,
                                               3TC/ABC/EFV,
                                               ABC/LPV/R/TDF,
                                               ABC/DDI/LPV/r"

						/>
					</td>
				</tr>
			</table>
		</fieldset>
		<fieldset>
			<legend>Treatment Supporter</legend>
			<table id="treatment-supporter" style="width: 70%;" border="0">
				<tr>
					<th align="left">Name</th>
					<th align="left">Relationship</th>
					<th align="left">Telephone Number</th>
					<th align="left">Postal Addrress</th>
				</tr>
				<repeat>
					<template>
						<obsgroup groupingConceptId="161642AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA">
							<tr>
								<td>
									<obs conceptId="160638AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" />
								</td>
								<td>
									<obs
										id="treatment-supporter-relationship" conceptId="160640AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="dropdown"
										answerConceptIds="973AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,972AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160639AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1527AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5617AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,163565AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5622AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
										answerLabels="Grandparent,Sibling,Guardian,Parent,Spouse,Partner,Other"
								/>
								</td>
								<td><obs conceptId="160642AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/></td>
								<td><obs conceptId="160641AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/></td>

							</tr>
						</obsgroup>
					</template>
					<render n="11" concept="Treatment Supporter"/>
					<render n="12" concept="Treatment Supporter"/>
			</repeat>
			</table>
		</fieldset>

		<enrollInProgram programId="dfdc6d40-2f2f-463d-ba90-cc97350441a8"/>
	</div>

	<div class="ke-form-footer">
		<submit />
	</div>
</htmlform>