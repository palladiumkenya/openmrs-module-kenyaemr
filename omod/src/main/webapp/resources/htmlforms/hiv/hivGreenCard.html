<!--
  ~ The contents of this file are subject to the OpenMRS Public License
  ~ Version 1.0 (the "License"); you may not use this file except in
  ~ compliance with the License. You may obtain a copy of the License at
  ~ http://license.openmrs.org
  ~
  ~ Software distributed under the License is distributed on an "AS IS"
  ~ basis, WITHOUT WARRANTY OF ANY KIND, either express or implied. See the
  ~ License for the specific language governing rights and limitations
  ~ under the License.
  ~
  ~ Copyright (C) OpenMRS, LLC.  All Rights Reserved.
-->
<!--
Green Card follow-up visit form
-->
<htmlform>

    <style type="text/css">


        table.right-aligned-first td:first-child {
            text-align: right;
        }
        table.link {
            text-align: right;
            border:2px solid darkgray;
            padding: inherit;
        }
        .show-links {
            text-align: right;
            border:2px solid darkgray;
            padding: inherit;

        }
        /* The Modal  */
        .modal {
            display: none; /* Hidden by default */
            position: fixed; /* Stay in place */
            z-index: 1; /* Sit on top */
            left: 0;
            top: 0;
            width: 100%; /* Full width */
            height: 100%; /* Full height */
            overflow: auto; /* Enable scroll if needed */
            background-color: rgb(0,0,0); /* Fallback color */
            background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
        }

        /* Modal Content/Box */
        .modal-content {
            background-color: #fefefe;
            margin: 15% auto; /* 15% from the top and centered */
            padding: 20px;
            border: 1px solid #888;
            width: 80%; /* Could be more or less, depending on screen size */
        }
        /* Modal Footer */
        .modal-footer {
            padding: 2px 16px;
            background-color: #fefefe;
            color: white;
        }

        /* The Close Button */
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }

        .close:hover,
        .close:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }


    /* .Modal  */
    </style>

    <script type="text/javascript" src="../moduleResources/kenyaemr/scripts/moment.js"></script>
    <!--Wizard plugins-->

    <link rel="stylesheet" href="../moduleResources/kenyaemr/styles/smart_wizard.css" type="text/css" ></link>

    <link rel="stylesheet" href="../moduleResources/kenyaemr/styles/smart_wizard.css" type="text/css" ></link>

    <script type="text/javascript" src="../moduleResources/kenyaemr/scripts/jquery.smartWizard.js"></script>

    <script type="text/javascript">

        var bmi = null;
        var SELF = 978;
        function onWeightOrHeightChange() {
            pAge = parseInt('<lookup expression="patient.age"/>');
            var display = '';
            var weightKg = parseFloat(getValue('weight.value'));
            var heightM = parseFloat(getValue('height.value')) / 100;
            if (pAge &gt; 14) {
                if (!isNaN(weightKg) &amp;&amp; !isNaN(heightM)) {
                    bmi = weightKg / (heightM * heightM);
                    if (isNaN(bmi) || bmi &lt; 10 || bmi &gt; 50) {
                        display = 'Abnormal value. Were height and height entered correctly?';
                    }
                    else {
                        display = bmi.toFixed(2);
                    }
                }
                //set nutritional status and bmi
                jq('#calculated-bmi').html(display);
                if (bmi &lt; 16) {
                    jq("#nutritional-status input[value=163302]").prop("checked", true);
                } else if (bmi &gt; 16 &amp;&amp; bmi &lt; 18.5) {
                    jq("#nutritional-status input[value=163303]").prop("checked", true);
                } else if (bmi &gt; 18.5 &amp;&amp; bmi &lt; 25) {
                    jq("#nutritional-status input[value=1115]").prop("checked", true);
                } else if (bmi &gt; 25) {
                    jq("#nutritional-status input[value=114413]").prop("checked", true);
                }
            }
        }
        function onEncounterDateChange() {
            var patientId = <lookup expression="patient.patientId"/>;
            var encDate = getValue('encounter-date.value');
            if(encDate == null) {
                encDate = new Date();
            }
            jq.getJSON('/' + OPENMRS_CONTEXT_PATH + '/kenyaemr/emrUtils/durationSinceStartArt.action', { patientId: patientId, now: encDate })
                .done(function(data) {
                    var msg = data.duration ? data.duration : 'Not started';
                    jq('#calculated-duration-start-art').html(msg);
                });
            jq.getJSON('/' + OPENMRS_CONTEXT_PATH + '/kenyaemr/emrUtils/currentArvRegimen.action', { patientId: patientId, now: encDate })
                .done(function(data) {
                    var msg = data.duration ? (data.regimen ) : 'None';
                    jq('#calculated-duration-current-regimen').html(msg);
                });
        }
        function displayRecentBmi() {
            pAge = parseInt('<lookup expression="patient.age"/>');
            var weightKg = "<lookup expression="fn.latestObs(5089).valueNumeric"/>"
            var heightM = ("<lookup expression="fn.latestObs(5090).valueNumeric"/>")/100
            var bmi = '';
            var recent_bmi ='';
            if (pAge &gt; 14) {
                if (!isNaN(weightKg) &amp;&amp; !isNaN(heightM)) {
                    bmi = weightKg / (heightM * heightM);
                    recent_bmi = bmi.toFixed(2);
                    jq('#recent-calculated-bmi').html(recent_bmi);

                    //set recent nutritional status from recent bmi
                    if (recent_bmi &lt; 16) {
                        jq("#nutritional-status input[value=163302]").prop("checked", true);
                    } else if (recent_bmi &gt; 16 &amp;&amp; recent_bmi &lt; 18.5) {
                        jq("#nutritional-status input[value=163303]").prop("checked", true);
                    } else if (recent_bmi &gt; 18.5 &amp;&amp; recent_bmi &lt; 25) {
                        jq("#nutritional-status input[value=1115]").prop("checked", true);
                    } else if (recent_bmi &gt; 25) {
                        jq("#nutritional-status input[value=114413]").prop("checked", true);
                    }
                }
            }
        }
        function onLmpChange() {
            jq('#pregnancyOption :input').prop('disabled', false);
        }
        function patientLMPStatus(){
            var val = getValue('hasLMP.value');
            var ifPatientPregnant =  jq('#if-patient-pregnant');
            var pregIntention = jq("#pregnancyIntention");
            if(val == 1065){
                jq('#if-patient-pregnant').show();
                jq('#lmp-date :input').prop('disabled', false);
            }
            if(val == 1066){
                jq('#if-patient-pregnant').hide();
                jq('#pregnancyOptionValues').hide();
                jq('#fp-details').hide();
                jq("#wants-pregnancy").hide();
                clearHiddenSections(ifPatientPregnant);
                clearHiddenSections(pregIntention);
            }
            if(val == 1175){
                jq('#if-patient-pregnant').hide();
                jq('#pregnancyOptionValues').hide();
                jq('#fp-details').hide();
                jq("#wants-pregnancy").hide();
                clearHiddenSections(ifPatientPregnant);
                clearHiddenSections(pregIntention);
            }
        }
        function onPersonPresentChange() {
            if (getValue('person-present.value') == SELF) {
                jq('.patient-details :input').prop('disabled', false);
            } else {
                jq('.patient-details :input').prop('disabled', true);
            }
        }
        function onRecordIPTOutcome() {
            jq("#tbl-ipt-outcome").toggle();
        }

        function onParityChange() {
            var gravida = '';
            var parityTerm = parseInt(getValue('parity-term.value'));
            var parityAbortion = parseInt(getValue('parity-abortion.value'));
            if (!isNaN(parityTerm) &amp;&amp; !isNaN(parityAbortion)) {
                gravida = parityTerm + parityAbortion + 1;
                getField('gravida.value').val(gravida);
            }
        }
        var generalExamSelected = function(){
            var val = jq(this).val();
            var generalExamsChecked = jq("#general-exam-findings input:checkbox:checked");
            if(val == 1107 &amp;&amp; generalExamsChecked.length ==1){
                jq("#general-exam-findings input[type=checkbox]").prop("disabled",true);
                jq(this).prop("disabled",false);
            }else {
                jq("#general-exam-findings input[type=checkbox]").prop("disabled",false);
                jq("#general-exam-findings input[value=1107]").prop("disabled",true);
            }
            if(generalExamsChecked.length ==0){
                jq("#general-exam-findings input[value=1107]").prop("disabled",false);
            }
        }
        var complaintSelected = function() {
            var val = getValue('complaints-today.value');

            var complaint = jq('.complaint');
            var complaintDuration = jq('.complaint-time input').val('');
            var complaintDate = jq('.complaint-date input').val('');
            if (val == "false"){
                jq("#tbl-complaints-today").hide();
                clearHiddenSections(complaint);
                clearHiddenSections(complaintDuration);
                clearHiddenSections(complaintDate);
            }else {
                jq("#tbl-complaints-today").show();
            }
        }
        var complaintDurationInput = function() {

            var table = document.getElementById("tbl-complaints-today");
            for (var i = 0, row; row = table.rows[i]; i++) {
                var val = jq(this).closest('tr').find(".complaint-time input").val();
                var encounterDate = new Date(getValue('encounter-date.value'));
                var formattedComplaintDate = moment(moment(encounterDate, 'YYYY-MM-DD').subtract(val, 'days').toDate()).format('YYYY-MM-DD');
                if(val >0 ) {
                    jq(this).closest('tr').find(".complaint-date input").val(formattedComplaintDate);
                }
            }
        }
        var adverseReactionSelected = function() {
            var val = getValue('adverse-reactions.value');
            var medicineCausing= jq('.medicine-causing');
            var reaction = jq('.reaction');
            var severity = jq('.severity');
            var onsetDate = jq('.adverse-events-onset-date input').val('');
            var action = jq('.action-taken');

            if (val == "false"){
                jq("#tbl-adverse-reactions").hide();
                clearHiddenSections(medicineCausing);
                clearHiddenSections(reaction);
                clearHiddenSections(severity);
                clearHiddenSections(onsetDate);
                clearHiddenSections(action);

            }else {
                jq("#tbl-adverse-reactions").show();
            }
        }
        var knownAllergiesSelected = function() {
            var val = getValue('known-allergies.value');
            var allergy = jq('.allergen');
            var reaction = jq('.reaction');
            var severity = jq('.severity');
            var date = jq('.allergy-date input').val('');
            if (val == "false"){
                jq("#tbl-known-allergies").hide();
                clearHiddenSections(allergy);
                clearHiddenSections(reaction);
                clearHiddenSections(severity);
                clearHiddenSections(date);

            }else {
                jq("#tbl-known-allergies").show();
            }
        }
        var systemsReviewSelected = function() {
            var val = jq(this).val();
            var skinFindings = jq('.skin-findings');
            var skinNotes = jq('.skin-notes textarea').val('');
            var eyeFindings = jq('.eye-findings');
            var eyeNotes = jq('.eye-notes textarea').val('');
            var entFindings = jq('.ent-findings');
            var entNotes = jq('.ent-notes textarea').val('');
            var chestFindings = jq('.chest-findings');
            var chestNotes = jq('.chest-notes textarea').val('');
            var cvsFindings = jq('.cvs-findings');
            var cvsNotes = jq('.cvs-notes textarea').val('');
            var abdomenFindings = jq('.abdomen-findings');
            var abdomenNotes = jq('.abdomen-notes textarea').val('');
            var cnsFindings = jq('.cns-findings');
            var cnsNotes = jq('.cns-notes textarea').val('');
            var gusFindings = jq('.gus-findings');
            var gusNotes = jq('.gus-notes textarea').val('');
            if (val == 1115){
                jq("#tbl-systems-review").hide();
                clearHiddenSections(skinFindings);
                clearHiddenSections(skinNotes);
                clearHiddenSections(eyeFindings);
                clearHiddenSections(eyeNotes);
                clearHiddenSections(entFindings);
                clearHiddenSections(entNotes);
                clearHiddenSections(chestFindings);
                clearHiddenSections(chestFindings);
                clearHiddenSections(cvsFindings);
                clearHiddenSections(cvsNotes);
                clearHiddenSections(abdomenFindings);
                clearHiddenSections(abdomenNotes);
                clearHiddenSections(cnsFindings);
                clearHiddenSections(cnsNotes);
                clearHiddenSections(gusFindings);
                clearHiddenSections(gusNotes);
            }else {
                jq("#tbl-systems-review").show();
            }
        }
        var chronicIllnessesSelected = function() {
            var val = jq(this).val();

            var illness = jq('.illness-chronic');
            var onset = jq('.onset-date-chronic-illness input').val('');
            var drug = jq('.drug-chronic-illness input').val('');
            var dose = jq('.dose-chronic-illness input').val('');
            var units = jq('.units-chronic-illness input').val('');
            var frequency = jq('.frequency-chronic-illness');
            var duration = jq('.duration-chronic-illness input').val('');
            var durationUnits = jq('.duration-units-illness');

            if (val == 1066){
                jq("#tbl-chronic-illness").hide();
                clearHiddenSections(illness);
                clearHiddenSections(onset);
                clearHiddenSections(drug);
                clearHiddenSections(dose);
                clearHiddenSections(units);
                clearHiddenSections(frequency);
                clearHiddenSections(duration);
                clearHiddenSections(durationUnits);
            }else {
                jq("#tbl-chronic-illness").show();
            }
        }

        var screenedStiSelected = function() {
            var val = jq(this).val();
            var partnerNotification = jq("#tbl-partner-notification");
            if (val == 703){
                jq("#tbl-partner-notification").show();

            }else {
                jq("#tbl-partner-notification").hide();
                clearHiddenSections(partnerNotification);
            }
        }
        var onAntiTbDrugs = function(){
            var val = jq(this).val();
            var onIpt = jq('#on-ipt');
            var actionTakenTab = jq('#action-taken');
            var iptClientWorkupTab = jq('#ipt-client-workup');
            var iptFollowup = jq('#ipt-followup');
            var tbScreeningQuestionsTab = jq("#tb-screening-tab");
            var iptInitiationTab = jq('#ipt-initiation');
            everOnIPTSelected = null;
            patientCurrentlyOnIPT = null;
            if(val == 1066) {
                jq('#on-ipt input').prop("disabled", false);
            }
            if(val == 1065){
                jq('#on-ipt input').prop("disabled", true);
                jq('input[type=radio].on-ipt').prop("checked", false);
                jq("#tb-screening-result").hide();
                jq("#tb-screening-tab").hide();
                jq("#tbl-ever-on-ipt").hide();
                jq("#ipt-uptake").hide();
                clearRadios(onIpt);
                actionTakenTab.hide();
                clearRadios(actionTakenTab);
                iptClientWorkupTab.hide()
                clearRadios(iptClientWorkupTab);
                iptFollowup.hide();
                clearRadios(iptFollowup);
                tbScreeningQuestionsTab.hide();
                clearRadios(tbScreeningQuestionsTab);
                iptInitiationTab.hide();

            }
        }

        var onIPT = function(){
            var val = jq(this).val();
            patientCurrentlyOnIPT = val;
            everOnIPTSelected = null;
            var everOnIpt = jq("#tbl-ever-on-ipt");
            var actionTakenTab = jq('#action-taken');
            var iptClientWorkupTab = jq('#ipt-client-workup');
            var iptFollowup = jq('#ipt-followup');
            var tbScreeningQuestionsTab = jq("#tb-screening-tab");
            var iptInitiationTab = jq('#ipt-initiation');
            var tbScreeningResult = jq("#tb-screening-result");
            if(val == 1066) {

                jq("#tbl-ever-on-ipt").show();
                jq("#ipt-uptake").hide();
                iptFollowup.hide();
                actionTakenTab.hide();
                tbScreeningQuestionsTab.hide();
                tbScreeningResult.hide();

                //clear radios in hidden sections
                clearRadios(everOnIpt);
                clearRadios(iptFollowup);
                clearRadios(actionTakenTab);
                clearRadios(tbScreeningQuestionsTab);
                clearRadios(tbScreeningResult);

            } else {
                jq("#tbl-ever-on-ipt").hide();
                jq("#ipt-followup").show();
                tbScreeningQuestionsTab.hide();
                jq("#tb-screening-result").show();
                iptClientWorkupTab.hide();
                actionTakenTab.hide();
                jq("#ipt-uptake").show();
                iptInitiationTab.hide();
                //clear radios
                clearRadios(iptClientWorkupTab);
                clearRadios(tbScreeningQuestionsTab);
                clearRadios(actionTakenTab);
            }
        }

        var everOnIPT = function () {
            var val = jq(this).val();
            everOnIPTSelected = val;
            var tbScreeningResultTab = jq("#tb-screening-result");
            var tbScreeningTab = jq("#tb-screening-tab");
            var iptClientWorkupTab = jq('#ipt-client-workup');
            var actionTakenTab = jq('#action-taken');
            var iptInitiationTab = jq('#ipt-initiation');
            if(val == 1066) {
                // show TB screening, TB results and IPT workup forms
                tbScreeningTab.show();
                tbScreeningResultTab.show();
                iptClientWorkupTab.hide();
                actionTakenTab.hide();
                //clear radios
                clearRadios(iptClientWorkupTab);
                clearRadios(tbScreeningTab);
                clearRadios(actionTakenTab);

            } else {
                // show TB screening and TB result forms
                iptClientWorkupTab.hide();
                tbScreeningTab.show();
                tbScreeningResultTab.show();
                actionTakenTab.hide();
                iptInitiationTab.hide();

                //clear radios for hidden sections
                clearRadios(iptClientWorkupTab);
                clearRadios(tbScreeningTab);
                clearRadios(actionTakenTab);
            }
        }
        var ageGroup = function () {
            pAge = parseInt('<lookup expression="patient.age"/>');
            if (pAge &gt; 15) {
                whoChild.style.display='none';
            }
            if (pAge &lt; 15) {
                whoAdult.style.display='none';
            }
        }
        var populationTypeSelected = function () {
            var val = jq(this).val();
            var keypop = jq('#key-population');
            if (val == 164929 ){
                jq("#key-population").show();
            }
            if(val == 164928){
                jq("#key-population").hide();
                clearHiddenSections(keypop);
            }
        }
        //Resulting TB status for Ordered test
        var testOrdered  = function () {
            var val = jq(this).val();
            var testOrderedChecked = jq("#tb-test-ordered input:checkbox:checked");
            var sputumSmear = getValue("sputum-smear-action.value");
            var geneXpert = getField("genexpert-action.value").val();
            var referral = getValue("referral-action.value");
            var clinicalDiagnosis = getValue("clinical-diagnosis-action.value");
            var xray = getValue("chest-xray-action.value");

             //TB
            if(clinicalDiagnosis ==703) {
                jq("#tb-result-status input[value=1660]").prop("checked", false);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", true);
                jq('#ipt-client-workup').hide();

            }
              //No signs
            if((clinicalDiagnosis !=703) &amp;&amp; (testOrderedChecked.length &lt; 0 || referral !=1065 || sputumSmear !=703 || xray !=152526 || geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104)){
                jq("#tb-result-status input[value=1660]").prop("checked", true);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
            }
            //No signs with normal/negative Tests results
            if((clinicalDiagnosis !=703) &amp;&amp; ((testOrderedChecked.length &gt; 0 &amp;&amp; sputumSmear ==664) || (testOrderedChecked.length &gt; 0 &amp;&amp; xray ==1115) || (testOrderedChecked.length &gt; 0 &amp;&amp; (geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104)))){
                jq("#tb-result-status input[value=1660]").prop("checked", true);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
            }
            //Presumed TB  with abnormal/positive Tests results
            if((clinicalDiagnosis !=703) &amp;&amp; ((testOrderedChecked.length &gt; 0 &amp;&amp; sputumSmear ==703) || (testOrderedChecked.length &gt; 0 &amp;&amp; xray ==152526) || (testOrderedChecked.length &gt; 0 &amp;&amp; (geneXpert ==162203 || geneXpert ==162204 || geneXpert ==164104)))){
                jq("#tb-result-status input[value=1660]").prop("checked", true);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
            }
            //Presumed TB
            if((clinicalDiagnosis !=703) &amp;&amp; (testOrderedChecked.length &gt; 0 || referral ==1065 || sputumSmear ==703 || xray ==152526 || geneXpert ==162203 || geneXpert ==162204 || geneXpert ==164104)){
                jq("#tb-result-status input[value=1660]").prop("checked", false);
                jq("#tb-result-status input[value=142177]").prop("checked", true);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
            }
        }

        //Resulting TB status for Action Positive Sputum smear
        var sputumSmearAction  = function () {
            var sputumSmear = getValue("sputum-smear-action.value");
            var geneXpert = getField("genexpert-action.value").val();
            var clinicalDiagnosis = getValue("clinical-diagnosis-action.value");
            var xray = getValue("chest-xray-action.value");
            var referral = getValue("referral-action.value");
            var testOrderedChecked = jq("#tb-test-ordered input:checkbox:checked");

            //TB
            if(clinicalDiagnosis ==703) {
                jq("#tb-result-status input[value=1660]").prop("checked", false);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", true);
                jq('#ipt-client-workup').hide();

            }
            //No signs
            if((clinicalDiagnosis !=703) &amp;&amp; (testOrderedChecked.length &lt; 0 || referral !=1065 || sputumSmear !=703 || xray !=152526 || geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104)){
                jq("#tb-result-status input[value=1660]").prop("checked", true);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
            }
            //No signs with normal/negative Tests results
            if((clinicalDiagnosis !=703) &amp;&amp; ((testOrderedChecked.length &gt; 0 &amp;&amp; sputumSmear ==664) || (testOrderedChecked.length &gt; 0 &amp;&amp; xray ==1115) || (testOrderedChecked.length &gt; 0 &amp;&amp; (geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104)))){
                jq("#tb-result-status input[value=1660]").prop("checked", true);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
            }
            //Presumed TB  with abnormal/positive Tests results
            if((clinicalDiagnosis !=703) &amp;&amp; ((testOrderedChecked.length &gt; 0 &amp;&amp; sputumSmear ==703) || (testOrderedChecked.length &gt; 0 &amp;&amp; xray ==152526) || (testOrderedChecked.length &gt; 0 &amp;&amp; (geneXpert ==162203 || geneXpert ==162204 || geneXpert ==164104)))){
                jq("#tb-result-status input[value=1660]").prop("checked", false);
                jq("#tb-result-status input[value=142177]").prop("checked", true);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
            }
            //Presumed TB
            if((clinicalDiagnosis !=703) &amp;&amp; (testOrderedChecked.length &lt; 0 || referral ==1065 || sputumSmear ==703 || xray ==152526 || geneXpert ==162203 || geneXpert ==162204 || geneXpert ==164104)){
                jq("#tb-result-status input[value=1660]").prop("checked", false);
                jq("#tb-result-status input[value=142177]").prop("checked", true);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
            }
        }
        //Resulting TB status for Action Positive GeneXpert
        var geneXpertAction  = function () {

            var geneXpert = getField("genexpert-action.value").val();
            var sputumSmear = getValue("sputum-smear-action.value");
            var clinicalDiagnosis = getValue("clinical-diagnosis-action.value");
            var xray = getValue("chest-xray-action.value");
            var referral = getValue("referral-action.value");
            var testOrderedChecked = jq("#tb-test-ordered input:checkbox:checked");

            //TB
            if(clinicalDiagnosis ==703) {
                jq("#tb-result-status input[value=1660]").prop("checked", false);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", true);
                jq('#ipt-client-workup').hide();

            }
            //No signs
            if((clinicalDiagnosis !=703) &amp;&amp; (testOrderedChecked.length &lt; 0 || referral !=1065 || sputumSmear !=703 || xray !=152526 || geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104)){
                jq("#tb-result-status input[value=1660]").prop("checked", true);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
            }
            //No signs with normal/negative Tests results
            if((clinicalDiagnosis !=703) &amp;&amp; ((testOrderedChecked.length &gt; 0 &amp;&amp; sputumSmear ==664) || (testOrderedChecked.length &gt; 0 &amp;&amp; xray ==1115) || (testOrderedChecked.length &gt; 0 &amp;&amp; (geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104)))){
                jq("#tb-result-status input[value=1660]").prop("checked", true);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
            }
            //Presumed TB  with abnormal/positive Tests results
            if((clinicalDiagnosis !=703) &amp;&amp; ((testOrderedChecked.length &gt; 0 &amp;&amp; sputumSmear ==703) || (testOrderedChecked.length &gt; 0 &amp;&amp; xray ==152526) || (testOrderedChecked.length &gt; 0 &amp;&amp; (geneXpert ==162203 || geneXpert ==162204 || geneXpert ==164104)))){
                jq("#tb-result-status input[value=1660]").prop("checked", false);
                jq("#tb-result-status input[value=142177]").prop("checked", true);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
            }
            //Presumed TB
            if((clinicalDiagnosis !=703) &amp;&amp; (testOrderedChecked.length &lt; 0 || referral ==1065 || sputumSmear ==703 || xray ==152526 || geneXpert ==162203 || geneXpert ==162204 || geneXpert ==164104)){
                jq("#tb-result-status input[value=1660]").prop("checked", false);
                jq("#tb-result-status input[value=142177]").prop("checked", true);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
            }

        }
        //Resulting TB status for Abnormal chest x ray
        var chestXrayAction = function () {
            var xray = getValue("chest-xray-action.value");
            var sputumSmear = getValue("sputum-smear-action.value");
            var geneXpert = getField("genexpert-action.value").val();
            var referral = getValue("referral-action.value");
            var clinicalDiagnosis = getValue("clinical-diagnosis-action.value");
            var testOrderedChecked = jq("#tb-test-ordered input:checkbox:checked");

            //TB
            if(clinicalDiagnosis ==703) {
                jq("#tb-result-status input[value=1660]").prop("checked", false);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", true);
                jq('#ipt-client-workup').hide();

            }
            //No signs
            if((clinicalDiagnosis !=703) &amp;&amp; (testOrderedChecked.length &lt; 0 || referral !=1065 || sputumSmear !=703 || xray !=152526 || geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104)){
                jq("#tb-result-status input[value=1660]").prop("checked", true);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
            }
            //No signs with normal/negative Tests results
            if((clinicalDiagnosis !=703) &amp;&amp; ((testOrderedChecked.length &gt; 0 &amp;&amp; sputumSmear ==664) || (testOrderedChecked.length &gt; 0 &amp;&amp; xray ==1115) || (testOrderedChecked.length &gt; 0 &amp;&amp; (geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104)))){
                jq("#tb-result-status input[value=1660]").prop("checked", true);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
            }
            //Presumed TB  with abnormal/positive Tests results
            if((clinicalDiagnosis !=703) &amp;&amp; ((testOrderedChecked.length &gt; 0 &amp;&amp; sputumSmear ==703) || (testOrderedChecked.length &gt; 0 &amp;&amp; xray ==152526) || (testOrderedChecked.length &gt; 0 &amp;&amp; (geneXpert ==162203 || geneXpert ==162204 || geneXpert ==164104)))){
                jq("#tb-result-status input[value=1660]").prop("checked", false);
                jq("#tb-result-status input[value=142177]").prop("checked", true);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
            }
            //Presumed TB
            if((clinicalDiagnosis !=703) &amp;&amp; (testOrderedChecked.length &lt; 0 || referral ==1065 || sputumSmear ==703 || xray ==152526 || geneXpert ==162203 || geneXpert ==162204 || geneXpert ==164104)){
                jq("#tb-result-status input[value=1660]").prop("checked", false);
                jq("#tb-result-status input[value=142177]").prop("checked", true);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
            }
        }
        //Resulting TB status for Action Referral
        var referralAction  = function () {
            var referral = getValue("referral-action.value");
            var sputumSmear = getValue("sputum-smear-action.value");
            var geneXpert = getField("genexpert-action.value").val();
            var clinicalDiagnosis = getValue("clinical-diagnosis-action.value");
            var xray = getValue("chest-xray-action.value");
            var testOrderedChecked = jq("#tb-test-ordered input:checkbox:checked");

            //TB
            if(clinicalDiagnosis ==703) {
                jq("#tb-result-status input[value=1660]").prop("checked", false);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", true);
                jq('#ipt-client-workup').hide();
            }
            //No signs
            if((clinicalDiagnosis !=703) &amp;&amp; (testOrderedChecked.length &lt; 0 || referral !=1065 || sputumSmear !=703 || xray !=152526 || geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104)){
                jq("#tb-result-status input[value=1660]").prop("checked", true);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
            }
            //No signs with normal/negative Tests results
            if((clinicalDiagnosis !=703) &amp;&amp; ((testOrderedChecked.length &gt; 0 &amp;&amp; sputumSmear ==664) || (testOrderedChecked.length &gt; 0 &amp;&amp; xray ==1115) || (testOrderedChecked.length &gt; 0 &amp;&amp; (geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104)))){
                jq("#tb-result-status input[value=1660]").prop("checked", true);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
            }
            //Presumed TB  with abnormal/positive Tests results
            if((clinicalDiagnosis !=703) &amp;&amp; ((testOrderedChecked.length &gt; 0 &amp;&amp; sputumSmear ==703) || (testOrderedChecked.length &gt; 0 &amp;&amp; xray ==152526) || (testOrderedChecked.length &gt; 0 &amp;&amp; (geneXpert ==162203 || geneXpert ==162204 || geneXpert ==164104)))){
                jq("#tb-result-status input[value=1660]").prop("checked", false);
                jq("#tb-result-status input[value=142177]").prop("checked", true);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
            }
            //Presumed TB
            if((clinicalDiagnosis !=703) &amp;&amp; (testOrderedChecked.length &lt; 0 || referral ==1065 || sputumSmear ==703 || xray ==152526 || geneXpert ==162203 || geneXpert ==162204 || geneXpert ==164104)){
                jq("#tb-result-status input[value=1660]").prop("checked", false);
                jq("#tb-result-status input[value=142177]").prop("checked", true);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
            }

        }

        //Resulting TB status for Action clinical diagnosis
        var clinicalDiagnosisAction  = function () {
            var clinicalDiagnosis = getValue("clinical-diagnosis-action.value");
            var sputumSmear = getValue("sputum-smear-action.value");
            var xray = getValue("chest-xray-action.value");
            var referral = getValue("referral-action.value");
            var geneXpert = getField("genexpert-action.value").val();
            var testOrderedChecked = jq("#tb-test-ordered input:checkbox:checked");

            if(clinicalDiagnosis ==703){
                jq("#tb-result-status input[value=1662]").prop("disabled", false);
                jq("#tb-result-status input[value=1662]").prop("checked", true);
                jq("#tb-result-status.input[value=142177]").prop("disabled", true);
                jq("#tb-result-status.input[value=1660]").prop("disabled", true);
                jq("#tb-result-status.input[value=160737]").prop("disabled", true);
                jq("#tbl-start-antiTb").show();
                jq('#ipt-client-workup').hide();
                jq('#ipt-initiation').hide();
                jq('#ipt-result-status').hide();
            }
            if(clinicalDiagnosis ==664 ){
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq("#tbl-start-antiTb").hide();
            }
            if(testOrderedChecked.length ==0 &amp;&amp; clinicalDiagnosis !=703 &amp;&amp; referral !=1065 &amp;&amp; sputumSmear !=703 &amp;&amp; xray !=152526 &amp;&amp;(geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104)) {
                jq("#tb-result-status input[value=1660]").prop("checked", true);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
                // getField('tbrxdate.value').val("");
            }
        }
        //Resulting TB status for Action start anti tb
        var startAntiTbAction  = function () {
            var startAntiTb = getValue("start-anti-tb-action.value");
            var sputumSmear = getValue("sputum-smear-action.value");
            var xray = getValue("chest-xray-action.value");
            var testOrderedChecked = jq("#tb-test-ordered input:checkbox:checked");

            if(startAntiTb ==1065){
                jq("#tb-result-status input[value=1662]").prop("disabled", false);
                jq("#tb-result-status input[value=1662]").prop("checked", true);
                jq("#tb-result-status.input[value=142177]").prop("disabled", true);
                jq("#tb-result-status.input[value=1660]").prop("disabled", true);
                jq("#tb-result-status.input[value=160737]").prop("disabled", true);
                jq('#ipt-client-workup').hide();
                jq('#ipt-initiation').hide();
                jq('#ipt-result-status').hide();
                //set TB RX date to todays date
                var encounterDate = getValue('encounter-date.value');
                //Validate for moment
                var momentEncounterDate =moment(moment(encounterDate,'YYYY-MM-DD').toDate()).format("DD-MMM-YYYY");
                getField('tbrxdate.value').val(momentEncounterDate);
            }
            if(startAntiTb ==1066 ){
                // jq("#tb-result-status input[value=1662]").prop("disabled", true);
                //jq('#tbrxdate').val(" ");
                getField('tbrxdate.value').val("");
            }

        }
        //IPT EVENT SELECTED
        var iptEventSelected  = function () {

            var iptEvent = getValue('ipt-event-type.value');
            if(!isNaN(iptEvent) &amp;&amp; (iptEvent == 159836)){
                jq("#reason-for-discontinuation").show();
            }
            else{
                jq("#reason-for-discontinuation").hide();
            }
        }
        //Prophylaxis selected
        var prophylaxisSelected  = function () {

            var prophylaxisUsed = getValue('prophylaxis-used.value');
            var ctxAdherence = jq('#ctx-adherence');
            var ctxDispensed = jq('#ctx-dispensed');
            var dapsoneAdherence = jq('#dapsone-adherence');
            var dapsoneDispensed = jq('#dapsone-dispensed');
            if(prophylaxisUsed == 105281){
                jq("#ctx-part").show();
                jq("#dapsone-part").hide();
                clearHiddenSections(dapsoneAdherence);
                clearHiddenSections(dapsoneDispensed);
            }
            if(prophylaxisUsed == 74250){
                jq("#dapsone-part").show();
                jq("#ctx-part").hide();
                clearHiddenSections(ctxAdherence);
                clearHiddenSections(ctxDispensed);
            }
            if(prophylaxisUsed == 1107){
                jq("#dapsone-part").hide();
                jq("#ctx-part").hide();
                clearHiddenSections(ctxAdherence);
                clearHiddenSections(ctxDispensed);
                clearHiddenSections(dapsoneAdherence);
                clearHiddenSections(dapsoneDispensed);
            }
        }
        //Morisky assessment
        var adherenceAssessment  = function () {
            var val = jq(this).val();
            const YES_CONCEPT_ID = 1065;
            const NO_CONCEPT_ID = 1066;
            var assessmentRadios = jq('#adherence-1').find('input[type=radio]');
            var assessmentYesResponses = [];
            var assessmentNoResponses = [];
            //defaults
            //Fetch responses for the assessment questions
            jq.each(assessmentRadios, function(){

                //Push any responses to the respective assessmentYesResponses and assessmentNoResponses array
                if (this.value == YES_CONCEPT_ID &amp;&amp; this.checked == true) {
                    assessmentYesResponses.push(this);
                }

                if (this.value == NO_CONCEPT_ID &amp;&amp; this.checked == true) {
                    assessmentNoResponses.push(this);
                }

            });
            //If no responses have been recorded then prompt since this assessment is mandatory
            if (assessmentYesResponses.length == 0 &amp;&amp; assessmentNoResponses.length == 0 ) {
                //Prompt to complete assessment
            }else{
                if(assessmentYesResponses.length &gt; 0) {
                    jq('#adherence-2').show();
                }
                if(assessmentYesResponses.length == 0) {
                    jq("#arv-adherence input[value=159405]").prop("checked", true);
                    jq('#adherence-2').hide();
                }
                if(assessmentYesResponses.length == 1 || assessmentYesResponses.length == 2 ) {
                    jq("#arv-adherence input[value=163794]").prop("checked", true);
                    jq('#adherence-2').show();
                }
                if(assessmentYesResponses.length == 3 || assessmentYesResponses.length == 4 ) {
                    jq("#arv-adherence input[value=159407]").prop("checked", true);
                    jq('#adherence-2').show();
                }
            }

        }
        var closeAdherenceAssessment  = function () {
            //console.log("close me");
            var x = jq("#modalContents");
            x.dialog('close');

        }
        //.Morisky assessment
        //Start on jq onready
        jq(function() {

            jq('#greencard').smartWizard({
                selected: 0,  // Selected Step, 0 = first step
                keyNavigation: true, // Enable/Disable key navigation(left and right keys are used if enabled)
                enableAllSteps: false,  // Enable/Disable all steps on first load
                transitionEffect: 'fade', // Effect on navigation, none/fade/slide/slideleft
                contentURL:null, // specifying content url enables ajax content loading
                contentURLData:null, // override ajax query parameters
                contentCache:true, // cache step contents, if false content is fetched always from ajax url
                cycleSteps: false, // cycle step navigation
                enableFinishButton: false, // makes finish button enabled always
                hideButtonsOnDisabled: false, // when the previous/next/finish buttons are disabled, hide them instead
                errorSteps:[],    // array of step numbers to highlighting as error steps
                labelNext:'Next', // label for Next button
                labelPrevious:'Previous', // label for Previous button
                labelFinish:'Submit',  // label for Finish button
                noForwardJumping:false,
                ajaxType: 'POST',
                // Events
                onLeaveStep:onLeaveStepValidation , // triggers when leaving a step
                onShowStep: null,  // triggers when showing a step
                onFinish: submitHtmlForm,  // triggers when Finish button is clicked
                buttonOrder: ['finish', 'next', 'prev']  // button order, to hide a button remove it from the list
            });
            //Wizard set error function
            function setError(stepnumber){
                jq('#greencard').smartWizard('setError',{stepnum:stepnumber,iserror:true});
            }

            getField('weight.value').change(onWeightOrHeightChange);
            getField('height.value').change(onWeightOrHeightChange);
            onWeightOrHeightChange();
            onEncounterDateChange();
            jq('#fp-details').show();
            var age = parseInt('<lookup expression="patient.age"/>');
            if (age &lt; 10) {
                jq('#fp-details').hide();
                jq('.reproductive-part').hide();
            }
            var pgender = "<lookup expression="patient.gender" />";
            //Gravida
            if (pgender == 'F' &amp;&amp; age &gt; 10 ) {
                getField('parity-term.value').change(onParityChange);
                getField('parity-abortion.value').change(onParityChange);
                jq('#fp-details').hide();
            }
            everOnIPTSelected = null;
            patientCurrentlyOnIPT = null;
            //Defaults on ready
            jq("#tbl-partner-notification").hide();
            jq("#tbl-adverse-reactions").hide();
            jq('input[type=radio].adverse-reactions').prop("checked", false);
            jq("#tbl-complaints-today").hide();
            jq("#tbl-systems-review").hide();
            jq('input[type=radio].complaints-today').prop("checked", false);
            jq("#tbl-known-allergies").hide();
            jq('input[type=radio].known-allergies').prop("checked", false);
            jq("#tbl-chronic-illness").hide();
            jq('input[type=radio].chronic-illness').prop("checked", false);
            jq("#key-population").hide();
            jq('#nutritional-status input[type=radio]').attr("style", "pointer-events:none;");
            jq("#general-exam-findings :input[type=checkbox]").prop("checked",false);
            //default on patient presence
            jq('.patient-details :input').prop('disabled', true);
            jq('#person-present input').click(onPersonPresentChange);
            jq('#on-ipt input').prop("disabled", true);
            jq("#tbl-start-antiTb").hide();
            jq("#ipt-uptake").hide();
            jq("#tb-screening-result").hide();
            //Sexual and reproductive setion
            jq("#hasLMP :input[type=radio]").change(patientLMPStatus);
            jq('#lmp-date :input').prop('disabled', true);
            //jq('#fp-details').hide();

            jq('#if-patient-pregnant').hide();
            jq('#pregnancyOptionValues').hide();
            jq("#wants-pregnancy").hide();
            jq("#tb-screening-tab").hide();
            jq("#tbl-ever-on-ipt").hide();
            //IPT OUTCOME
            jq("#tbl-ipt-outcome").hide();
            jq("#reason-for-discontinuation").hide();
            getField('ipt-event-type.value').change(iptEventSelected);
            jq("#bt-ipt-outcome").click(onRecordIPTOutcome);
            var actionTakenTab = jq('#action-taken');
            var iptClientWorkupTab = jq('#ipt-client-workup');
            var iptFollowup = jq('#ipt-followup');
            var iptInitiationTab = jq('#ipt-initiation');
            actionTakenTab.hide();
            iptClientWorkupTab.hide();
            iptFollowup.hide();
            iptInitiationTab.hide();
            ageGroup();
            displayRecentBmi();
            //Prophylaxis section
            jq("#ctx-part").hide();
            jq("#dapsone-part").hide();
            //Event Handlers
            jq("#prophylaxis-used :input[type=radio]").change(prophylaxisSelected);
            jq("#lmp-date :input[type=text]").change(onLmpChange);
            jq("#on-anti-tb-drugs :input[type=radio]").change(onAntiTbDrugs);
            jq("#on-ipt :input[type=radio]").change(onIPT);
            jq("#ever-on-ipt :input[type=radio]").change(everOnIPT);
            //sti notification
            //getField('screened-sti.value').change(screenedStiSelected);
            jq("#screened-sti :input[type=radio]").change(screenedStiSelected);
            //tb action
            jq("#start-anti-tb-action").change(startAntiTbAction);
            jq("#clinical-diagnosis-action").change(clinicalDiagnosisAction);
            jq("#sputum-smear-action").change(sputumSmearAction);
            jq("#genexpert-action select").change(geneXpertAction);
            jq("#chest-xray-action").change(chestXrayAction);
            jq("#referral-action").change(referralAction);
            jq("#tb-test-ordered").change(testOrdered);
            jq('#general-exam-findings :input[type=checkbox]').change(generalExamSelected);
            jq("#complaints-today").change(complaintSelected);       //boolean
            jq(".complaint-time input").change(complaintDurationInput);
            // getField('complaint-duration.value').change(complaintDurationInput);
            // getField('complaint-date.value').change(complaintDateInput);
            jq('#adverse-reactions').change(adverseReactionSelected);     //boolean
            jq('#known-allergies').change(knownAllergiesSelected);       //boolean
            jq('#systems-review :input[type=radio]').change(systemsReviewSelected);   //non-bool
            jq('#chronic-illness :input[type=radio]').change(chronicIllnessesSelected);
            jq('#population-type :input[type=radio]').change(populationTypeSelected);

            //Differentiated care
            var PATIENT_STABLE = "<lookup expression="kenyaemr.patientIsStable()" />";
            if(PATIENT_STABLE =="true") {
                jq('#fast-track').show();
                jq('#standard-care').hide();
            }else{
                jq('#standard-care').show();
                jq('#fast-track').hide();
            }
            //On ART hide adherence assessment
            var PATIENT_ON_ART = "<lookup expression="kenyaemr.currentInArt()" />";
            if(PATIENT_ON_ART =="true") {
                jq('.on-art').show();
                jq('.showModal').show();

            }else{
                jq('.on-art').hide();
                jq('.showModal').hide();
            }
            // Morisky ART adherence assessment Modal
            jq(".showModal").click(function(e){
                //Defaults
                var adherenceResponses1=jq('#adherence-1');
                var adherenceResponses2=jq('#adherence-2');
                jq('#adherence-2').hide();
                clearHiddenSections(adherenceResponses1);
                clearHiddenSections(adherenceResponses2);
                e.preventDefault();
                jq("#modalContents").dialog({bgiframe: true, height: 425, width: 900, modal: true });
                jq("#btnCloseARVAssessment").click(closeAdherenceAssessment);
                jq("#adherence-1").change(adherenceAssessment);

            });
            jq('#arv-adherence input[type=radio]').attr("style", "pointer-events:none;");
            //.Morisky
            var strtext = "";
            var familyPlanningOption = getValue('fplanning.value');
            var pregnancyOption = getValue('pregnancyOption.value');

            if (familyPlanningOption == "") {
                jq('#onFp :input').prop('disabled', true);
                jq('#notOnFp :input').prop('disabled', true);
            }
            if (familyPlanningOption == "965") {
                jq('#onFp :input').prop('disabled', false);
                jq('#notOnFp :input').prop('disabled', true);
            }
            if (familyPlanningOption == "160652") {
                jq('#onFp :input').prop('disabled', true);
                jq('#notOnFp :input').prop('disabled', false);
            }
            if (familyPlanningOption == "1360") {
                jq('#onFp :input').prop('disabled', false);
                jq('#notOnFp :input').prop('disabled', true);
            }
            jq('#pregnancyOption input:radio').change(function () {
                if ((getValue('pregnancyOption.value')) == 1066) {
                    var pregOtions=jq('#pregnancyOptionValues :input').val('');
                    var ancProfile=jq('#anc-profile');
                    //jq('#pregnancyOptionValues :input').prop('disabled', true);
                    jq('#pregnancyOptionValues').hide();
                    jq('#fp-details').hide();
                    jq('#fpOptionValues :input').prop('disabled', false);
                    jq('#fpOptionValues :input').prop('checked', false);
                    jq("#wants-pregnancy").show();
                    clearHiddenSections(pregOtions);
                    clearHiddenSections(ancProfile);
                }
                if((getValue('pregnancyOption.value')) == 1065){
                    jq('#pregnancyOptionValues :input').prop('disabled', false);
                    var wantsPreg=jq('#wants-pregnancy');
                    jq('#pregnancyOptionValues').show();
                    jq('#fp-details').hide();
                    jq("#wants-pregnancy").hide();
                    clearHiddenSections(wantsPreg);
                    //Automate EDC Computation
                    var lmpDate = getValue('lmp-date.value');
                    var formattedlmp=moment(moment(lmpDate, 'YYYY-MM-DD').toDate()).format('DD-MMM-YYYY');
                    var expectedDeliveryDate = moment(formattedlmp, "DD-MMM-YYYY").add(280, 'days').format('DD-MMM-YYYY');
                    //Find recent EDD if it exists
                    //Using LMP
                    var recentEDD = "<lookup expression="fn.latestObs(5596).getValueDatetime()"/>";
                    var recentLMP = "<lookup expression="fn.latestObs(1427).getValueDatetime()"/>";
                    //Using recent LMP
                    var formattedRecentlmp=moment(moment(recentLMP, 'DD-MMM-YYYY').toDate()).format('DD-MMM-YYYY');
                    var expectedDeliveryDateByRecentLMP = moment(formattedRecentlmp, "DD-MMM-YYYY").add(280, 'days').format('DD-MMM-YYYY');
                    //Calculation
                    if(recentEDD !=""){
                        getField('patient-edd.value').val(recentEDD);
                    }else if(recentLMP !="") {
                        getField('patient-edd.value').val(expectedDeliveryDateByRecentLMP);
                    }else if (lmpDate!=""){
                        getField('patient-edd.value').val(expectedDeliveryDate);
                    }else{
                        getField('patient-edd.value').val("");
                    }
                }

            });

            jq("#fplanning select ").change(function () {

                jq("#fplanning select option:selected").each(function () {
                    strtext += jq(this).val();
                });

                if (strtext == "") {
                    jq('#notOnFp :input').prop('checked', false);
                    jq('#onFp :input').prop('checked', false);
                    jq('#onFp :input').prop('disabled', true);
                    jq('#notOnFp :input').prop('disabled', true);
                }
                if (strtext == "965") {       //on family planning
                    jq('#notOnFp :input').prop('checked', false);
                    jq('#onFp :input').prop('disabled', false);
                    jq('#notOnFp :input').prop('disabled', true);

                }
                if (strtext == "160652") {
                    jq('#onFp :input').prop('checked', false);
                    jq('#onFp :input').prop('disabled', true);
                    jq('#notOnFp :input').prop('disabled', false);
                }
                if (strtext == "1360") {
                    jq('#notOnFp :input').prop('checked', false);
                    jq('#onFp :input').prop('disabled', false);
                    jq('#notOnFp :input').prop('disabled', true);
                }

                strtext = "";
            });

            jq("#wants-pregnancy").change(function(){
                getField('fplanning.value').prop("selectedIndex", 0);
                jq('#fp-details').show();
                jq('#fpOptionValues :input[type=checkbox]').prop('disabled', true);
                jq('#fpOptionValues :input').prop('checked', false);
            });
              /*On TB Drugs  */
            var PATIENT_ON_TB = "<lookup expression="kenyaemr.patientInTbProgram()" />";
            if (PATIENT_ON_TB == 'true'){
                jq("#on-anti-tb-drugs input[value=1065]").prop("checked", true);
                jq('#on-anti-tb-drugs input[type=radio]').attr("style", "pointer-events:none;");
                jq(".tb-patient").text("On TB Treatment");
            }
            /*  .On TB Drugs   */
            /*On IPT Drugs  */
            var PATIENT_ON_IPT = "<lookup expression="kenyaemr.patientInIPTProgram()" />";
            if (PATIENT_ON_IPT == 'true'){
                jq('#on-ipt input').prop("disabled", false);
                jq("#on-ipt input[value=1065]").prop("checked", true);
                jq("#on-anti-tb-drugs input[value=1066]").prop("checked", true);
                jq('#on-anti-tb-drugs input[type=radio]').attr("style", "pointer-events:none;");
                jq('#on-ipt input[type=radio]').attr("style", "pointer-events:none;");
                jq(".ipt-patient").text("Currently on IPT");
                jq("#tbl-ever-on-ipt").hide();
                jq("#ipt-followup").show();
                jq("#tb-screening-result").show();
                jq("#ipt-uptake").show();
            }
            /*  .On IPT Drugs   */
            /*TB Screening form validation*/
            var screeningRadios = jq('#screening-questions').find('input[type=radio]');
            var iptClientWorkupRadios = jq('#ipt-client-workup').find('input[type=radio]');
            var pregnancyStatus = getField('#pregnancyOption');
            var pregnantStatusRadios = jq('#fp-details').find('input[type=checkbox]');
            const YES_CONCEPT_ID = 1065;
            const NO_CONCEPT_ID = 1066;
            //This function will perform the folllowing:
            //Only show 'IPT Client Workup' tab if all screening questions evaluate to NO
            //Only show 'Action Taken' tab if any of the screening questions evaluate to YES
            var showHideTabs = function() {
                var actionTakenTab = jq('#action-taken');
                var tbRxdate = jq('#tbrxdate input').val('');
                var tbRegimen = jq('#tb-regimen');
                var iptClientWorkupTab = jq('#ipt-client-workup');
                var iptFollowup = jq('#ipt-followup');
                var tbScreeningQuestionsTab = jq("#tb-screening-tab");
                var everOnIPTRadio = everOnIPTSelected;
                var showActionTakenTab = false;
                var showIPTClientWorkupTab = false;
                var showIPTFollowupTab = false;

                var screeningYesResponses = [];
                var screeningNoResponses = [];
                //defaults
                //Fetch responses for the screening questions
                jq.each(screeningRadios, function(){
                    const COUGH = 159799;
                    const CONTACT = 124068;
                    const FEVER = 1494;
                    const WEIGHTLOSS = 832;
                    const SWEAT =133027;

                    //Push any responses to the respective screeningYesResponses and screeningNoResponses array
                    if ((this.value == COUGH || this.value == CONTACT || this.value == FEVER || this.value == WEIGHTLOSS || this.value == SWEAT )&amp;&amp; this.checked == true) {
                        screeningYesResponses.push(this);
                    }
                       //Replaced yes concept with individual symptoms
                    if (this.value == NO_CONCEPT_ID &amp;&amp; this.checked == true) {
                        screeningNoResponses.push(this);
                    }

                });

                //If no responses have been recorded then show the ActionTaken and IPTClientWorkup tabs
                if (screeningYesResponses.length == 0 &amp;&amp; screeningYesResponses.length == 0 ) {
                    //Do nothing

                }

               if (everOnIPTRadio == NO_CONCEPT_ID &amp;&amp; screeningYesResponses.length &gt; 0) {
                        actionTakenTab.show();
                        iptClientWorkupTab.hide();
                        iptFollowup.hide();
                        iptInitiationTab.hide();

                        //clear radios for hidden sections
                        clearRadios(iptFollowup);
                        clearRadios(iptClientWorkupTab);
                        clearRadios(iptInitiationTab);
                    }
             if (everOnIPTRadio == NO_CONCEPT_ID &amp;&amp; screeningYesResponses.length == 0) {
                        actionTakenTab.hide();
                        iptClientWorkupTab.hide();
                        iptFollowup.hide();
                        iptInitiationTab.hide();

                        //clear radios for hidden sections
                        clearRadios(iptFollowup);
                        clearRadios(actionTakenTab);
                        clearRadios(iptClientWorkupTab);
                        clearRadios(iptInitiationTab);
                        clearRadios(tbRxdate);
                        clearRadios(tbRegimen);
                    }
             if (everOnIPTRadio == NO_CONCEPT_ID &amp;&amp; screeningNoResponses.length == 4) { // check if all screening No responses are checked: total radios / 2
                        actionTakenTab.hide();
                        iptClientWorkupTab.show();
                        iptFollowup.hide();

                        //clear radios for hidden sections
                        clearRadios(actionTakenTab);
                        clearRadios(iptFollowup);
                        clearRadios(tbRxdate);
                        clearRadios(tbRegimen);
                    }
              if(everOnIPTRadio == YES_CONCEPT_ID &amp;&amp; screeningYesResponses.length &gt; 0) {

                        actionTakenTab.show();
                        iptClientWorkupTab.hide();
                        iptFollowup.hide();
                        iptInitiationTab.hide();

                        //clear radios for hidden sections

                        clearRadios(iptClientWorkupTab);
                        clearRadios(iptFollowup);
                        clearRadios(iptInitiationTab);
                    }
               if(screeningYesResponses.length == 0) {
                        actionTakenTab.hide();
                        clearRadios(actionTakenTab);
                        clearRadios(tbRxdate);
                        clearRadios(tbRegimen);
                    }
                if(patientCurrentlyOnIPT == YES_CONCEPT_ID &amp;&amp; screeningYesResponses.length &gt; 0) {
                        actionTakenTab.show();
                        iptFollowup.show();
                        iptClientWorkupTab.hide();
                        clearRadios(iptClientWorkupTab);
                    }
                if(screeningYesResponses.length &gt; 0) {
                        actionTakenTab.show();
                        iptClientWorkupTab.hide();
                        clearRadios(iptClientWorkupTab);
                    }
              // }
            };
            var showHideIPTInitiationTab = function() {

                var iptInitiationTab = jq('#ipt-initiation');
                var showIPTInitiationTab = false;

                var iptClientWorkupYesResponses = [];
                var iptClientWorkupNoResponses = [];

                //Fetch responses for the IPT client workup questions
                jq.each(iptClientWorkupRadios, function() {
                    const YELLOWURINE = 162311;
                    const NUMBNESS = 132652;
                    const YELLOWEYES = 5192;
                    const TENDERNESS = 124992;

                    //Push any responses to the respective iptClientWorkupYesResponses and iptClientWorkupNoResponses array
                    if ((this.value == YELLOWURINE || this.value == NUMBNESS || this.value == YELLOWEYES || this.value == TENDERNESS)&amp;&amp; this.checked == true) {
                        iptClientWorkupYesResponses.push(this);
                    }

                    if (this.value == NO_CONCEPT_ID &amp;&amp; this.checked == true) {
                        iptClientWorkupNoResponses.push(this);
                    }
                  });

             if (iptClientWorkupYesResponses.length == 0 &amp;&amp; iptClientWorkupNoResponses.length == 0) {
                     //Do nothing
                }
              if (iptClientWorkupNoResponses.length == iptClientWorkupRadios.length / 2)  { // check if all No responses are checked: total radios / 2
                  iptInitiationTab.show();
                  jq('#ipt-result-status').show();
                  }else{
                  iptInitiationTab.hide();
                  clearRadios(iptInitiationTab);
               }

            };
            clearRadios = function(parentObj) {

                parentObj.find('input[type=radio]').each(function() {
                    this.checked = false;
                });
                parentObj.find('input[type=checkbox]').each(function() {
                    this.checked = false;
                });
//                parentObj.find('input[type=text]').each(function() {
//                    this.val("");
//                });
                parentObj.find('select').each(function() {
                    this.selectedIndex =0;
                });
            }
            screeningRadios.change(function() {

                showHideTabs();

            });

            iptClientWorkupRadios.change(function() {

                showHideIPTInitiationTab();

            });


            showHideIPTInitiationTab();
        });
        //End on ready
        //Clear hidden sections
        clearHiddenSections = function(parentObj) {
            parentObj.find('input[type=radio]').each(function() {
                this.checked = false;
            });
            parentObj.find('input[type=checkbox]').each(function() {
                this.checked = false;
            });
            parentObj.find('input[type=text]').each(function() {
                this.val("");
            });
            parentObj.find('select').each(function() {
                this.selectedIndex =0;
            });
        }
        // Before submit equivalent to Step 4 validation
        beforeSubmit.push(function() {
            var pgender = "<lookup expression="patient.gender" />";
            var PATIENT_STABLE = "<lookup expression="kenyaemr.patientIsStable()" />";
            var PATIENT_ON_ART = "<lookup expression="kenyaemr.currentInArt()" />";
            var tca_date = getValue('returnVisitDate.value');
            var tca_reason = getValue('returnVisitReason.value');
            var encounterDate = getValue('encounter-date.value');
            var fastTrackCareError = getValue('fast-track.value');
            var standardCareError = getValue('standard.value');
            var prophylaxis_Used = getValue('prophylaxis-used.value');
            var ctxAdherence = getValue('ctx-adherence.value');
            var ctxDispensed = getValue('ctx-dispensed.value');
            var dapsoneAdherence = getValue('dapsone-adherence.value');
            var dapsoneDispensed = getValue('dapsone-dispensed.value');
            var arvAdherence = getValue('arv-adherence.value');
            var cacxScreened = getValue('cacx-screening.value');
            var stiScreened = getValue('screened-sti.value');
            var stiPartnerNotification = getValue('sti-partnerNotification.value');
            //Must have a Return Visit Date which should be greater than encounter date

            if (prophylaxis_Used == false){
                getField('prophylaxis-used.error').html('Please specify Prophylaxis used.').show();
                return false;
            }
            if (prophylaxis_Used == 105281 &amp;&amp; ctxAdherence == false){      //ctx
                jq("#ctx-part").show();
                getField('ctx-adherence.error').html('Please specify CTX adherence.').show();
                return false;
            }
            if (prophylaxis_Used == 105281 &amp;&amp; ctxDispensed == false){      //ctx
                jq("#ctx-part").show();
                getField('ctx-dispensed.error').html('Please specify if CTX was dispensed.').show();
                return false;
            }
            if (prophylaxis_Used == 74250 &amp;&amp; dapsoneAdherence == false){      //dapsone
                jq("#dapsone-part").show();
                getField('dapsone-adherence.error').html('Please specify Dapsone adherence.').show();
                return false;
            }
            if (prophylaxis_Used == 74250 &amp;&amp; dapsoneDispensed == false){      //dapsone
                jq("#dapsone-part").show();
                getField('dapsone-dispensed.error').html('Please specify if Dapsone was dispensed.').show();
                return false;
            }
            if (PATIENT_ON_ART == 'true' &amp;&amp; arvAdherence == false){
                getField('arv-adherence.error').html('Please specify ARV adherence.').show();
                return false;
            }
            //Cacx screening on over 18 years is mandatory
            if (pgender == 'F') {
                if (pAge &gt; 18 &amp;&amp; cacxScreened == false) {
                    getField('cacx-screening.error').html('Please specify whether patient was screened for CaCx.').show();
                    return false;
                } else {
                    getField('cacx-screening.error').html('Please specify whether patient was screened for CaCx.').hide();
                }
            }
            if (stiScreened == false) {
                jq('#greencard').smartWizard('setError',{stepnum:2,iserror:true});
                getField('screened-sti.error').html('Please specify whether patient was screened for STI.').show();
                return false;
            }
            if (stiScreened == 703 &amp;&amp; stiPartnerNotification == false) {
                jq("#tbl-partner-notification").show();
                jq('#greencard').smartWizard('setError',{stepnum:2,iserror:true});
                getField('sti-partnerNotification.error').html('Please specify partner notification status.').show();
                return false;
            }
            if (tca_date =="") {
                getField('returnVisitDate.error').html('Return visit date should not be empty').show();
                return false;
            }
            if (tca_reason == "") {
                getField('returnVisitReason.error').html('Please specify reason for return visit.').show();
                return false;
            }
            if (tca_date &lt; encounterDate ){
                getField('returnVisitDate.error').html('Return visit date should not be earlier than encounter date').show();
                return false;
            }
            if (tca_reason == "") {
                getField('returnVisitReason.error').html('Please specify reason for return visit.').show();
                return false;
            }
            if (PATIENT_STABLE == 'true' &amp;&amp; fastTrackCareError == "") {
                jq('#greencard').smartWizard('setError',{stepnum:4,iserror:true});
                getField('fast-track.error').html('Please specify patient differentiated care status.').show();
                return false;
            }
            if (PATIENT_STABLE == 'false' &amp;&amp; standardCareError == "") {
                jq('#greencard').smartWizard('setError',{stepnum:4,iserror:true});
                getField('standard.error').html('Please specify patient differentiated care status.').show();
                return false;
            }
            return true;

        });

//Smart wizard validations
        function onLeaveStepValidation (obj, context) {
            var stepNum = context.fromStep;

            //Validations steps
            if (stepNum == 1) {
                return step1Validation();
            } else if (stepNum == 2) {
                return step2Validation();
            }else if (stepNum == 3) {
                return step3Validation();
            }else if (stepNum == 4) {
                return step4Validation();
            }else {

                return true;
            }
        }
         //Step 1 validations
        function step1Validation(){
            pAge = parseInt('<lookup expression="patient.age"/>');
            var recentWHO = "<lookup expression="fn.latestObs(5356).getValueCoded()"/>";
            var personPresent =getValue('person-present.value');
            var visit_scheduled =getValue('visit-scheduled.value');
            var populationType =getValue('population-type.value');
            var adultWhoStage =getField('whoStage-adult.value').val();
            var childWhoStage =getField('whoStage-child.value').val();
//            console.log("Recent who"+recentWHO);

            if (visit_scheduled == false) {
                jq('#greencard').smartWizard('setError', {stepnum: 1, iserror: true});
                getField('visit-scheduled.error').html('Visit type is required').show();
                return false;
            }else{
                getField('visit-scheduled.error').html('Visit type is required.').hide();
            }
            if (personPresent == false) {
                jq('#greencard').smartWizard('setError', {stepnum: 1, iserror: true});
                getField('person-present.error').html('Please specify person present').show();
                return false;
            }else{
                getField('person-present.error').html('Please specify person present').hide();
            }
            if (populationType == false) {
                jq('#greencard').smartWizard('setError', {stepnum: 1, iserror: true});
                getField('population-type.error').html('Please specify population type').show();
                return false;
            }else{
                getField('population-type.error').html('Please specify population type').hide();
            }
            if (recentWHO =="" &amp;&amp; pAge &gt; 15 &amp;&amp; adultWhoStage == false) {
                jq('#greencard').smartWizard('setError', {stepnum: 1, iserror: true});
                getField('whoStage-adult.error').html('Please specify adult WHO stage').show();
                return false;
            }else{
                getField('whoStage-adult.error').html('Please specify adult WHO stage').hide();
            }
            if (recentWHO =="" &amp;&amp; pAge &lt; 15 &amp;&amp; childWhoStage == false) {
                jq('#greencard').smartWizard('setError',{stepnum:1,iserror:true});
                getField('whoStage-child.error').html('Please specify child WHO stage').show();
                return false;
            }
            else {
                jq('#greencard').smartWizard('showMessage',"");
                return true;
            }
        }
        //Step 2 validations
        function step2Validation(){
            pAge = parseInt('<lookup expression="patient.age"/>');
            var pgender = "<lookup expression="patient.gender" />";
            pAge = parseInt('<lookup expression="patient.age"/>');
            var complaintsToday = getValue('complaints-today.value');
            var onAntiTbDrugs = getValue('on-anti-tb-drugs.value');    //non boolean
            var onIpt = getValue('on-ipt.value');
            var everOnIpt= getValue('ever-on-ipt.value');
            var knownAllergies = getValue('known-allergies.value');   //boolean
            var chronicIllness = getValue('chronic-illness.value');   //non boolean
            var adverseReactions = getValue('adverse-reactions.value');   // boolean
            var patientHasLMP = getValue('hasLMP.value');
            var encounterDate = getValue('encounter-date.value');
            var lmpDate = getValue('lmp-date.value');
            var tbrxDate = getValue('tbrxdate.value');
            var isPregnant = getValue('pregnancyOption.value');
            var pregnancyIntention = getValue('pregnancyIntention.value');
            var onfpMethodChecked = getField('fplanning.value').val();
            var fpMethodsChecked = jq("#onFp input:checkbox:checked");
            var notOnfpMethodsChecked = jq("#notOnFp input:checkbox:checked");
            //TB validation
            var screeningRadios = jq('#screening-questions').find('input[type=radio]');
            const YES_CONCEPT_ID = 1065;
            const NO_CONCEPT_ID = 1066;
            var screeningYesResponses = [];
            var screeningNoResponses = [];
            //Fetch responses for the screening questions
            jq.each(screeningRadios, function(){
                //Push any responses to the respective screeningYesResponses and screeningNoResponses array
                const COUGH = 159799;
                const CONTACT = 124068;
                const FEVER = 1494;
                const WEIGHTLOSS = 832;
                const SWEAT =133027;

                //Push any responses to the respective screeningYesResponses and screeningNoResponses array
                if ((this.value == COUGH || this.value == CONTACT || this.value == FEVER || this.value == WEIGHTLOSS || this.value == SWEAT )&amp;&amp; this.checked == true) {
                    screeningYesResponses.push(this);

                }
                if (this.value == NO_CONCEPT_ID &amp;&amp; this.checked == true) {
                    screeningNoResponses.push(this);
                }
            });

            if (complaintsToday == false) {
                jq('#greencard').smartWizard('setError', {stepnum: 2, iserror: true});
                getField('complaints-today.error').html('Please specify  if patient has any complaints today.').show();
                return false;
            }else{
                getField('complaints-today.error').html('Please specify  if patient has any complaints today.').hide();
            }
            if (onAntiTbDrugs == false) {
                jq('#greencard').smartWizard('setError', {stepnum: 2, iserror: true});
                getField('on-anti-tb-drugs.error').html('Please specify if patient is on anti-tb drugs.').show();
                return false;
            }else{
                getField('on-anti-tb-drugs.error').html('Please specify if patient is on anti-tb drugs.').hide();
            }
            if (onAntiTbDrugs !=1065 &amp;&amp; onIpt == false) {
                jq('#greencard').smartWizard('setError', {stepnum: 2, iserror: true});
                getField('on-ipt.error').html('Please specify if patient is currently on IPT.').show();
                return false;
            }else{
                getField('on-ipt.error').html('Please specify if patient is currently on IPT.').hide();
            }
            if (onAntiTbDrugs !=1065 &amp;&amp; onIpt != 1065 &amp;&amp; everOnIpt == false) {
                jq("#tbl-ever-on-ipt").show();    //show ever on ipt that was previously hidden
                jq('#greencard').smartWizard('setError', {stepnum: 2, iserror: true});
                getField('ever-on-ipt.error').html('Please specify if patient has ever been on IPT.').show();
                return false;
            }else{
                getField('ever-on-ipt.error').html('Please specify if patient has ever been on IPT.').hide();
            }
            //If neither yes nor no repsonsed recorder
            if (onAntiTbDrugs !=1065 &amp;&amp;  onIpt != 1065 &amp;&amp; screeningYesResponses.length == 0 &amp;&amp; screeningNoResponses.length == 0 ) {
                jq('#greencard').smartWizard('setError',{stepnum:2,iserror:true});
                getField('tb-screening-error.error').html('Please conduct TB screening.').show();
                return false;
            }else{
                getField('tb-screening-error.error').html('Please conduct TB screening.').hide();
            }
          //If not completed tb screening
            if (onAntiTbDrugs !=1065 &amp;&amp; onIpt != 1065 &amp;&amp; screeningYesResponses.length + screeningNoResponses.length != 4 ) {
                jq('#greencard').smartWizard('setError',{stepnum:2,iserror:true});
                getField('tb-screening-error.error').html('Please complete TB screening.').show();
                return false;
            }else{
                getField('tb-screening-error.error').html('Please complete TB screening.').hide();
            }
            var isTBRxDateBeforeEncounter = moment(moment(moment(encounterDate, 'YYYY-MM-DD').toDate()).format('YYYY-MM-DD')).isBefore(moment(moment(tbrxDate, 'DD-MMM-YYYY').toDate()).format('YYYY-MM-DD'));
            if (isTBRxDateBeforeEncounter) {
                jq('#greencard').smartWizard('setError', {stepnum: 2, iserror: true});
                getField('tbrxdate.error').html('TB RX date, should  be earlier than encounter Date').show();
                return false;
            }
            if (knownAllergies == false) {
                jq('#greencard').smartWizard('setError', {stepnum: 2, iserror: true});
                getField('known-allergies.error').html('Please specify if patient has any known allergies.').show();
                return false;
            }else{
                getField('known-allergies.error').html('Please specify if patient has any known allergies.').hide();
            }
            if (chronicIllness == false) {
                jq('#greencard').smartWizard('setError', {stepnum: 2, iserror: true});
                getField('chronic-illness.error').html('Please specify if patient has any chronic illness.').show();
                return false;
            }else{
                getField('chronic-illness.error').html('Please specify if patient has any chronic illness.').hide();
            }
            if (adverseReactions == false) {
                jq('#greencard').smartWizard('setError', {stepnum: 2, iserror: true});
                getField('adverse-reactions.error').html('Please specify if patient has any adverse drug reactions.').show();
                return false;
            }else{
                getField('adverse-reactions.error').html('Please specify if patient has any adverse drug reactions.').hide();
            }
            if(pgender == 'F'  &amp;&amp; pAge &gt; 10) {
                if (patientHasLMP == false) {
                    jq('#greencard').smartWizard('setError', {stepnum: 2, iserror: true});
                    getField('hasLMP.error').html('Please specify if patient has normal menses.').show();
                    return false;
                }else{
                    getField('hasLMP.error').html('Please specify if patient has normal menses.').hide();
                }
                if (patientHasLMP == 1065 &amp;&amp; lmpDate == false) {
                    jq('#greencard').smartWizard('setError', {stepnum: 2, iserror: true});
                    getField('lmp-date.error').html('Please specify patient LMP Date.').show();
                    return false;
                } else {
                    getField('lmp-date.error').html('Please specify patient LMP Date.').hide();
                }
                if (patientHasLMP == 1065 &amp;&amp; lmpDate &gt; encounterDate) {
                    jq('#greencard').smartWizard('setError', {stepnum: 4, iserror: true});
                    getField('lmp-date.error').html('LMP date cannot be later than encounter date.').show();
                    return false;
                } else {
                    getField('lmp-date.error').html('LMP date cannot be later than encounter date.').hide();
                }
                if (patientHasLMP == 1065 &amp;&amp; isPregnant == false) {
                    jq('#greencard').smartWizard('setError', {stepnum: 2, iserror: true});
                    getField('pregnancyOption.error').html('Please specify if patient is pregnant.').show();
                    return false;
                } else {
                    getField('pregnancyOption.error').html('Please specify if patient is pregnant.').hide();
                }
                if (isPregnant == 1066 &amp;&amp; pregnancyIntention == false) {
                    jq("#wants-pregnancy").show();
                    jq('#greencard').smartWizard('setError', {stepnum: 2, iserror: true});
                    getField('pregnancyIntention.error').html('Please specify if patient wants to get pregnant in the next three months.').show();
                    return false;
                } else {
                    getField('pregnancyIntention.error').html('Please specify if patient wants to get pregnant in the next three months.').hide();
                }
                if (isPregnant == 1066 &amp;&amp; onfpMethodChecked == false) {
                    jq('#fp-details').show();
                    jq('#greencard').smartWizard('setError', {stepnum: 2, iserror: true});
                    getField('fplanning.error').html('Please specify if patient is using family planning methods.').show();
                    return false;
                } else {
                    getField('fplanning.error').html('Please specify if patient is using family planning methods.').hide();
                }
                //Validate fp options chooses atleast one option if on fp
                if (isPregnant == 1066 &amp;&amp; onfpMethodChecked == 965 &amp;&amp; fpMethodsChecked.length == 0) {
                    jq('#fp-details').show();
                    jq('#greencard').smartWizard('setError', {stepnum: 2, iserror: true});
                    getField('fp-error.error').html('Please add at least one family planning method.').show();
                    return false;
                } else {
                    getField('fp-error.error').html('Please add at least one family planning method.').hide();
                }
                //Validate fp options chooses atleast one option if on fp
                if (isPregnant == 1066 &amp;&amp; onfpMethodChecked == 1360 &amp;&amp; fpMethodsChecked.length == 0) {
                    jq('#fp-details').show();
                    jq('#greencard').smartWizard('setError', {stepnum: 2, iserror: true});
                    getField('fp-error.error').html('Please add at least one family planning method.').show();
                    return false;
                } else {
                    getField('fp-error.error').html('Please add at least one family planning method.').hide();
                }
                //Validate not-on-fp options chooses atleast one option if not on fp
                if (isPregnant == 1066 &amp;&amp; onfpMethodChecked == 160652 &amp;&amp; notOnfpMethodsChecked.length == 0) {
                    jq('#fp-details').show();
                    jq('#greencard').smartWizard('setError', {stepnum: 2, iserror: true});
                    getField('notOnfp-error.error').html('Please add at least one reason for not using family planning.').show();
                    return false;
                }

                jq('#greencard').smartWizard('showMessage',"");
                return true;
             }

            else {
                jq('#greencard').smartWizard('showMessage',"");
                return true;
            }
        }
        //Step 3 validations
        function step3Validation(){
            var systemsReview = getValue('systems-review.value');    //boolean
            var generalExamsChecked = jq("#general-exam-findings input:checkbox:checked");

            //Validate general examinations findings
            if (generalExamsChecked.length == 0 ) {
                jq('#greencard').smartWizard('setError', {stepnum: 3, iserror: true});
                getField('genExams-error.error').html('Please specify general examinations findings.').show();
                return false;
            }else{
                getField('genExams-error.error').html('Please specify general examinations findings.').hide();
            }
            if (systemsReview == false) {
                jq('#greencard').smartWizard('setError', {stepnum: 3, iserror: true});
                getField('systems-review.error').html('Please specify if patient has any findings on systems review.').show();
                return false;
            }
            else {
                jq('#greencard').smartWizard('showMessage',"");
                return true;
            }
        }
        //Step 4 validations
        function step4Validation(){
            var pgender = "<lookup expression="patient.gender" />";
            var PATIENT_STABLE = "<lookup expression="kenyaemr.patientIsStable()" />";
            var PATIENT_ON_ART = "<lookup expression="kenyaemr.currentInArt()" />";
            var encounterDate = getValue('encounter-date.value');
            var prophylaxis_Used = getValue('prophylaxis-used.value');
            var ctxAdherence = getValue('ctx-adherence.value');
            var ctxDispensed = getValue('ctx-dispensed.value');
            var dapsoneAdherence = getValue('dapsone-adherence.value');
            var dapsoneDispensed = getValue('dapsone-dispensed.value');
            var arvAdherence = getValue('arv-adherence.value');
            var cacxScreened = getValue('cacx-screening.value');
            var stiScreened = getValue('screened-sti.value');
            var stiPartnerNotification = getValue('sti-partnerNotification.value');
            var tca_date = getValue('returnVisitDate.value');
            var tca_reason = getValue('returnVisitReason.value');
            var fastTrackCareError = getValue('fast-track.value');
            var standardCareError = getValue('standard.value');

            if (prophylaxis_Used == false) {
                jq('#greencard').smartWizard('setError', {stepnum: 4, iserror: true});
                getField('prophylaxis-used.error').html('Please specify Prophylaxis used.').show();
                return false;
            }else{
                getField('prophylaxis-used.error').html('Please specify Prophylaxis used.').hide();
            }
            if (prophylaxis_Used == 105281 &amp;&amp; ctxAdherence == false) {      //ctx
                jq("#ctx-part").show();
                jq('#greencard').smartWizard('setError', {stepnum: 4, iserror: true});
                getField('ctx-adherence.error').html('Please specify CTX adherence.').show();
                return false;
            }else{
                getField('ctx-adherence.error').html('Please specify CTX adherence.').hide();
            }
            if (prophylaxis_Used == 105281 &amp;&amp; ctxDispensed == false) {     //ctx
                jq("#ctx-part").show();
                jq('#greencard').smartWizard('setError', {stepnum: 4, iserror: true});
                getField('ctx-dispensed.error').html('Please specify if CTX was dispensed.').show();
                return false;
            }else{
                getField('ctx-dispensed.error').html('Please specify if CTX was dispensed.').hide();
            }
            if (prophylaxis_Used == 74250 &amp;&amp; dapsoneAdherence == false) {      //dapsone
                jq("#dapsone-part").show();
                jq('#greencard').smartWizard('setError', {stepnum: 4, iserror: true});
                getField('dapsone-adherence.error').html('Please specify Dapsone adherence.').show();
                return false;
            }else{
                getField('dapsone-adherence.error').html('Please specify Dapsone adherence.').hide();
            }
            if (prophylaxis_Used == 74250 &amp;&amp; dapsoneDispensed == false) {     //dapsone
                jq("#dapsone-part").show();
                jq('#greencard').smartWizard('setError', {stepnum: 4, iserror: true});
                getField('dapsone-dispensed.error').html('Please specify if Dapsone was dispensed.').show();
                return false;
            }else{
                getField('dapsone-dispensed.error').html('Please specify if Dapsone was dispensed.').hide();
            }
            if (PATIENT_ON_ART == 'true' &amp;&amp; arvAdherence == false) {
                jq('#greencard').smartWizard('setError', {stepnum: 4, iserror: true});
                getField('arv-adherence.error').html('Please specify ARV adherence.').show();
                return false;
            }else{
                getField('arv-adherence.error').html('Please specify ARV adherence.').hide();
            }
            //Cacx screening on over 18 years is mandatory
            if (pgender == 'F') {
                if (pAge &gt; 18 &amp;&amp; cacxScreened == false) {
                    jq('#greencard').smartWizard('setError', {stepnum: 4, iserror: true});
                    getField('cacx-screening.error').html('Please specify whether patient was screened for CaCx.').show();
                    return false;
                } else {
                    getField('cacx-screening.error').html('Please specify whether patient was screened for CaCx.').hide();
                }
            }
            if (stiScreened == false) {
                jq('#greencard').smartWizard('setError', {stepnum: 4, iserror: true});
                getField('screened-sti.error').html('Please specify whether patient was screened for STI.').show();
                return false;
            }else{
                getField('screened-sti.error').html('Please specify whether patient was screened for STI.').hide();
            }
            if (stiScreened == 703 &amp;&amp; stiPartnerNotification == false) {
                jq("#tbl-partner-notification").show();
                jq('#greencard').smartWizard('setError', {stepnum: 4, iserror: true});
                getField('sti-partnerNotification.error').html('Please specify partner notification status.').show();
                return false;
            }else{
                getField('sti-partnerNotification.error').html('Please specify partner notification status.').hide();
            }
            if (tca_date == "") {
                jq('#greencard').smartWizard('setError', {stepnum: 4, iserror: true});
                getField('returnVisitDate.error').html('Please specify return visit date for patient.').show();
                return false;
            }else{
                getField('returnVisitDate.error').html('Please specify return visit date for patient.').hide();
            }
            if (tca_date &lt; encounterDate ) {
                jq('#greencard').smartWizard('setError', {stepnum: 4, iserror: true});
                getField('returnVisitDate.error').html('Return visit date should not be earlier than encounter date.').show();
                return false;
            }else{
                getField('returnVisitDate.error').html('Return visit date should not be earlier than encounter date.').hide();
            }
            if (tca_reason == "") {
                jq('#greencard').smartWizard('setError', {stepnum: 4, iserror: true});
                getField('returnVisitReason.error').html('Please specify reason for return visit.').show();
                return false;
            }else{
                getField('returnVisitReason.error').html('Please specify reason for return visit.').hide();
            }
            if (PATIENT_STABLE == 'true' &amp;&amp; fastTrackCareError == "") {
                jq('#greencard').smartWizard('setError', {stepnum: 4, iserror: true});
                getField('fast-track.error').html('Please specify patient differentiated care status.').show();
                return false;
            }else{
                getField('fast-track.error').html('Please specify patient differentiated care status.').hide();
            }
            if (PATIENT_STABLE == 'false' &amp;&amp; standardCareError == "") {
                jq('#greencard').smartWizard('setError',{stepnum:4,iserror:true});
                getField('standard.error').html('Please specify patient differentiated care status.').show();
                return false;
            }
            else {
                jq('#greencard').smartWizard('showMessage',"");
                return true;
            }
        }
    </script>
    <div id="greencard" class="swMain">
        <ifMode mode="ENTER">
            <ul>
                <li><a href="#step-1">
                    <label class="stepNumber">1</label>
                    <span class="stepDesc">
             Visit details<br />
          </span>
                </a></li>
                <li><a href="#step-2">
                    <label class="stepNumber">2</label>
                    <span class="stepDesc">
             History<br />
          </span>
                </a></li>
                <li><a href="#step-3">
                    <label class="stepNumber">3</label>
                    <span class="stepDesc">
             Examination<br />
          </span>
                </a></li>
                <li><a href="#step-4">
                    <label class="stepNumber">4</label>
                    <span class="stepDesc">
            Management<br />
          </span>
                </a></li>
            </ul>
        </ifMode>
        <ifMode mode="EDIT">
            <ul>
                <li><a href="#step-1">
                    <label class="stepNumber">1</label>
                    <span class="stepDesc">
             Visit details<br />
          </span>
                </a></li>
                <li><a href="#step-2">
                    <label class="stepNumber">2</label>
                    <span class="stepDesc">
             History<br />
          </span>
                </a></li>
                <li><a href="#step-3">
                    <label class="stepNumber">3</label>
                    <span class="stepDesc">
             Examination<br />
          </span>
                </a></li>
                <li><a href="#step-4">
                    <label class="stepNumber">4</label>
                    <span class="stepDesc">
            Management<br />
          </span>
                </a></li>
            </ul>
        </ifMode>

        <div class="ke-form-content">
            <!--Wizard Step 1-->
            <div id="step-1">
                <h2 class="StepTitle">Visit details</h2>
                <div class="ke-form-header">
                    <table width="100%">
                        <tr>
                            <td>Date:
                                <encounterDate id="encounter-date" showTime="true"/>
                            </td>
                            <td>Location:
                                <encounterLocation default="GlobalProperty:kenyaemr.defaultLocation" type="autocomplete"/>
                            </td>
                        </tr>
                    </table>
                </div>
                <!-- These initial sections are duplicated from triage.xml, so try to keep them in sync -->
                <!--//Insert discard button-->
                <!--<ifMode mode="ENTER">-->
                    <!--<script type="text/javascript">-->
                        <!--jq(function(){-->
                            <!--jq("<button/>")-->
                                <!--.click(discardChanges)-->
                                <!--.html('Discard')-->
                                <!--.insertAfter('.buttonFinish');-->
                            <!--function discardChanges()-->
                            <!--{-->
                                <!--var fullUrl = window.location.host;-->
                                <!--console.log("fullurl ==>"+fullUrl);-->
                                <!--var parts = fullUrl.split('returnUrl=');-->
                                <!--var sub = parts[0];-->
                                <!--var domain = parts[1];-->

                                <!--console.log("first ==>"+sub);-->
                                <!--console.log("second ==>"+domain);-->
                                <!--//window.location.replace("domain");-->
                            <!--}-->
                        <!--});-->
                    <!--</script>-->
                <!--</ifMode>-->
                <!--On Edit display-->
                <ifMode mode="EDIT">
                    <script type="text/javascript">
                        jq(function(){
                            var age = parseInt('<lookup expression="patient.age"/>');
                            var keypop = getValue('population-type.value');
                            var everOnIPT = getValue('ever-on-ipt.value');
                            var hasLMP=getValue('hasLMP.value');
                            var wantsPreg=getValue('pregnancyIntention.value');
                            var ctxAdherence = getValue('ctx-adherence.value');
                            var ctxDispensed = getValue('ctx-dispensed.value');
                            var dapsoneAdherence = getValue('dapsone-adherence.value');
                            var dapsoneDispensed = getValue('dapsone-dispensed.value');
                            var clinicalDiagnosis = getValue("clinical-diagnosis-action.value");
                            var screeningRadios = jq('#screening-questions').find('input[type=radio]');
                            var actionTakenTab = jq('#action-taken');
                            var tbQuestions = jq('#tb-questions');
                            var iptClientWorkupTab = jq('#ipt-client-workup');
                            var tbRxdate = jq('#tbrxfield');
                            var screeningYesResponses = [];
                            var screeningNoResponses = [];

                            jq('#currently-onIpt :input').prop('disabled', false);
                            jq("#tbl-ever-on-ipt").show();
                            jq('#ever-taken-ipt :input').prop('disabled', false);

                            //if key pop show which type
                            if (keypop == 164929 ){
                                jq("#key-population").show();
                            }else{
                                jq("#key-population").hide();
                            }

             //If has LMP activate date and if pg
                            if (hasLMP == 1065) {     //yes_no pregnancy
                                jq('#lmp-date :input').prop('disabled', false);
                                jq('#if-patient-pregnant').show();
                                jq('#wants-pregnancy').show();
                            }else{
                                jq('#lmp-date :input').prop('disabled', true);
                            }
                           //if wants pregnancy show details
                            if (wantsPreg != false) {     //yes_no pregnancy
                                jq("#fp-details").show();
                            }else{
                                jq("#fp-details").hide();
                            }
                            if (age &lt; 10) {
                                jq('.reproductive-part').hide();
                                jq("#fp-details").hide();
                            }
                            //If using ctx show dispece and adherence
                            if (ctxAdherence != false || ctxDispensed != false) {     //ctx
                                jq("#ctx-part").show();
                            }
                            //If using dapsone show dispece and adherence
                            if (dapsoneAdherence != false || dapsoneDispensed != false) {     //dapsone
                                jq("#dapsone-part").show();
                            }
                            //TB screening show on edit
                            //if key pop show which type
                            if (everOnIPT == 1066 ){
                                jq("#tb-screening-tab").show();
                            }else{
                                jq("#tb-screening-tab").hide();
                            }
                            jq.each(screeningRadios, function(){
                                const YES_CONCEPT_ID = 1065;
                                const NO_CONCEPT_ID = 1066
                                const COUGH = 159799;
                                const CONTACT = 124068;
                                const FEVER = 1494;
                                const WEIGHTLOSS = 832;
                                const SWEAT =133027;
                                //Push any responses to the respective screeningYesResponses and screeningNoResponses array
                                if ((this.value == COUGH || this.value == CONTACT || this.value == FEVER || this.value == WEIGHTLOSS || this.value == SWEAT )&amp;&amp; this.checked == true) {
                                    screeningYesResponses.push(this);

                                }

                                if (this.value == NO_CONCEPT_ID &amp;&amp; this.checked == true) {
                                    screeningNoResponses.push(this);

                                }

                            });
                      //If no responses have been recorded than hide the ActionTaken and IPTClientWorkup tabs
                            if (screeningYesResponses.length == 0 &amp;&amp; screeningNoResponses.length == 0 ) {
                           // Do nothing
                            }
                            if (screeningYesResponses.length &gt; 0) {
                                tbQuestions.show();
                                actionTakenTab.show();
                            }
                              //Check if we have 5 NO responses
                            if (screeningNoResponses.length == screeningRadios.length / 2 ) {
                                tbQuestions.show();
                                iptClientWorkupTab.show();
                                }
                            if (clinicalDiagnosis == 703 ){
                                jq("#tbl-start-antiTb").show();
                            }else{
                                jq("#tbl-start-antiTb").hide();
                            }

                        });
                    </script>
                </ifMode>
                <!--.On Edit display-->
                <fieldset class="visit-details-part">
                    <legend>Visit Type</legend>
                    <table cellspacing="15">
                        <tr>
                            <th>Visit scheduled?</th>
                            <th align="left">Visit by</th>
                        </tr>
                        <tr>
                            <td>
                                <obs id="visit-scheduled" conceptId="1246AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" required="true" style="yes_no"/>
                            </td>
                            <td>
                                <obs
                                        id="person-present"
                                        conceptId="161643AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                        answerConceptIds="978AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,161642AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5622AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                        answerLabels="Self (SF),Treatment supporter (TS),Other (give name)"
                                        style="radio"
                                        answerSeparator="&lt;br /&gt;" required="true"
                                />
                                <obs id="person-present-name" conceptId="160638AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
                            </td>
                        </tr>
                    </table>
                </fieldset>
                <!--Triage-->
                <fieldset class="vitals-part">
                    <legend>Vital Signs</legend>

                    <table cellspacing="5" style=" float: left; ">
                        <tr>
                            <th>Vital signs</th>
                            <th align="left">Current</th>
                            <th align="left">Recent</th>
                        </tr>
                        <tr class="patient-details">
                            <td>Temp</td>
                            <td>
                                <obs conceptId="5088AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/> &#176;C
                            </td>
                            <td>
                                <span class="value"><recentObs conceptId="5088AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/></span>
                            </td>
                        </tr>
                        <tr class="patient-details">
                            <td>Pulse Rate</td>
                            <td>
                                <obs conceptId="5087AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
                            </td>
                            <td><span class="value"><recentObs conceptId="5087AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/></span></td>
                        </tr>
                        <tr class="patient-details">
                            <td>BP</td>
                            <td>
                                <obs conceptId="5085AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
                                /
                                <obs conceptId="5086AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
                                mmHg
                            </td>
                            <td><span class="value"><recentObs conceptId="5085AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/> / <recentObs
                                    conceptId="5086AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/></span></td>
                        </tr>
                        <tr class="patient-details">
                            <td>Respiratory Rate</td>
                            <td>
                                <obs conceptId="5242AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
                            </td>
                            <td><span class="value"><recentObs conceptId="5242AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/></span></td>
                        </tr>
                        <tr class="patient-details">
                            <td>Oxygen Saturation</td>
                            <td>
                                <obs conceptId="5092AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
                            </td>
                            <td><span class="value"><recentObs conceptId="5092AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/></span></td>
                        </tr>
                    </table>
                    <table cellspacing="5" style="display: inline-block; ">

                        <tr>
                            <th>Other Recordings</th>
                            <th align="left">Current</th>
                            <th align="left">Recent</th>
                            <th align="left">Nutritional Status</th>
                        </tr>
                        <tr class="patient-details">
                            <td>Weight</td>
                            <td>
                                <obs id="weight" conceptId="5089AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
                                kg
                            </td>
                            <td><span class="value"><recentObs conceptId="5089AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/></span></td>
                            <td rowspan="4">
                                <obs    id="nutritional-status"
                                        conceptId="163300AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                        answerConceptIds="1115AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,163302AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,163303AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,114413AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                        answerLabels="Normal,Severe acute malnutrition,Moderate acute malnutrition,Overweight/Obese"
                                        style="radio"
                                        answerSeparator="&lt;br /&gt;"
                                />
                            </td>
                        </tr>
                        <tr class="patient-details">
                            <td>Height</td>
                            <td>
                                <obs id="height" conceptId="5090AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
                                cm
                            </td>
                            <td><span class="value"><recentObs conceptId="5090AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/></span></td>
                        </tr>
                        <includeIf velocityTest="$patient.age &gt; 14">
                            <tr class="patient-details">
                                <td>BMI</td>
                                <td><span id="calculated-bmi" class="value"></span></td>
                                <td><span id="recent-calculated-bmi" class="value"></span></td>
                            </tr>
                        </includeIf>
                        <tr class="patient-details">
                            <td>MUAC</td>
                            <td>
                                <obs conceptId="1343AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
                            </td>
                            <td><span class="value"><recentObs conceptId="1343AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/></span></td>
                        </tr>
                    </table>
                </fieldset>
                <!-- Population Type  -->
                <fieldset class="population-type-part">
                    <legend>Population Type</legend>
                    <div>
                        Population type : &#160;&#160;
                        <obs conceptId="164930"
                             answerConceptIds="164928,164929"
                             answerLabels="General Population,Key Population" id="population-type"
                             style="radio" />
                    </div>
                    <table id="key-population">
                        <tr>
                            <td>
                                <obs conceptId="160581AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="105AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerLabel="People who inject drugs" style="checkbox" /><br/>
                                <includeIf velocityTest="$patient.gender == 'M'">
                                    <obs conceptId="160581AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="160578AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                         answerLabel="Men who have sex with men" style="checkbox" /><br/>
                                </includeIf>
                                <includeIf velocityTest="$patient.gender == 'F'">
                                    <obs conceptId="160581AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="160579AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                         answerLabel="Female sex Worker" style="checkbox" id="female-sex-worker" /><br/>
                                </includeIf>
                            </td>
                        </tr>
                    </table>
                </fieldset>

                <!-- WHO staging -->
                <fieldset class="who-staging-part">
                    <legend>WHO Staging</legend>
                    <table cellspacing="10" >
                        <tr>
                            <th  style="color: #888" >Current Stage </th>
                            <th  style="color: #888" >Recent </th>
                        </tr>
                        <tr>
                            <td>
                                <div id="whoAdult">
                                    <table>
                                        <tr>
                                            <td><strong>Adult</strong></td><td><obs conceptId="5356AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptIds="1204AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1205AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1206AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1207AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="dropdown" answerLabels="WHO Stage1,WHO Stage2,WHO Stage3,WHO Stage4" id="whoStage-adult"/></td>
                                        </tr>
                                    </table>
                                </div>
                                <div id="whoChild">
                                    <table>
                                        <tr>
                                            <td><strong>Child</strong></td><td><obs conceptId="5356AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptIds="1220AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1221AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1222AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1223AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="dropdown" answerLabels="WHO Stage1,WHO Stage2,WHO Stage3,WHO Stage4" id="whoStage-child" /></td>
                                        </tr>
                                    </table>
                                </div>
                            </td>
                            <td>
                                <span class="value"><recentObs conceptId="5356AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/></span>
                            </td>
                        </tr>
                    </table>
                </fieldset>

            </div>    <!--.step 1-->
            <!--.step 2-->
            <div id="step-2">
                <h2 class="StepTitle">Presenting complaints</h2>
                <!-- Additional History  -->
                <!--Presenting complaints today -->
                <fieldset class="complaints-part">
                    <legend>Complaints and History of complaints</legend>
                    <div>
                        Patient having complaint(s) today?
                        <obs id="complaints-today" conceptId="1154AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" required="true" style="yes_no"/>
                    </div>
                    <table cellspacing="5" id="tbl-complaints-today">
                        <tr>
                            <th style="color: #888">Complaint</th>
                            <th style="color: #888; text-align: center">Duration</th>
                            <th style="color: #888; text-align: center">Onset Date</th>
                        </tr>
                        <repeat>
                            <template>
                                <obsgroup groupingConceptId="160531AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA">
                                    <tr>
                                        <td>
                                            <obs class="complaint" conceptId="5219AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                 answerConceptIds="151AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,141631AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,121543AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,119537AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,148035AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,840AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,131021AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,120749AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,871AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,120345AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,119574AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,113054AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,206AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,143264AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,143129AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,142412AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,122496AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,118789AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,141830AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
                                                            141585AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,141128AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,131040AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,114399AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162626AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,140238AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,140070AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,123396AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,142247AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,135462AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,139084AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,117698AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,116214AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,112989AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,879AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,116558AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,114395AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,135595AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,135488AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
                                                             121657AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,144576AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,116334AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,131015AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,111721AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,133028AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,133632AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5978AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,133469AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,133027AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,132653AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,125225AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,131034AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5953AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,512AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,127777AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,113224AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,131032AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,126535AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
                                                               141597AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,158843AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,140941AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,125198AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,112200AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160208AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,111525AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,122983AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,832AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5622AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                 answerLabels="Abdominal pain,Abnormal Uterine Bleeding,Anxiety,Depression,Back pain,Bloody Urine,Breast Pain,Chest Pain,Cold and Chills,Confusion,Delirium,Convulsions,Seizure,Cough,Crying Infant,Diarrhea,Difficult in breathing,Difficulty in swallowing,Dizziness,Ear Pain,Epigastric Pain,Eye apin,Facial Pain,Fatigue/weakness,Fever,Flank Pain,Vaginal Discharge,Discharge from Penis,Genital Ulcer,Headache,Hearing Loss,Hypotension,Shock,Itchiness/Pruritus,Joint Pain,Leg Pain,Loss of Appetite,Lymphadenopathy,Memory Loss,Coma,Lethargy,Mouth Pain,Mouth Ulceration,Muscle cramps,Muscle Pain,Nausea,Neck Pain,Night sweats,Numbness,Pain when Swallowing,Pelvic Pain,Poor Vision,Rash,Red Eye,Running/Blocked nose,Scrotal Pain,Shoulder Pain,
                                                       Sleep Disturbance,Sore Throat,Excessive Sweating,Swollen Legs,Tremors,Urinary Symptoms,Vertigo,Vomiting,Weight Loss,Other"
                                                 style="dropdown"
                                            />
                                        </td>
                                        <td><obs class="complaint-time" conceptId="159368AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id ="complaint-duration"  /></td>
                                        <td>
                                            <obs class="complaint-date" conceptId="159948AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" allowFutureDates="false"/>
                                        </td>
                                    </tr>
                                </obsgroup>
                            </template>
                            <render n="1" concept="complaint"/>
                            <render n="2" concept="complaint"/>
                            <render n="3" concept="complaint"/>
                            <render n="4" concept="complaint"/>
                            <render n="5" concept="complaint"/>
                        </repeat>
                    </table>
                    <table>
                        <tr>
                            <th  style="color: #888" >Clinical Notes</th>
                            <th  style="color: #888" >Previous visit's notes</th>
                        </tr>
                        <tr>

                            <td>
                                <obs conceptId="160430AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" rows="3" cols="80"/>
                            </td>
                            <td>
                                <span class="value"><recentObs conceptId="160430AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/></span>
                            </td>
                        </tr>
                    </table>
                </fieldset>

                <fieldset class="tb-screening-part">
                    <!--TB Screening-->
                    <legend>TB Screening</legend>
                    <table cellspacing="10" id="tb-questions">
                        <tr>
                            <th  style="color: #888" >Current Status </th>
                            <th  style="color: #888" >Recent </th>
                        </tr>
                        <tr>
                            <td>
                                Patient on anti-TB Drugs? &#160;
                                <obs conceptId="164948"
                                     answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerLabel="Yes,No" required="true"
                                     style="radio"
                                     id="on-anti-tb-drugs" />
                                <br/>
                            </td>
                            <td width="20%"> <div><a class="tb-patient"></a></div></td>

                        </tr>
                        <tr id="currently-onIpt">
                            <td>
                                Patient currently on IPT? &#160;&#160;
                                <obs conceptId="164949"
                                     answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerLabel="Yes,No"
                                     style="radio"
                                     id="on-ipt" />
                                <br/>
                            </td>
                            <td width="20%"> <div><a class="ipt-patient"></a></div></td>
                        </tr>
                    </table>
                    <table id="tbl-ever-on-ipt">
                        <tr id="ever-taken-ipt">
                            <td>
                                Patient ever on IPT? &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
                                <obs conceptId="164950"
                                     answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerLabel="Yes,No"
                                     style="radio"
                                     id="ever-on-ipt" />
                                <br/>
                            </td>
                            <td>
                                <!--<span class="value"><recentObs conceptId="1265AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/></span>-->
                            </td>
                        </tr>
                    </table>
                    <br/>
                    <fieldset id="tb-screening-tab">
                        <legend>Screening Questions</legend>
                        <table id="screening-questions">
                            <obsgroup groupingConceptId="160108AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA">

                                <tr>
                                    <td>Cough of any duration:</td>
                                    <td><obs conceptId="1729AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText=" " answerConceptIds="159799AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio" answerLabels="Yes,No" id="tb-screening-error" /></td>
                                </tr>
                                <includeIf velocityTest="$patient.age &lt; 15">
                                <tr>
                                        <td>Contact with a TB Case:</td>
                                        <td><obs conceptId="1729AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText=" " answerConceptIds="124068AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio" answerLabels="Yes,No" /></td>
                                </tr>
                            </includeIf>
                            <tr>
                                    <td>Fever:</td>
                                    <td><obs conceptId="1729AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText=" " answerConceptIds="1494AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio" answerLabels="Yes,No" /></td>

                            </tr>
                            <tr>
                                    <td>Noticeable weight loss or poor weight gain:</td>
                                    <td><obs conceptId="1729AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText=" " answerConceptIds="832AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio" answerLabels="Yes,No" /></td>
                            </tr>
                            <includeIf velocityTest="$patient.age &gt; 15">
                             <tr>
                                    <td>Night sweats:</td>
                                    <td><obs conceptId="1729AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText=" " answerConceptIds="133027AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio" answerLabels="Yes,No" /></td>
                             </tr>
                            </includeIf>
                            </obsgroup>
                        </table>
                    </fieldset>

                    <fieldset id="action-taken">
                        <legend>Indicate Action Taken</legend>
                        <table id="tb-test-ordered">
                            <tr>
                                <td>Tests Ordered:</td>
                                <td><obs id="ord-sputum-smear" conceptId="1271AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Sputum Smear" answerConceptId="307AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="checkbox" /><hr/></td>
                                <td><obs id="ord-chest-xray" conceptId="1271AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Chest Xray" answerConceptId="12AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="checkbox" /><hr/></td>
                                <td><obs id="ord-gene-xpert" conceptId="1271AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="GeneXpert" answerConceptId="162202AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="checkbox" />
                                    <hr/> </td>
                            </tr>
                        </table>
                        <table>
                            <tr>
                                <td>Sputum Smear:</td>
                                <td><obs id="sputum-smear-action" conceptId="307AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText=" " answerConceptIds="703AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,664AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio" /></td>

                            </tr>
                            <tr>
                                <td>Chest X-ray:</td>
                                <td><obs id="chest-xray-action" conceptId="12AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText=" " answerConceptIds="1115AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,152526AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio" /></td>
                            </tr>
                            <includeIf velocityTest="$patient.age &lt; 15">
                                <tr>
                                    <td>Referral:</td>
                                    <td><obs id="referral-action" conceptId="1272AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText=" " answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio" /></td>
                                </tr>
                            </includeIf>
                            <tr>
                                <td>GeneXpert:</td>
                                <td><obs id="genexpert-action" conceptId="162202AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                         answerConceptIds="664AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162203AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162204AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,164104AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,163611AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1138AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                         style="dropdown"
                                /></td>
                            </tr>
                            <tr>
                                <td colspan="2"><p> </p></td>
                            </tr>
                            <tr>
                                <td>Clinical diagnosis:</td>
                                <td><obs  id="clinical-diagnosis-action" conceptId="163752AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText=" " answerConceptIds="703AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,664AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio" /></td>
                            </tr>

                            <tr>
                                <td>Invitation of contacts:</td>
                                <td><obs conceptId="163414" labelText=" " answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio" /></td>
                            </tr>
                            <tr>
                                <td>Evaluated for IPT:</td>
                                <td><obs conceptId="162275AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText=" " answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio" /></td>
                            </tr>
                        </table>
                        <table id="tb-screening-result">
                            <tr>
                                <td colspan="2"><p> </p></td>
                            </tr>
                            <tr>

                                <td colspan="3">
                                    <obs id="tb-result-status" conceptId="1659AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText="Resulting TB Status:" answerConceptIds="1660AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,142177AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1662AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160737AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio" answerLabels="No TB Signs,Presumed TB,TB Confirmed,TB Screening Not Done" />
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2"> <p></p></td>
                            </tr>
                        </table>
                        <table id="tbl-start-antiTb">
                            <tr>
                                <td colspan="2">Start Anti-TBs:
                                    <obs  id="start-anti-tb-action" conceptId="162309AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio"
                                          answerLabels="Yes,No"/>
                                    <hr />
                                </td>

                            </tr>
                            <tr><p></p></tr>

                            <tr id="tbrxfield">
                                <td width="50%" style="text-align: left"><obs  conceptId="1113AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText="TB Rx date: " id="tbrxdate"/> </td>

                                <td><obs conceptId="1111AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText="TB Rx:" id="tb-regimen"
                                         answerConceptSetIds="160021AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="dropdown"
                                /></td>
                            </tr>
                        </table>
                    </fieldset>
                    <fieldset id="ipt-client-workup">
                        <legend>Isoniazid Preventive Therapy (IPT) Client Workup</legend>
                        <table>
                            <tr>
                                <td colspan="2" class="ke-panel-header">Ask for the following</td>
                            </tr>
                            <obsgroup groupingConceptId="1727AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA">
                              <tr>
						            <td>1. Yellow Urine</td>
                                    <td><obs conceptId="1729AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText=" " answerConceptIds="162311AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio" answerLabels="Yes,No" /></td>
                            </tr>
                            <tr>
                                    <td>2. Numbness/ burning sensation on the hands or feet</td>
                                    <td><obs conceptId="1729AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText=" " answerConceptIds="132652AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio" answerLabels="Yes,No" /></td>
                            </tr>
                            <tr>
                                <td colspan="2" class="ke-panel-header">Examine the following</td>
                            </tr>
                            <tr>
                                    <td>1. Yellowness of eyes </td>
                                    <td><obs conceptId="1729AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText=" " answerConceptIds="5192AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio" answerLabels="Yes,No" /></td>
                            </tr>
                            <tr>
                                    <td>2.Tenderness in the upper right quadrant of the abdomen </td>
                                    <td><obs conceptId="1729AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText=" " answerConceptIds="124994AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio" answerLabels="Yes,No" /></td>
                            </tr>
                            </obsgroup>
                        </table>
                    </fieldset>

                    <div id="ipt-initiation" style="width: 100%; float: left; overflow: auto; text-align: left; padding: 5px"><span class="ke-flagtag">Candidate for IPT Initiation</span>
                        <table>
                            <tr>
                                <td colspan="2">
                                    <obs id="ipt-result-status" conceptId="1265AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText="Resulting IPT Action:" answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio" answerLabels="IPT Started,IPT Not Started" />
                                    <hr />
                                </td>
                            </tr>
                        </table>
                    </div>

                </fieldset>
                <fieldset id="ipt-followup">
                    <legend>IPT Followup</legend>

                    <table>
                        <tr>
                            <td>IPT Due Date</td>
                            <td><obs conceptId="164073AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" allowFutureDates="true" /></td>
                        </tr>
                        <tr>
                            <td>Date collected IPT</td>
                            <td><obs conceptId="164074" allowFutureDates="true" /></td>
                        </tr>
                        <tr>
                            <td>Weight</td>
                            <td><recentObs conceptId="5089AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/></td>
                        </tr>
                        <tr>
                            <td>Hepatotoxity?  &lt;/br&gt; (Vomiting, persistent irritability, abdominal pain, RUQ pain, yellow urine or eyes)</td>
                            <td><obs conceptId="159098AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"  answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio"/></td>
                        </tr>
                        <tr>
                            <td>Peripheral Neuropathy  &lt;/br&gt; Does client have any of the following in the limbs? Numbness, tingling or burning sensation</td>
                            <td><obs conceptId="118983AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio"/></td>
                        </tr>
                        <tr>
                            <td>Does the patient have Rash?	</td>
                            <td><obs conceptId="512AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio"/></td>
                        </tr>
                        <tr>
                            <td>Adherence Measurement &lt;/br&gt;Good= missed &lt;3 doses/month Fair=missed 4-8 doses/month Poor= missed 9 doses/month</td>
                            <td><obs conceptId="164075AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptIds="159405AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,159406AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,159407AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio"/></td>
                        </tr>
                    </table>
                    <br />
                    <div>  <button type="button" name="bt-ipt-outcome" id="bt-ipt-outcome">Record IPT Outcome</button> </div>
                    <table id="tbl-ipt-outcome">

                        <tr>
                            <td>Event:</td>
                            <td><obs id="ipt-event-type" conceptId="160433AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptIds="1267AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5240AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,159836AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160034AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,159492AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="dropdown" labelText=""  showDate="true"/></td>
                        </tr>
                        <tr id="reason-for-discontinuation">
                            <td>Reason for discontinuation</td>
                            <td><obs conceptId="1266AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptIds="102AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,112141AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5622AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="dropdown" labelText="" /></td>
                        </tr>
                        <tr>
                            <td>Action Taken</td>
                            <td><obs id="action-taken" conceptId="160632AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" cols="45" rows="1" /></td>
                        </tr>
                    </table>

                </fieldset>

                <fieldset id="ipt-uptake">
                    <legend>IPT Uptake History</legend>

                    <table>
                        <tr>
                            <th>IPT Due Date</th>
                            <th>Date collected IPT</th>
                            <th>Weight(Kg)</th>
                            <th>Hepatotoxicity</th>
                            <th>Peripheral Neuropathy</th>
                            <th>Rash?</th>
                            <th>Adherence Measurement</th>
                        </tr>
                        <lookup complexExpression="
			#foreach($encounter in $fn.allEncounters('aadeafbe-a3b1-4c57-bc76-8461b778ebd6'))
				&lt;tr&gt;
				#set($iptDueDate='')
				#set($iptCollectionDate='')
				#set($weight='')
				#set($hepatotoxicity='')
				#set($peripheralneuropathy='')
				#set($rash='')
				#set($adherenceMeasurement='')

				#foreach($obs in $encounter.obs)

						#if ( $obs.concept==164073 )
							#set($iptDueDate=($obs.getValueAsString(en)))
						#end
						#if ( $obs.concept==164074 )
							#set($iptCollectionDate=$obs.getValueAsString(en))
						#end
						#if ( $obs.concept==5089 )
							#set($weight=$obs.valueNumeric)
						#end
						#if ( $obs.concept==159098 )
							#set($hepatotoxicity=$obs.valueCoded.name)
						#end
						#if ( $obs.concept==118983 )
							#set($peripheralneuropathy=$obs.valueCoded.name)
						#end
						#if ( $obs.concept==512 )
							#set($rash=$obs.valueCoded.name)
						#end
						#if ( $obs.concept==164075 )
							#set($adherenceMeasurement=$obs.valueCoded.name)
						#end

				#end

				&lt;td&gt;
					$iptDueDate
				&lt;/td&gt;
				&lt;td&gt;
					$iptCollectionDate
				&lt;/td&gt;
				&lt;td&gt;
					$weight
				&lt;/td&gt;
				&lt;td&gt;
					$hepatotoxicity
				&lt;/td&gt;
				&lt;td&gt;
					$peripheralneuropathy
				&lt;/td&gt;
				&lt;td&gt;
					$rash
				&lt;/td&gt;
				&lt;td&gt;
					$adherenceMeasurement
				&lt;/td&gt;
				&lt;/tr&gt;
			#end"/>
                    </table>
                </fieldset>
                <!-- Known allergies   -->
                <fieldset class="known-allergies-part">
                    <legend>Known Allergies</legend>
                    <div>
                        Patient has any known allergie(s)? &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
                        <obs id="known-allergies" conceptId="160557AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" required="true" style="yes_no"/>
                    </div>

                    <table id="tbl-known-allergies">
                        <tr>
                            <td colspan="2">Record any known allergies<br/>
                                <table>
                                    <tr>
                                        <th>Causative agent</th>
                                        <th>Reaction</th>
                                        <th>Severity</th>
                                        <th>Date of Onset</th>
                                    </tr>
                                    <repeat>
                                        <template>
                                            <obsgroup groupingConceptId="121689AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA">
                                                <tr>
                                                    <td><obs class="allergen" conceptId="160643AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                             answerConceptIds="162543AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,72609AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162544AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162545AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162171AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162546AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162547AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162172AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162175AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
                                                                            162176AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162548AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162177AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162542AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162536AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162537AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162538AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162539AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162540AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
                                                                              	162541AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5622AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                             answerLabels="Beef,Caffeine,Chocolate,Dairy Food,Eggs,Fish,Milk Protein,Peanuts,Shellfish,Soy,Strawberries,Wheat,Adhesive Tape,Bee Stings,Dust,Latex,Mold,Pollen,Ragweed,Other"
                                                             style="dropdown"


                                                    />

                                                    </td>
                                                    <td><obs class="reaction" conceptId="159935AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                             answerConceptIds="1067AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,121629AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,148888AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,148787AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,120148AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,108AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,143264AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,142412AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,118773AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,140238AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,140039AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,139581AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,139084AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,159098AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
                                                                            111061AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,117399AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,879AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,121677AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,159347AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,121AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,512AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5622AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                             answerLabels="Unknown,Anaemia,Anaphylaxis,Angioedema,Arrhythmia,Bronchospasm,Cough,Diarrhea,Dystonia,Fever,Flushing,GI upset,Headache,Hepatotoxicity,Hives,Hypertension,Itching,Mental status change,Musculoskeletal pain,Myalgia,Rash,Other"
                                                             style="dropdown"
                                                    /></td>
                                                    <td><obs class="severity" conceptId="162760AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"  answerConceptIds="160754AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160755AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160756AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160758AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1067AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabels="Mild,Moderate,Severe,Fatal,Unknown" /></td>
                                                    <td><obs class="allergy-date" conceptId="160753AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"  allowFutureDates="false" labelText=" " /></td>
                                                </tr>
                                            </obsgroup>
                                        </template>
                                        <render n="1" concept=" " />
                                        <render n="2" concept=" " />
                                        <render n="3" concept=" " />
                                        <render n="4" concept=" " />
                                        <render n="5" concept=" " />
                                    </repeat>
                                </table>
                            </td>
                        </tr>
                    </table>
                </fieldset>
                <!--Chronic Illnesses-->
                <fieldset class="chronic-illness-part">
                    <legend>Chronic Illnesses and Cormobidities</legend>
                    <div>
                        Patient has any chronic illnesse(s)? &#160;&#160;&#160;&#160;&#160;&#160;&#160;
                        <obs id="chronic-illness" conceptId="162747AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                             answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                             style="radio" answerLabels="Yes,No" required="true"
                        />
                    </div>
                    <table id="tbl-chronic-illness">
                        <tr>
                            <th style="color: #888">Illness</th>
                            <th style="color: #888; text-align: center">Onset Date</th>
                            <th style="color: #888">Drug</th>
                            <th style="color: #888; text-align: center">Dose</th>
                            <th style="color: #888; text-align: center">Units</th>
                            <th style="color: #888; text-align: center">Frequency</th>
                            <th style="color: #888; text-align: center">Duration</th>
                            <th style="color: #888; text-align: center">Duration units</th>
                        </tr>
                        <repeat>
                            <template>
                                <obsgroup groupingConceptId="159392AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA">
                                    <tr>
                                        <td>
                                            <obs
                                                    conceptId="1284AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" class="illness-chronic"
                                                    answerConceptIds="149019AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,148432AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,153754AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,159351AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,119270AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,120637AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,145438AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1295AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,120576AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,119692AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,120291AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,119481AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,118631AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,117855AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,117789AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,139071AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,115728AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,117399AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,117321AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,151342AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,133687AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,115115AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,114662AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,117703AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,118976AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                    answerLabels="Alzheimer's Disease and other Dementias,Arthritis,Asthma,Cancer,Cardiovascular diseases,Chronic Hepatitis,Chronic Kidney Disease,Chronic Obstructive Pulmonary Disease(COPD),Chronic Renal Failure,Cystic Fibrosis,Deafness and Hearing impairment,Diabetes,Endometriosis,Epilepsy,Glaucoma,Heart Disease,Hyperlipidaemia,Hypertension,Hypothyroidism,Mental illness,Multiple Sclerosis,Obesity,Osteoporosis,Sickle Cell Anaemia,Thyroid disease"
                                                    style="dropdown"
                                            />
                                        </td>

                                        <td><obs class="onset-date-chronic-illness" conceptId="159948AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" allowFutureDates="false" /></td>

                                        <td><obs class= "drug-chronic-illness" conceptId="1282AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerClasses="Drug" style="autocomplete" /></td>
                                        <td><obs class = "dose-chronic-illness" conceptId="1443AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" /></td>
                                        <td><obs class ="units-chronic-illness" conceptId="1444AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" size="5" /></td>
                                        <td>
                                            <obs class="frequency-chronic-illness"
                                                 conceptId="160855AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                 answerConceptIds="160862AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160863AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160864AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160865AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160858AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160866AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160870AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                 answerLabels="Once daily,Once daily at bedtime,Once daily in the evening,Once daily in the morning,Twice daily,Thrice daily,Four times daily"
                                            />
                                        </td>
                                        <td><obs class="duration-chronic-illness" conceptId="159368AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" /></td>
                                        <td>
                                            <obs class="duration-units-illness"
                                                 conceptId="1732AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                 answerConceptIds="1822AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1072AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1073AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1074AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                 answerLabels="Hours,Days,Weeks,Months" />
                                        </td>
                                    </tr>
                                </obsgroup>
                            </template>
                            <render n="1" concept="Drug"/>
                            <render n="2" concept="Drug"/>
                            <render n="3" concept="Drug"/>
                            <render n="4" concept="Drug"/>
                            <render n="5" concept="Drug"/>
                        </repeat>
                    </table>
                </fieldset>
                <fieldset class="adverse-reactions-part">
                    <legend>Adverse Drug Reactions</legend>
                    <div>
                        Patient has adverse drug reaction(s)? &#160;&#160;&#160;&#160;
                        <obs id="adverse-reactions" conceptId="121764AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" required="true" style="yes_no"/>
                    </div>
                    <table id="tbl-adverse-reactions">
                        <tr>
                            <td colspan="2">Record any Adverse Drug Reactions since the last visit<br/>
                                <table>
                                    <tr>
                                        <th>Medicine Causing Reaction</th>
                                        <th>Reaction</th>
                                        <th>Severity</th>
                                        <th>Date of Onset</th>
                                        <th>Action taken</th>
                                    </tr>
                                    <repeat>
                                        <template>
                                            <obsgroup groupingConceptId="121760AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA">
                                                <tr>
                                                    <td><obs class="medicine-causing"
                                                             conceptId="1193AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                             answerConceptIds="70056AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162298AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,70878AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,155060AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162299AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,103727AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,71647AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,72822AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162301AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,73300AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,73667AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,74807AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,75523AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162302AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
                                                                            75948AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,77164AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162305AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,77675AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,78280AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,794AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,80106AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,80586AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,80696AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162306AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,81723AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,81724AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,81959AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,82023AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
                                                                               	82559AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,82900AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,83018AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,767AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162307AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,84309AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162170AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,84795AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,84893AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,86663AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5622AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                             answerLabels="Abicavir,ACE inhibitors,Allopurinol,Aminoglycosides,ARBs (angiotensin II receptor blockers),Aspirin,Atazanavir,Carbamazepine,Cephalosporins,Chloroquine,Codeine,Didanosine,Efavirenz,Erythromycins,Ethambutol,Griseofulvin,Heparins,Hydralazine,Isoniazid,Lopinavir/ritonavir,Morphine,Nevirapine,Nitrofurans,Non-steroidal anti-inflammatory drugs,Penicillamine,Penicillin,Phenolphthaleins,Phenytoin,Procainamide,Pyrazinamide,Quinidine,Rifampin,Statins,Stavudine,Sulfonamides,Tenofovir,Tetracycline,Zidovudine,Other"
                                                             style="dropdown"
                                                    />
                                                    </td>
                                                    <td><obs class ="reaction"
                                                             conceptId="159935AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                             answerConceptIds="1067AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,121629AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,148888AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,148787AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,120148AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,108AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,143264AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,142412AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,118773AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,140238AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,140039AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,139581AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,139084AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,159098AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
                                                                            111061AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,117399AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,879AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,121677AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,159347AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,121AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,512AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5622AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                             answerLabels="Unknown,Anaemia,Anaphylaxis,Angioedema,Arrhythmia,Bronchospasm,Cough,Diarrhea,Dystonia,Fever,Flushing,GI upset,Headache,Hepatotoxicity,Hives,Hypertension,Itching,Mental status change,Musculoskeletal pain,Myalgia,Rash,Other"
                                                             style="dropdown"
                                                    /></td>
                                                    <td><obs  class="severity"
                                                              conceptId="162760AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                              answerConceptIds="1498AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1499AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1500AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162819AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1067AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                              answerLabels="Mild,Moderate,Severe,Fatal,Unknown" /></td>
                                                    <td><obs class="adverse-events-onset-date" conceptId="160753AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" allowFutureDates="false" labelText=" " /></td>
                                                    <td>
                                                        <obs class="action-taken"
                                                             conceptId="1255AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                             answerConceptIds="1257AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1259AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,981AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1258AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1107AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1260AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                             answerLabels="CONTINUE REGIMEN,CHANGE REGIMEN,DOSING CHANGE,CHANGE FORMULATION,NONE,STOP"
                                                             style="dropdown"
                                                        />
                                                    </td>
                                                </tr>
                                            </obsgroup>
                                        </template>
                                        <render n="1" concept=" " />
                                        <render n="2" concept=" " />
                                        <render n="3" concept=" " />
                                        <render n="4" concept=" " />
                                        <render n="5" concept=" " />
                                    </repeat>
                                </table>
                            </td>
                        </tr>
                    </table>
                </fieldset>

                <fieldset class="vaccinations-part">
                    <legend>Vaccination(s) today</legend>
                    <includeIf velocityTest="$patient.age &lt; 15">
                        <table width="30%">
                            <tr>
                                <th style="color: #888" align="left">Vaccination</th>
                                <!--<th style="color: #888" align="left">Recent</th>-->
                                <!--<th style="color: #888" align="left">Count</th>-->
                            </tr>

                            <tr>
                                <td><obs conceptId="1198AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="886AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="BCG" style="checkbox" /></td>
                                <!--<td> <lookup expression="fn.latestObs(1198).valueCoded().equals(886).obsDateTime"/> </td>-->
                                <!--<td> <lookup expression="fn.allObs(1198).valueCoded().equals(886).size()"/> </td>-->
                            </tr>
                            <tr>
                                <td><obs conceptId="1198AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="82215AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="PV" style="checkbox" /></td>
                                <!--<td> <lookup expression="fn.latestObs(1198).valueCoded().equals(82215).obsDateTime"/> </td>-->
                                <!--<td> <lookup expression="fn.allObs(1198).valueCoded().equals(82215).size()"/> </td>-->
                            </tr>
                            <tr>
                                <td><obs conceptId="1198AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="1423AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Penta" style="checkbox" /></td>
                                <!--<td> <lookup expression="fn.latestObs(1198).valueCoded().equals(1423).obsDateTime"/> </td>-->
                                <!--<td> <lookup expression="fn.allObs(1198).valueCoded().equals(1423).size()"/> </td>-->
                            </tr>
                            <tr>
                                <td><obs conceptId="1198AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="162342AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="PCV" style="checkbox" /></td>
                                <!--<td> <lookup expression="fn.latestObs(1198).valueCoded().equals(162342).obsDateTime"/> </td>-->
                                <!--<td> <lookup expression="fn.allObs(1198).valueCoded().equals(162342).size()"/> </td>-->
                            </tr>
                            <tr>
                                <td><obs conceptId="1198AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="36AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Measles" style="checkbox" /></td>
                                <!--<td> <lookup expression="fn.latestObs(1198).valueCoded().equals(36).obsDateTime"/> </td>-->
                                <!--<td> <lookup expression="fn.allObs(1198).valueCoded().equals(36).size()"/> </td>-->
                            </tr>
                        </table>
                    </includeIf>
                    <includeIf velocityTest="$patient.age &gt; 15">
                        <table width="30%">
                            <tr>
                                <th style="color: #888" align="left">Vaccination</th>
                                <!--<th style="color: #888" align="left">Recent</th>-->
                                <!--<th style="color: #888" align="left">Count</th>-->
                            </tr>

                            <tr>
                                <td><obs conceptId="1198AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="782AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="HBV" style="checkbox" /></td>
                                <!--<td> <lookup expression="fn.latestObs(1198).valueCoded().equals(782).obsDateTime"/> </td>-->
                                <!--<td> <lookup expression="fn.allObs(1198).valueCoded().equals(782).size()"/> </td>-->
                            </tr>
                            <tr>
                                <td><obs conceptId="1198AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="5261AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Flu" style="checkbox" /></td>
                                <!--<td> <lookup expression="fn.latestObs(1198).valueCoded().equals(5261).obsDateTime"/> </td>-->
                                <!--<td> <lookup expression="fn.allObs(1198).valueCoded().equals(82215).size()"/> </td>-->
                            </tr>

                        </table>
                        <table>
                            <tr>
                                <td><obs conceptId="1198AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="5622AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Other" style="checkbox"
                                /><obs conceptId="160632AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" /></td>

                                <!--<td> <lookup expression="fn.latestObs(1198).valueCoded().equals(5622).obsDateTime"/> </td>-->
                                <!--<td> <lookup expression="fn.allObs(1198).valueCoded().equals(5622).size()"/> </td>-->
                            </tr>
                        </table>
                    </includeIf>
                </fieldset>

                <!--Sexual and Obstetric History-->

                <!--Sexual and reproductive History validated for women over 10 years -->
                <includeIf velocityTest="$patient.gender == 'F'">
                    <fieldset class="reproductive-part">
                        <legend>Sexual and Reproductive History</legend>
                        <!--<table class="right-aligned-first" style="width: 100%;" border="0">-->
                        <table cellspacing="18" >
                            <tr>
                                <th  style="color: #888" >Current Status</th>
                                <th  style="color: #888" >Date </th>
                                <th  style="color: #888" >Recent </th>
                            </tr>
                            <tr>
                                <td>
                                    <obs labelText="Does patient normally have menses?  &#160;&#160;&#160;&#160;" conceptId="162877AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="hasLMP"
                                         answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1175AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                         style="radio" answerLabels="Yes,No,N/A"
                                    />
                                </td>
                                <td>
                                    <obs id="lmp-date" labelText="Date:  &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;"
                                         conceptId="1427AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
                                </td>
                                <td>
                                    <span class="value"><recentObs conceptId="1427AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/></span>
                                </td>
                            </tr>
                        </table>
                        <table id="if-patient-pregnant">
                            <tr>
                                <td>
                                    <obs conceptId="5272AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                         labelText="Patient Pregnant?: &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;"
                                         answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                         style="radio" answerLabels="Yes,NO" id="pregnancyOption"/>
                                </td>
                                <td>
                                    <span class="value"><recentObs conceptId="5272AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/></span>
                                </td>
                            </tr>
                        </table>
                        <div id="wants-pregnancy">
                            <obs conceptId="164933"
                                 labelText="Wants to get pregnant in three months? &#160;&#160;"
                                 answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                 style="radio" answerLabels="Yes,NO" id="pregnancyIntention" />
                        </div>
                        <table id="pregnancyOptionValues">
                            <tr>
                                <td width="8%" style="text-align: left">ANC Number:</td>
                                <td>
                                    <obs conceptId="161655AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText=" "/>
                                </td>
                                <td></td>
                            </tr>
                            <tr>
                                <td style="text-align: left">EDD:</td>
                                <td colspan="2">
                                    <obs conceptId="5596AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" showTime="false"
                                         allowFutureDates="true" labelText=" " id="patient-edd" readonly="true"/>
                                    <span class="value"><recentObs conceptId="5596AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/></span>
                                </td>
                            </tr>
                            <tr>
                                <td style="text-align: left">ANC/PNC Profile</td>
                                <td>
                                    <obs id="anc-profile" conceptId="159423AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabels="Yes,No" style="radio" />
                                </td>
                            </tr>
                            <tr>
                                <td>Parity:</td>
                                <td>
                                    <obs id="parity-term" conceptId="160080AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"  />
                                    +
                                    <obs  id="parity-abortion" conceptId="1823AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" />
                                </td>
                            </tr>
                            <tr>
                                <td>Gravida:</td>
                                <td>
                                    <obs conceptId="5624AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"  id="gravida"/>
                                </td>
                            </tr>
                        </table>
                    </fieldset>
                </includeIf>

                <!--Family Planning-->
                <fieldset id="fp-details" >
                    <legend>Family Planning Status</legend>
                    <table id="fpOptionValues">
                        <tr>
                            <td colspan="2">
                                Family Planning Status :
                                <obs conceptId="160653AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="fplanning"
                                     answerConceptIds="965AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160652AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1360AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     style="dropdown"
                                     answerLabels="On Family Planning,Not using Family Planning,Wants Family Planning"/>
                                <hr/>
                                <br/>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="2">
                                <div id="onFp">
                                    If currently using Family Planning, or wants Family Planning, specify which method(s)
                                    <hr/>
                                    <includeIf velocityTest="$patient.gender == 'F'">
                                        <table class="right-aligned-first" style="width: 100%;" border="0">
                                            <obsgroup groupingConceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA">
                                                <tr>

                                                    <td style="text-align: left">
                                                        <div style="float: left; padding-right: 50px">
                                                            <obs conceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerConceptId="160570AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerLabel="Emergency contraceptive pills" style="checkbox"
                                                            />
                                                            <br />
                                                            <obs conceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerConceptId="780AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerLabel="Oral Contraceptives Pills" style="checkbox"/>
                                                            <br />
                                                            <obs conceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerConceptId="5279AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerLabel="Injectible" style="checkbox"/>
                                                            <br />
                                                            <obs conceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerConceptId="1359AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerLabel="Implant" style="checkbox"/>
                                                            <br />
                                                            <obs conceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerConceptId="5275AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerLabel="Intrauterine Device" style="checkbox"/>
                                                            <br />
                                                            <obs conceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerConceptId="136163AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerLabel="Lactational Amenorhea Method" style="checkbox"/>
                                                            <br />
                                                        </div>
                                                    </td>
                                                    <td>
                                                        <div style="float: left; padding-right: 50px">
                                                            <obs conceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerConceptId="5278AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerLabel="Diaphram/Cervical Cap" style="checkbox"/>
                                                            <br />
                                                            <obs conceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerConceptId="5277AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerLabel="Fertility Awareness"
                                                                 style="checkbox"/>
                                                            <br />
                                                            <obs conceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerConceptId="1472AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerLabel="Tubal Ligation" style="checkbox"/>
                                                            <br />
                                                            <obs conceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerConceptId="190AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerLabel="Condoms" style="checkbox"/>
                                                            <br />
                                                            <obs conceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerConceptId="1489AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerLabel="Vasectomy(Partner)" style="checkbox"/>
                                                            <br />
                                                            <obs conceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerConceptId="162332AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerLabel="Undecided" style="checkbox" id="fp-error"/>
                                                            <br />
                                                        </div>
                                                    </td>
                                                </tr>
                                            </obsgroup>
                                        </table>
                                    </includeIf>

                                    <includeIf velocityTest="$patient.gender == 'M'">
                                        <table class="right-aligned-first" style="width: 100%;" border="0">
                                            <obsgroup groupingConceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA">
                                                <tr>
                                                    <td style="text-align: left">
                                                        <obs conceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                             answerConceptId="190AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                             answerLabel="Condoms" style="checkbox"/>
                                                        <br/>
                                                        <obs conceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                             answerConceptId="1489AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                             answerLabel="Vasectomy" style="checkbox"/>
                                                        <br/>
                                                        <obs conceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                             answerConceptId="162332AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                             answerLabel="Undecided" style="checkbox" id="fp-error"/>
                                                    </td>

                                                </tr>
                                            </obsgroup>
                                        </table>
                                    </includeIf>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="2">
                                <div id="notOnFp">
                                    <br/>Not using Family Planning? Specify reason(s)
                                    <hr/>
                                    <includeIf velocityTest="$patient.gender == 'F'">
                                        <table style="width: 70%" border="0">
                                            <obsgroup groupingConceptId="160575AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA">
                                                <tr>
                                                    <td>
                                                        <div style="float: left; padding-right: 50px">
                                                            <obs conceptId="160575AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerConceptId="160572AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerLabel="Thinks can't get pregnant"
                                                                 style="checkbox"/>
                                                            <br/>
                                                            <obs conceptId="160575AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerConceptId="160573AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerLabel="Not sexually active now"
                                                                 style="checkbox"/>
                                                            <br/>
                                                            <obs conceptId="160575AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerConceptId="5622AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerLabel="Other"
                                                                 style="checkbox" id="notOnfp-error" />

                                                        </div> </td>
                                                </tr>
                                            </obsgroup>
                                        </table>
                                    </includeIf>
                                    <includeIf velocityTest="$patient.gender == 'M' ">
                                        <table style="width: 100%" border="0">
                                            <obsgroup groupingConceptId="160575AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA">
                                                <tr>
                                                    <td width="10%"></td>
                                                    <td>
                                                        <obs conceptId="160575AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                             answerConceptId="160573AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                             answerLabel="Not sexually active now"
                                                             style="checkbox"/>
                                                    </td>
                                                </tr>
                                            </obsgroup>
                                        </table>
                                    </includeIf>
                                </div>
                            </td>
                        </tr>
                    </table>
                </fieldset>
            </div>
            <!--.step 2-->
            <!--System Examination-->
            <!--step 3-->
            <div id="step-3">
                <h2 class="StepTitle">Patient examination</h2>
                <!--Physical Examination-->
                <!--General Examination-->
                <fieldset class="general-examinations-part">
                    <legend>General Examination Findings</legend>
                    <table id="general-exam-findings">
                        <tr>
                            <td colspan="3">
                                <div style="float: left; padding-right: 50px">
                                    <obs conceptId="162737AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="1107AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="None" style="checkbox" /><br />
                                    <obs conceptId="162737AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="136443AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Jaundice" style="checkbox" /><br />
                                    <obs conceptId="162737AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="460AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Oedema" style="checkbox" /><br />
                                    <obs conceptId="162737AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="5334AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Oral thrush" style="checkbox" /><br />
                                    <obs conceptId="162737AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="5245AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Pallor" style="checkbox" /><br />

                                </div>
                            </td><td>
                            <div style="float: left;padding-right: 50px">

                                <obs conceptId="162737AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="140125AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Finger Clubbing" style="checkbox" /><br />
                                <obs conceptId="162737AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="126952AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Lymph Node Axillary" style="checkbox" /><br />
                                <obs conceptId="162737AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="143050AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Cyanosis" style="checkbox" /><br />
                                <obs conceptId="162737AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="126939AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Lymph Nodes Inguinal" style="checkbox" /><br />
                                <obs conceptId="162737AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="823AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Wasting" style="checkbox" />

                            </div>
                        </td><td>
                            <div style="float: left;padding-right: 40px">
                                <obs conceptId="162737AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="142630AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Dehydration" style="checkbox" /><br />
                                <obs conceptId="162737AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="116334AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Lethargic" style="checkbox" id="genExams-error" /><br />
                                <!--<obs conceptId="162737AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="983AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Weight Changes" id="genExams-error" style="checkbox" /><br />-->
                            </div>
                        </td>

                        </tr>
                    </table>
                </fieldset>

                <fieldset class="system-examinations-part">
                    <legend>System Examination</legend>
                    <table>
                        <tr>
                            <td>
                                Finding(s) on systems review?  &#160;&#160;&#160;&#160;
                            </td>
                            <td><obs
                                    conceptId="159615AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                    answerConceptIds="1115AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1116AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                    answerLabels="Normal,Abnormal"
                                    style="radio" id="systems-review" required="true"/>
                            </td>
                        </tr>
                    </table>
                    <br />
                    <table style="width: 70%;" border="0" id="tbl-systems-review">
                        <tr>
                            <th align="left">No. </th>
                            <th align="left">System Review</th>
                            <th align="left">Findings</th>
                            <th align="left">Findings Notes</th>
                        </tr>
                        <tr>
                            <td>1.</td>
                            <td>Skin</td>
                            <td><obs class="skin-findings"
                                     conceptId="1120AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerConceptIds="150555AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,125201AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,135591AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,136455AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,507AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1249AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5244AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerLabels="Abscess,Swelling/Growth,Hair Loss,Itching,Kaposi Sarcoma,Skin eruptions/Rashes,Oral sores"
                                     style="dropdowm"
                            /></td>

                            <td><obs class="skin-notes" conceptId="160981AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" rows="1" cols="50"
                            />
                            </td>
                        </tr>
                        <tr>
                            <td>2.</td>
                            <td>Eyes</td>
                            <td><obs class="eye-findings"
                                     conceptId="163309AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerConceptIds="123074AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,140940AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,131040AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,127777AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,140827AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,139100AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerLabels="Visual Disturbance,Excessive tearing,Eye pain,Eye redness,Light sensitive,Itchy eyes"
                                     style="dropdowm"
                            /></td>

                            <td><obs class="eye-notes" conceptId="164938" rows="1" cols="50"
                            />
                            </td>
                        </tr>
                        <tr>
                            <td>3.</td>
                            <td>ENT</td>
                            <td><obs class="ent-findings"
                                     conceptId="164936"
                                     answerConceptIds="148517AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,139075AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,119558AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,118536AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,106AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,147230AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,135841AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,117698AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,138554AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,507AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,152228AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,128055AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,133499AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160285AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,110099AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,126423AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,126318AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,158843AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5244AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5334AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,123588AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,124601AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,123919AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,111525AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerLabels="Apnea,Hearing disorder,Dental caries,Erythema,Frequent colds,Gingival bleeding,Hairy cell leukoplakia,Hearing loss,Hoarseness,Kaposi Sarcoma,Masses,Nasal discharge,Nosebleed,Pain,Post nasal discharge,Sinus problems,Snoring,Sore thoat,Oral sores,Thrush,Tinnitus,Toothache,Ulcers,Vertigo"
                                     style="dropdowm"
                            /></td>

                            <td><obs class="ent-notes" conceptId="164939" rows="1" cols="50"
                            />
                            </td>
                        </tr>
                        <tr>
                            <td>4.</td>
                            <td>Chest</td>
                            <td><obs class="chest-findings"
                                     conceptId="1123AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerConceptIds="146893AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,127640AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,145712AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,164440AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,127639AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5209AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerLabels="Bronchial breathing,Crackles,Dullness,Reduced breathing,Respiratory distress,Wheezing"
                                     style="dropdowm"
                            /></td>

                            <td><obs class="chest-notes" conceptId="163042AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" rows="1" cols="50"
                            />
                            </td>
                        </tr>
                        <tr>
                            <td>5.</td>
                            <td>CVS</td>
                            <td><obs class="cvs-findings"
                                     conceptId="1124AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerConceptIds="140147AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,136522AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,562AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,130560AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerLabels="Elevated blood pressure,Irregular heartbeat,Cardiac murmur,Cardiac rub"
                                     style="dropdowm"
                            /></td>

                            <td><obs class="cvs-notes" conceptId="163046AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" rows="1" cols="50"
                            />
                            </td>
                        </tr>
                        <tr>
                            <td>6.</td>
                            <td>Abdomen</td>
                            <td><obs class="abdomen-findings"
                                     conceptId="1125AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerConceptIds="150915AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5008AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5103AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5009AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5105AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerLabels="Abdominal distension,Hepatomegaly,Abdominal mass,Splenomegaly,Abdominal tenderness"
                                     style="dropdowm "
                            /></td>

                            <td><obs class="abdomen-notes" conceptId="160948AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" rows="1" cols="50"
                            />
                            </td>
                        </tr>
                        <tr>
                            <td>7.</td>
                            <td>CNS</td>
                            <td><obs class="cns-findings"
                                     conceptId="164937"
                                     answerConceptIds="118872AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1836AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,150817AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,120345AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,157498AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,112721AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,136282AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerLabels="Altered sensations,Bulging fontenelle,Abnormal reflexes,Confusion,Limb weakness,Stiff neck,Kernicterus"
                                     style="dropdowm"
                            /></td>

                            <td><obs class="cns-notes" conceptId="160994AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" rows="1" cols="50"
                            />
                            </td>
                        </tr>
                        <tr>
                            <td>8.</td>
                            <td>Genitourinary </td>
                            <td><obs class="gus-findings"
                                     conceptId="1126AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerConceptIds="147241AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,154311AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,123529AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,123396AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,124087AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerLabels="Bleeding,Rectal discharge,Urethral discharge,Vaginal discharge,Ulceration "
                                     style="dropdowm"
                            /></td>

                            <td><obs class="gus-notes" conceptId="163047AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" rows="1" cols="50"
                            />
                            </td>
                        </tr>
                    </table>
                </fieldset>
                <fieldset class="treatment-management-part">
                    <legend>Treatment/Management Plan</legend>
                    <table style="width: 70%;" border="0">
                        <tr>
                            <th align="left">Diagnosis</th>
                            <th align="left">Treatment Plan</th>
                        </tr>

                        <repeat>
                            <template>
                                <obsgroup groupingConceptId="159947AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA">
                                    <tr>

                                        <td>
                                            <obs conceptId="6042AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerClasses="Diagnosis" style="autocomplete"/>
                                        </td>
                                        <td>
                                            <obs conceptId="163104AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" rows="1" cols="80"/>
                                        </td>

                                    </tr>
                                </obsgroup>
                            </template>
                            <render n="11" concept="Diagnosis"/>
                            <render n="12" concept="Diagnosis"/>
                            <render n="13" concept="Diagnosis"/>
                            <render n="14" concept="Diagnosis"/>
                            <render n="15" concept="Diagnosis"/>
                        </repeat>
                    </table>
                </fieldset>
                <!--.step 3-->
            </div>
            <div id="step-4">
                <h2 class="StepTitle">Patient management</h2>    <!--step 4-->
                <fieldset class="prophylaxis"  >
                    <legend>Prophylaxis</legend>
                    <table>
                        <tr>
                            <td>
                                Prophylaxis used?  &#160;&#160;&#160;&#160;
                            </td>
                            <td><obs
                                    conceptId="1109AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                    answerConceptIds="105281AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,74250AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1107AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                    answerLabels="Cotrimoxazole,Dapsone,None"
                                    style="radio" id="prophylaxis-used" required="true"/>
                            </td>
                        </tr>
                    </table>
                </fieldset>
                <br />

                <fieldset id="ctx-part"  >
                    <legend>Cotrimoxazole</legend>
                    <table>
                        <tr>
                            <td>
                                <table cellpadding="0" border="0" cellspacing="5">
                                    <tr>
                                        <td>Adherence</td>
                                        <td>
                                            <obs
                                                    conceptId="161652AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                    answerConceptIds="159405AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,163794AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,159407AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                    answerLabels="Good (G),Fair (F),Poor (P)"
                                                    style="radio" id="ctx-adherence"
                                            />
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Dispensed</td>
                                        <td>
                                            <obs
                                                    conceptId="162229AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                    answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1175AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                    answerLabels="Yes,No,Not applicable (N/A)"
                                                    style="radio" id="ctx-dispensed"
                                            />
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                    </table>
                </fieldset>
                <fieldset id="dapsone-part">
                    <legend>Dapsone</legend>
                    <table>
                        <tr>
                            <td>
                                <table cellpadding="0" border="0" cellspacing="5">
                                    <tr>
                                        <td>Adherence</td>
                                        <td>
                                            <obs
                                                    conceptId="164941"
                                                    answerConceptIds="159405AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,163794AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,159407AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                    answerLabels="Good (G),Fair (F),Poor (P)"
                                                    style="radio" id="dapsone-adherence"
                                            />
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Dispensed</td>
                                        <td>
                                            <obs
                                                    conceptId="164940"
                                                    answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1175AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                    answerLabels="Yes,No,Not applicable (N/A)"
                                                    style="radio"  id="dapsone-dispensed"
                                            />
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                    </table>
                </fieldset>
                <fieldset class="arv-part">
                    <legend>ARV</legend>
                    <table>
                        <tr>
                            <td>
                                <table cellpadding="0" border="0" cellspacing="5">
                                    <tr>
                                        <td>Current Regimen:</td>
                                        <td colspan="2"><span id="calculated-duration-current-regimen" class="value"></span></td>
                                    </tr>
                                </table>
                                <table class = "on-art">
                                    <!--Adherence Modal  -->
                                    <tr>
                                        <button class="showModal">Adherence Assessment</button>
                                        <!--<a href="#" class="showModal">Show Modal Box</a>-->
                                        <div id="modalContents" style="display:none;" title="ARV Adherence Assessment" footer="OK">
                                            <div id="adherence-1">
                                                1. Do you ever forget to take your medicine? &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
                                                                                             &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
                                                                                              &#160;&#160;&#160;&#160;&#160;&#160;
                                                                                           <input type="radio" name="question-1" class="question-1" value="1065"/> Yes
                                                                                           <input type="radio" name="question-1" class="question-1" value="1066"/> No    <br/><br/>

                                                2. Are you careless at times about taking your medicine? &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
                                                                                            &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
                                                                                            <input type="radio" name="question-2" class="question-2" value="1065"/> Yes
                                                                                            <input type="radio" name="question-2" class="question-2" value="1066"/> No <br/><br/>

                                                3.Sometimes if you feel worse when you take the medicine, do you stop taking it? <input type="radio" name="question-3" class="question-3" value="1065"/> Yes
                                                                                            <input type="radio" name="question-3" class="question-3" value="1066"/> No <br/><br/>

                                                4.When you feel better do you sometimes stop taking your medicine?&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
                                                                                           &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
                                                                                            <input type="radio" name="question-4" class="question-4" value="1065"/> Yes
                                                                                           <input type="radio" name="question-4" class="question-4" value="1066"/> No <br/><br/>
                                            </div>
                                            <hr/>
                                            <div id="adherence-2">
                                                1. Did you take your medicine yesterday? &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
                                                &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
                                                &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
                                                <input type="radio" name="question-5" class="question-5" value="1065"/> Yes
                                                <input type="radio" name="question-5" class="question-5" value="1066"/> No    <br/><br/>

                                                2. When you feel like your symptoms are under control, <br/>  &#160;&#160; do you sometimes stop taking your medicine?
                                                &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
                                                &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
                                                <input type="radio" name="question-6" class="question-6" value="1065"/> Yes
                                                <input type="radio" name="question-6" class="question-6" value="1066"/> No <br/><br/>

                                                3.Taking medication every day is a real inconvenience for some people.<br/>  &#160;&#160; Do you feel under pressure about sticking to your treatment plan?
                                                &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
                                                <input type="radio" name="question-7" class="question-7" value="1065"/> Yes
                                                <input type="radio" name="question-7" class="question-7" value="1066"/> No <br/><br/>

                                                4.How often do you have difficulty remembering to take all your medications?&#160;&#160;
                                                  <select name="question-8" class="question-8">
                                                      <option value="1066">Select</option>
                                                      <option value="1090">Never/Rarely</option>
                                                      <option value="159416">Once in a while</option>
                                                      <option value="1385">Sometimes</option>
                                                      <option value="1804">Usually</option>
                                                      <option value="1358">All the time</option>
                                                  </select>
                                                <br/>
                                            </div>

                                            <div class="modal-footer">
                                                <button type="button" id="btnCloseARVAssessment" style="float: right;" >Save</button>
                                            </div>
                                        </div>

                                    </tr>
                                    <!--.Modal   -->
                                    <tr>
                                        <td>Adherence</td>
                                        <td>
                                            <obs
                                                    conceptId="1658AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                    answerConceptIds="159405AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,163794AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,159407AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                    answerLabels="Good (G),Fair (F),Poor (P)"
                                                    style="radio" id="arv-adherence"
                                            />
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                    </table>
                </fieldset>

                <fieldset class="phdp-part" >
                    <legend>PHDP Services</legend>
                    <table>
                        <tr>
                            <td>Has the client been given condoms this visit?</td>
                            <td><obs conceptId="159777AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1067AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1175AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerLabels="Yes,No,Unkown,N/A"
                                     style="radio"

                            /></td>
                        </tr>
                        <tr>
                            <td>Has the Client disclosed HIV status to their sexually active partner?</td>
                            <td><obs conceptId="159423AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1067AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1175AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerLabels="Yes,No,Unkown,N/A"
                                     style="radio"
                            /></td>
                        </tr>
                        <tr>
                            <td>Has the client's partner received on-site HIV testing?</td>
                            <td><obs conceptId="161557AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1067AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1175AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerLabels="Yes,No,Unkown,N/A"
                                     style="radio"
                            /></td>
                        </tr>
                        <includeIf velocityTest="$patient.gender == 'F' ">
                            <tr>
                                <td>Has the client been screened for CaCx</td>
                                <td><obs conceptId="164934"
                                         answerConceptIds="703AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,664AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1118AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1175AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                         answerLabels="Positive,Negative,Not Done,N/A"
                                         style="radio"
                                         id="cacx-screening" /></td>
                            </tr>
                        </includeIf>
                        <tr >
                            <td>Has the client been screened for STI (in this visit)?</td>
                            <td><obs id="screened-sti"
                                     conceptId="161558AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerConceptIds="703AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,664AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1118AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1175AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerLabels="Positive,Negative,Not Done,N/A"
                                     style="radio" /></td>
                        </tr>
                    </table>
                    <table id="tbl-partner-notification">
                        <tr >
                            <td>STI Partner Notification</td>
                            <td><obs conceptId="164935"
                                     labelText="&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;"
                                     id="sti-partnerNotification"
                                     answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerLabels="Yes,No"
                                     style="radio" /></td>
                        </tr>
                    </table>
                </fieldset >
                <fieldset class="tca-part">
                    <legend>Return Visit</legend>
                    <table>
                        <tr>
                            <td>Return Visit Date:</td>
                            <td><obs conceptId="5096AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" allowFutureDates="true" labelText=" " id="returnVisitDate" required="true" />
                                Reason*:
                                <obs conceptId="160288AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" required="true" id="returnVisitReason"
                                     answerConceptIds="160523AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1283AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,159382AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160521AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5622AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerLabels="Follow up,Lab tests,Counseling,Pharmacy Refill,Other,"
                                     style="dropdowm"  />
                            </td>

                        </tr><tr></tr>
                    </table>
                    <table>
                        <tr id="standard-care">
                            <td>Differentiated Care</td>
                            <td>
                                <obs conceptId="164947" id="standard"
                                     answerConceptIds="164942"
                                     style="dropdown"
                                     answerLabels="Standard Care"
                                />
                            </td>
                        </tr>
                        <tr id="fast-track">
                            <td>Differentiated Care</td>
                            <td>
                                <obs conceptId="164947" id="fast-track"
                                     answerConceptIds="164942,164943,164944,164945,164946"
                                     style="dropdown"
                                     answerLabels="Standard Care,Fast Track,Community ART Distribution - HCW Led,Community ART Distribution - Peer Led,Facility ART Distribution Group"
                                />
                            </td>
                        </tr>
                    </table>
                </fieldset>
                <div class="ke-form-footer" style="display: none">
                    <submit/>
                </div>
                <!--.step 4-->
            </div>
        </div>


    </div>
</htmlform>



