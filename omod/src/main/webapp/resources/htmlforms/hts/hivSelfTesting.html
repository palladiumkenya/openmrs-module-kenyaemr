<!--
  ~ The contents of this file are subject to the OpenMRS Public License
  ~ Version 1.0 (the "License"); you may not use this file except in
  ~ compliance with the License. You may obtain a copy of the License at
  ~ http://license.openmrs.org
  ~
  ~ Software distributed under the License is distributed on an "AS IS"
  ~ basis, WITHOUT WARRANTY OF ANY KIND, either express or implied. See the
  ~ License for the specific language governing rights and limitations
  ~ under the License.
  ~
  ~ Copyright (C) OpenMRS, LLC.  All Rights Reserved.

-->
<htmlform>

    <script type="text/javascript" src="../moduleResources/kenyaemr/scripts/moment.js"></script>
    <script type="text/javascript">
        var LATEST_SELF_REPORTED_STATUS = "<lookup expression="fn.latestObs(165153).getValueCoded()"/>";
        var LATEST_TEST_TYPE = "<lookup expression="fn.latestObs(164956).getValueCoded()"/>";
        var pgender = "<lookup expression="patient.gender" />";


        $.fn.noText = function () {/*use the jquery prototype technology to make a chainable clear field method*/
            if (this.is('clinicVisit_form')) { /*check to c if you the element type is an input*/
                this.val('');
                /*clear the input field*/
            }
            return this;
            /*means it is chainable*/
        };



        var test_resultsChanged = function () {
            $('#pep_prep').find('*').prop('disabled', false);
            var testResult = getValue("test_results.value");

            if (testResult == 703) {
                jq("#selftxt input").val('');
                jq("#selftxt input").prop("disabled", true);
                jq('#self_tested input').prop('disabled', true).addClass('disabled');

            }
            else if (testResult == 703 || testResult == 138571) {
                jq("#linked_to_art input").prop("disabled", false).removeClass('disabled');
                jq('#care_and_treatment').find("select").prop("selectedIndex", 0).removeClass('disabled');
                jq('#care_and_treatment').find('*').prop('disabled', false);
                // $("#pep_prep").attr('disabled',"true");
                $('#pepandprep').find('*').prop('disabled', true);
                $('#pepandprep').find('select').prop('disabled', true);
                $('#pepandprep').find('input:text').val('');
                $('#pepandprep').find("select").prop("selectedIndex", 0).addClass('disabled');
                jq("#selftxt input").prop("disabled", false);
                jq('#self_tested input').prop('disabled', false).removeClass('disabled');

            }


            else {
                jq("#linked_to_art input").prop("disabled", true).addClass('disabled');
                jq("#txtart input").prop("disabled", true).addClass('disabled');
                jq("#linked_to_art input").prop('checked', false);
                jq("#txtart input").val('');
                $('#care_and_treatment').find('*').prop('disabled', true);
                $('#care_and_treatment').find('input:text').val('');
                $('#care_and_treatment').find("select").prop("selectedIndex", 0).addClass('disabled');
                jq("#linkedFacility input").prop("disabled", true).addClass('disabled');

                $('#pepandprep').find('*').prop('disabled', false);
                $('#pepandprep').find('select').prop('disabled', false);
                $('#pepandprep').find("select").prop("selectedIndex", 0).removeClass('disabled');

                jq("#selftxt input").prop("disabled", false);
                jq('#self_tested input').prop('disabled', false).removeClass('disabled');
            }

        }

        //On Ready
        $(document).ready(function () {


            var keyPop = getValue('population-type.value');

            if (keyPop == 164929) {
                jq("#general_population").show();
                jq("#priority_population").hide();
            }
            else if(keyPop == 138643){
                jq("#priority_population").show();
                jq("#general_population").hide();
            }
            else{
                jq("#priority_population").hide();
                jq("#general_population").hide();
            }


            jq("#self-test-demo input").prop("disabled", false);

        });
        //Before Submit

        clearHiddenSections = function (parentObj) {


            for (var i = 0; i &lt; parentObj.length; i++) {
                parentObj[i].find('input[type=radio]').each(function () {
                    this.checked = false;
                });
                parentObj[i].find('input[type=checkbox]').each(function () {
                    this.checked = false;
                });
                parentObj[i].find('input[type=text]').each(function () {
                    this.val("");
                });
                parentObj[i].find('select').each(function () {
                    this.selectedIndex = 0;
                });
            }
        }
    </script>
    <style>
        .simple-table {
            border: solid 1px #DDEEEE;
            border-collapse: collapse;
            border-spacing: 0;
            font: normal 13px Arial, sans-serif;
        }

        .simple-table thead th {
            background-color: #DDEFEF;
            border: solid 1px #DDEEEE;
            color: #336B6B;
            padding: 10px;
            text-align: left;
            text-shadow: 1px 1px 1px #fff;
        }

        .simple-table td {
            border: solid 1px #DDEEEE;
            color: #333;
            padding: 10px;
            text-shadow: 1px 1px 1px #fff;
        }

        .disabled {
            color: #ebebe4;
    </style>

    <div class="ke-form-header">
        <table width="100%">
            <tr>
                <td>Date:
                    <encounterDate id="encounter-date" showTime="true"/>
                </td>
                <td>HIV Self Testing Form Provider:

                        <obs id="ConName" conceptId="160632" class="remarks" answerConceptIds="162591"
                             answerSeparator="&lt;br /&gt;"/>

                </td>
                <td>Location:
                    <encounterLocation default="GlobalProperty:kenyaemr.defaultLocation" type="autocomplete"/>
                </td>
            </tr>
        </table>
    </div>
    <!--=============Work flow==================-->
    <ifMode mode="VIEW" include="true">
        <div>
            <table style="width: 100%">
                <tr>
                    <td align="left">
                        Observation Date:
                    </td>
                    <td>
                        Unique Client Number
                    </td>
                    <td align="right">
                        Gender Identity:
                    </td>
                </tr>
                <tr>
                    <td>
                        16-Jan-2019
                    </td>
                    <td>
                        Test
                    </td>
                    <td align="right">
                        Test
                    </td>
                </tr>
            </table>
        </div>

    </ifMode>
    <!-- ============ end work flow =================-->
    <div class="ke-form-content">


        <fieldset>
            <legend>Population Info</legend>
            <div>
                Population type : &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
                <obs conceptId="164930"
                     answerConceptIds="164928,164929,138643"
                     answerLabels="General Population,Key Population,Priority Population" id="population-type"
                     style="radio" />
            </div>

            <p>

            </p>

            <p>

            </p>
            <p>

            </p>

            <p>

            </p>
            <table >
                <tr>
                    <td>

                        <div>
                            Key Population type : &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
                            <obs conceptId="164930"
                                 answerConceptIds="165083,160578,105,165100,162277"
                                 answerLabels="FSW,MSM,PWID,Transgender,People in Prison and other closed settings"
                                 style="radio" />
                        </div>

                        <p>

                        </p>

                        <p>

                        </p>




                    </td>

                </tr>
            </table>
            <table>
                <tr>
                    <td>

                        <div>
                            Priority Population type : &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
                            <obs conceptId="164930"
                                 answerConceptIds="159674,162198,165192,1175"
                                 answerLabels="Fisher Folk,Truck Driver,Military,Not Applicable"
                                 style="radio" />
                        </div>



                    </td>
                </tr>
            </table>
            <br />

        </fieldset>

        <!--        ============HIV TESTING HISTORY===========================-->

        <fieldset>
            <legend>HIV Testing History</legend>
            <table class="simple-table">

                <tr>
                    <td>

                        <div>
                            Ever tested for HIV? : &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
                            <obs conceptId="164930"
                                 answerConceptIds="1065,1066"
                                 answerLabels="Yes,No" id="evertested"
                                 style="radio" />
                        </div>
                        <P>

                        </P>
                        <P>

                        </P>
                        <P>

                        </P>

                        <div>
                            Knowledge of HIV Status ? : &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
                            <obs conceptId="164930"
                                 answerConceptIds="703,664,1067,1175"
                                 answerLabels="Positive,Negative,Unknown,Not Applicable" id="population-type"
                                 style="radio" />
                        </div>

                    </td>


                </tr>



            </table>

        </fieldset>

        <!--        ======================HIV SELF TESTING=========================-->


        <fieldset>
            <legend>Self testing</legend>
            <table class="simple-table">

                <tr>
                    <td>

                        <div>
                            Had a HIV Self Test in the past 12 months? : &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
                            <obs conceptId="164930"
                                 answerConceptIds="1065,1066"
                                 answerLabels="Yes,No" id="population-type"
                                 style="radio" />
                        </div>



                    </td>
                </tr>

            </table>

        </fieldset>



        <!--        ===========================CARE AND TREATMENT=====================-->
        <div id="currentHiv">

            <fieldset>
                <legend>Current HIV Self Test Services</legend>
                <table>

                    <td>Number of kits used
                        <p>
                            <obs id="kits" conceptId="165223" class="remarks"
                                 />
                        </p>
                    </td>
                </table>
                <table class="simple-table">
                    <tr>
                        <td><p><b>Reasons for taking a HIV Self Testing kit</b></p></td>
                        <td><p><b>Name of HIV Self Kit issued</b></p></td>
                        <td><p><b>HIV Self Kit lot number</b></p></td>
                        <td><p><b>HIV Self Test Kit Lot Expiry Date</b></p></td>


                    </tr>
                    <tr>

                        <td>
                            <p>
                                <obs id="reason_for_test" conceptId="164126"
                                     answerConceptIds="165217,163568,5622"
                                     answerLabels="Self Test,Sexual Partner/Spouse Testing, Friend or other family member,Other Testing"
                                     answerSeparator="&lt;br /&gt;" style="dropdown"/>
                            </p>
                            <p>
                                <obs id="care_provided" conceptId="165239"
                                     answerConceptIds="165217,163568,5622"
                                     answerLabels="Self Test,Sexual Partner/Spouse Testing, Friend or other family member,Other Testing"
                                     answerSeparator="&lt;br /&gt;" style="dropdown"/>
                            </p>
                            <p>
                                <obs id="care_provided" conceptId="165239"
                                     answerConceptIds="165217,163568,5622"
                                     answerLabels="Self Test,Sexual Partner/Spouse Testing, Friend or other family member,Other Testing"
                                     answerSeparator="&lt;br /&gt;" style="dropdown"/>
                            </p>
                            <p>
                                <obs id="care_provided" conceptId="165239"
                                     answerConceptIds="165217,163568,5622"
                                     answerLabels="Self Test,Sexual Partner/Spouse Testing, Friend or other family member,Other Testing"
                                     answerSeparator="&lt;br /&gt;" style="dropdown"/>
                            </p>
                            <p>
                                <obs id="care_provided" conceptId="165239"
                                     answerConceptIds="165217,163568,5622"
                                     answerLabels="Self Test,Sexual Partner/Spouse Testing, Friend or other family member,Other Testing"
                                     answerSeparator="&lt;br /&gt;" style="dropdown"/>
                            </p>


                        </td>
                        <td>
                            <p>
                                <obs id="name_of_kit" conceptId="164962" answerConceptIds="164960,160240,1920,164961,165351,5622"
                                     answerLabels="Sure Check, Oraquick, Biosure,Insti,Atomo,Other"
                                     style="dropdown" answerSeparator="&lt;br /&gt;"/>
                            </p>
                            <p>
                                <obs id="name_of_kit" conceptId="164962" answerConceptIds="164960,160240,1920,164961,165351,5622"
                                     answerLabels="Sure Check, Oraquick, Biosure,Insti,Atomo,Other"
                                     style="dropdown" answerSeparator="&lt;br /&gt;"/>
                            </p>
                            <p>
                                <obs id="name_of_kit" conceptId="164962" answerConceptIds="164960,160240,1920,164961,165351,5622"
                                     answerLabels="Sure Check, Oraquick, Biosure,Insti,Atomo,Other"
                                     style="dropdown" answerSeparator="&lt;br /&gt;"/>
                            </p>
                            <p>
                                <obs id="name_of_kit" conceptId="164962" answerConceptIds="164960,160240,1920,164961,165351,5622"
                                     answerLabels="Sure Check, Oraquick, Biosure,Insti,Atomo,Other"
                                     style="dropdown" answerSeparator="&lt;br /&gt;"/>
                            </p>
                            <p>
                                <obs id="name_of_kit" conceptId="164962" answerConceptIds="164960,160240,1920,164961,165351,5622"
                                     answerLabels="Sure Check, Oraquick, Biosure,Insti,Atomo,Other"
                                     style="dropdown" answerSeparator="&lt;br /&gt;"/>
                            </p>
                        </td>
                        <td>
                            <p>
                                <obs id="kitLotNumber" conceptId="164964"
                                     style="dropdown" answerSeparator="&lt;br /&gt;"/>
                            </p>
                            <p>
                                <obs id="kitLotNumber" conceptId="164964"
                                     style="dropdown" answerSeparator="&lt;br /&gt;"/>
                            </p>
                            <p>
                                <obs id="kitLotNumber" conceptId="164964"
                                     style="dropdown" answerSeparator="&lt;br /&gt;"/>
                            </p>
                            <p>
                                 <obs id="kitLotNumber" conceptId="164964"
                                        style="dropdown" answerSeparator="&lt;br /&gt;"/>
                            </p>
                            <p>
                                <obs id="kitLotNumber" conceptId="164964"
                                     style="dropdown" answerSeparator="&lt;br /&gt;"/>
                            </p>
                        </td>
                        <td>
                            <p>
                                <obs id="expiryDate" conceptId="162502AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" allowFutureDates="true"
                                />
                            </p>
                            <p>
                                <obs id="expiryDate" conceptId="162502AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" allowFutureDates="true"
                                />
                            </p>
                            <p>
                                <obs id="expiryDate" conceptId="162502AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" allowFutureDates="true"
                                />
                            </p>
                            <p>
                                <obs id="expiryDate" conceptId="162502AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" allowFutureDates="true"
                                />
                            </p>
                            <p>
                                <obs id="expiryDate" conceptId="162502AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" allowFutureDates="true"
                                />
                            </p>
                        </td>

                    </tr>

                </table>

            </fieldset>
        </div>


    </div>
    <div class="ke-form-footer">
        <submit/>
    </div>

</htmlform>